/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.31/esri/copyright.txt for details.
 * v4.31.6
 */
import{r as e,c as i,h as t,g as s}from"./p-b6370480.js";const a=class{constructor(t){e(this,t),this.arcgisFlowItemBack=i(this,"arcgisFlowItemBack",7),this.arcgisFlowItemClose=i(this,"arcgisFlowItemClose",7),this.arcgisGetVersions=i(this,"arcgisGetVersions",7),this.arcgisManageVersion=i(this,"arcgisManageVersion",7),this.arcgisNewVersion=i(this,"arcgisNewVersion",7),this._versionListEventListeners=new Map,this._arcgisGetVersions=e=>{this.arcgisGetVersions.emit(e.detail)},this._arcgisManageVersion=e=>{this.arcgisManageVersion.emit(e.detail)},this._arcgisNewVersion=e=>{this.arcgisNewVersion.emit(e.detail)},this.serviceItemElementProps=void 0}disconnectedCallback(){this._versionList&&this._removeVersionListEventListeners(this._versionList)}render(){const{serviceItemElementProps:{allowEditing:e,closable:i,currentUser:s,executionError:a,currentVersionIdentifier:c,flowElement:r,hasAdvEditingUte:o,heading:n,isVersionAdministrator:l,isVersioningApiAvailable:d,mode:h,pageSize:f,serviceName:b,serviceUrl:m,state:p,strings:g,versionInfos:v}}=this;let{_versionList:u}=this;const k=t("calcite-combobox",{key:"50fa51468e10039693438024795a150b5417b918",clearDisabled:!0,label:b,maxItems:5,overlayPositioning:"fixed",selectionMode:"single-persist",onCalciteComboboxChange:e=>{const i=e.target,t=v.find((e=>e.versionIdentifier.guid===i.value));this.arcgisManageVersion.emit({actionType:"changeVersion",serviceUrl:m,versionInfo:t})}},v?v.map((e=>t("calcite-combobox-item",{class:"dialog"===h?"":"calcite-combobox-item",selected:c.guid===e.versionIdentifier.guid&&c.name===e.versionIdentifier.name,textLabel:e.versionIdentifier.name,value:e.versionIdentifier.guid}))):void 0);let V,y;return e&&(V=t("calcite-action",{key:"7cb234cf1340018c6fc8b4290094f0de08071a69",id:`actionManageVersions_${b}`,icon:"list",scale:"s",slot:"control",text:"",onClick:async()=>{u=document.createElement("arcgis-version-management-version-list"),u.versionListElementProps={closable:i,currentUser:s,currentVersionIdentifier:c,executionError:a,hasAdvEditingUte:o,heading:n,isVersionAdministrator:l,isVersioningApiAvailable:d,pageSize:f,serviceName:b,serviceUrl:m,state:p,strings:g,versionInfos:v},u.addEventListener("calciteFlowItemBack",(e=>{e.preventDefault(),this.arcgisFlowItemBack.emit()})),u.addEventListener("calciteFlowItemClose",(()=>{this.arcgisFlowItemClose.emit()})),this._addVersionListEventListeners(u),r.append(u)}}),y=t("calcite-tooltip",{key:"7ff6c308de3022a0f5e55e78f62dd098b259cb4d",overlayPositioning:"fixed",referenceElement:`actionManageVersions_${b}`},t("span",{key:"c7f08a7ccd04af05d408b3c6c4aa90f17b85b8c2"},g.headers.manageVersions))),t("calcite-block",{key:"66789d7258187bae5516aa1df18668c458fca7b0",open:!0,heading:b},k,V,y)}_addVersionListEventListeners(e){e.addEventListener("arcgisGetVersions",this._arcgisGetVersions),this._versionListEventListeners.set("arcgisGetVersions",this._arcgisGetVersions),e.addEventListener("arcgisManageVersion",this._arcgisManageVersion),this._versionListEventListeners.set("arcgisManageVersion",this._arcgisManageVersion),e.addEventListener("arcgisNewVersion",this._arcgisNewVersion),this._versionListEventListeners.set("arcgisNewVersion",this._arcgisNewVersion)}_removeVersionListEventListeners(e){for(const[i,t]of this._versionListEventListeners)e.removeEventListener(i,t)}get el(){return s(this)}},c=class{constructor(t){e(this,t),this.arcgisAlterVersion=i(this,"arcgisAlterVersion",7),this.arcgisCreateVersion=i(this,"arcgisCreateVersion",7),this.arcgisFlowItemBack=i(this,"arcgisFlowItemBack",7),this.arcgisFlowItemClose=i(this,"arcgisFlowItemClose",7),this._switchToVersion=!0,this._handleCancel=()=>{this.arcgisFlowItemBack.emit()},this._handleChange=e=>{const{_mode:i,_ownerName:t,_versionName:s,versionPropertiesElementProps:{currentUser:a,isVersionAdministrator:c,serviceUrl:r,versionInfo:o}}=this;let{_alterVersionParameters:n,_createVersionParameters:l}=this;switch("create"===i&&(l||(l={access:"public",description:"",featureServerUrl:r,ownerName:a,versionName:""})),"edit"===i&&(n||(n={featureServerUrl:r,versionIdentifier:o.versionIdentifier,ownerName:t,versionName:s,access:o.access,description:o.description})),e.type){case"calciteChipGroupSelect":{const t=e.target.label,s=e.target.selectedItems[0].value;"create"===i&&(l={...l,[t]:s}),"edit"===i&&(n={...n,[t]:s});break}case"calciteInputTextInput":{const t=e.target.name,s=e.target.value;"create"===i&&(l={...l,[t]:s}),"edit"===i&&(n={...n,[t]:s});break}case"calciteTextAreaInput":{const t=e.target.name,s=e.target.value;"create"===i&&(l={...l,[t]:s}),"edit"===i&&(n={...n,[t]:s});break}}"create"===i&&("public"===l.access||a.toUpperCase()===l.ownerName?.toUpperCase()||c?this.switchToVersionCheckboxElement.disabled=!1:(this.switchToVersionCheckboxElement.checked=!1,this.switchToVersionCheckboxElement.disabled=!0,this._switchToVersion=!1),this._createVersionParameters=l),"edit"===i&&(this._alterVersionParameters=n)},this._handleClose=()=>{this.arcgisFlowItemClose.emit()},this._handleSave=()=>{const{_alterVersionParameters:e,_createVersionParameters:i,_mode:t,_switchToVersion:s}=this;"create"===t&&this.arcgisCreateVersion.emit({createVersionParameters:i,switchToVersion:s}),"edit"===t&&this.arcgisAlterVersion.emit({alterVersionParameters:e})},this._handleSwitchToVersionChange=e=>{this._switchToVersion=e.target.checked},this.versionPropertiesElementProps=void 0}async componentWillLoad(){const{versionPropertiesElementProps:{versionInfo:e}}=this;e?(this._mode="edit",this._fullVersionName=e.versionIdentifier.name,this._ownerName=this._fullVersionName.substring(0,this._fullVersionName.lastIndexOf(".")),this._versionName=this._fullVersionName.substring(this._fullVersionName.lastIndexOf(".")+1)):this._mode="create"}componentDidRender(){"create"===this._mode&&this.versionNameInputElement?.setFocus()}render(){const{versionPropertiesElementProps:{closable:e,currentUser:i,hasAdvEditingUte:s,state:a,strings:c,versionInfo:r},_mode:o,_ownerName:n,_versionName:l}=this,d=t("div",{key:"4a5ed7a0f6814895500189b645f9e5d3f7a9fbb5"},t("calcite-button",{key:"54ab974a2bf7be9360b48dfd9f0d8a5032fe1ff7",appearance:"outline",slot:"footer",width:"half",onClick:this._handleCancel},c.actions.cancelSave),t("calcite-button",{key:"609eda7c7b1d751f21f09bf98aacb312bee87a36",slot:"footer",width:"half",onClick:this._handleSave},c.actions.saveVersion)),h=t("calcite-label",{key:"f4bd072664d6f7054fa78ac4f5f5223eeea205e8"},c.input.versionAccess,t("calcite-chip-group",{key:"78f9efb602fff0ca15127da9b224e999799cb079",label:"access",onCalciteChipGroupSelect:this._handleChange,selectionMode:"single-persist"},t("calcite-chip",{key:"c8106baf12a236640d93920562d8a87d26cc3f81",selected:"edit"===o&&"public"===r.access||"create"===o,value:"public"},c.accessLevels.public),t("calcite-chip",{key:"3806c1b9ec6c5ce7bf170a5f3091d4dbceeeb198",selected:"edit"===o&&"protected"===r.access,value:"protected"},c.accessLevels.protected),t("calcite-chip",{key:"5333ff937c91ae845da5d5df63b82da277766d2a",selected:"edit"===o&&"private"===r.access,value:"private"},c.accessLevels.private))),f=t("calcite-label",{key:"541d4ef40c6f00c834825d6dc167d291bacd1720"},c.input.versionDescription,t("calcite-text-area",{key:"56f9df5f6b4c7e8d4b96a246cc44a1f560b92787",name:"description",onCalciteTextAreaInput:this._handleChange,resize:"vertical",value:"edit"===o?r.description:""})),b=t("calcite-label",{key:"4a96f29e7de41ab3aada75347c492ee75875a75b"},c.input.versionName,t("calcite-input-text",{key:"b6e13fb362c9e7173f122e4ec30ae63f0ef22563",ref:e=>{this.versionNameInputElement=e},name:"versionName",onCalciteInputTextInput:this._handleChange,maxLength:62,value:"edit"===o?l:""})),m=t("calcite-label",{key:"b40998587ea68b0895e2c1111e3ff012adef4865"},c.input.versionOwner,t("calcite-input-text",{key:"4bc775b26f384eff73e7e03d5af9a2665a50eebc",name:"ownerName",onCalciteInputTextInput:this._handleChange,disabled:!s,value:"edit"===o?n:i})),p="create"===o?t("calcite-label",{layout:"inline"},t("calcite-checkbox",{ref:e=>{this.switchToVersionCheckboxElement=e},checked:!0,name:"switchToVersion",onCalciteCheckboxChange:this._handleSwitchToVersionChange}),c.actions.switchToVersion):void 0;return t("calcite-flow-item",{key:"405059a80ad768940085fc18b1fdf499af6d926c",closable:e,description:r?r.versionIdentifier.name:"",heading:r?c.actions.editVersion:c.actions.newVersion,onCalciteFlowItemClose:this._handleClose},t("calcite-panel",{key:"7b2c15adc638fbd27da93f0cdedb1cd4f7759fa9",loading:"executing"===a},t("calcite-block",{key:"6a0a68fcde667eda85ce5785f0902c5c6b94c8b0",heading:"",open:!0},b,f,h,m,p,d)))}get el(){return s(this)}};export{a as arcgis_version_management_service_item,c as arcgis_version_management_version_properties}