/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.31/esri/copyright.txt for details.
 * v4.31.6
 */
import{r as e,c as i,h as t,g as s}from"./p-b6370480.js";const n=class{constructor(t){e(this,t),this.arcgisManageVersion=i(this,"arcgisManageVersion",7),this.versionItemElementProps=void 0}render(){const{versionItemElementProps:{currentUser:e,currentVersionIdentifier:i,hasAdvEditingUte:s,isVersionAdministrator:n,isVersioningApiAvailable:r,serviceUrl:o,strings:{actions:c},versionInfo:a}}=this,l=a.versionIdentifier.name,d=l.substring(l.lastIndexOf(".")+1),h=l.substring(0,l.lastIndexOf(".")),v=a.versionIdentifier.guid,g=`actionSwitchToVersion_${v}`,p=h.toUpperCase()===e.toUpperCase()&&r&&s||n,f=i.guid===a.versionIdentifier.guid,b=t("calcite-action",{key:"1c34df91dc4d3976049116d6e6bc379f62944470",disabled:f,id:g,icon:"code-branch",text:"",onClick:()=>{this.arcgisManageVersion.emit({actionType:"changeVersion",serviceUrl:o,versionInfo:a})},slot:"actions-start"}),u=f?void 0:t("calcite-tooltip",{"overlay-positioning":"fixed",referenceElement:g},t("span",null,c.switchToVersion));return t("calcite-list-item",{key:"5b1d76572a4e9e94756443f7e0c689282073f383",description:h,label:d,selected:!1,value:v},b,u,t("calcite-action-menu",{key:"cded92497ea9510cbb3bb86b2c95900660c2f52b","overlay-positioning":"fixed",slot:"actions-end",label:""},t("calcite-action",{key:"8afbed1ebdffb2530590ae4943edb1f974cf8b4b",disabled:f,icon:"code-branch",onClick:()=>{this.arcgisManageVersion.emit({actionType:"changeVersion",serviceUrl:o,versionInfo:a})},scale:"s",text:c.switchToVersion,textEnabled:!0}),t("calcite-action",{key:"47cda1ce9d70e2b24e4f85810afbed4e08c9b991",disabled:!p||f,icon:"code-branch-edit",onClick:()=>{this.arcgisManageVersion.emit({actionType:"editVersion",serviceUrl:o,versionInfo:a})},scale:"s",text:c.editVersion,textEnabled:!0}),t("calcite-action",{key:"89edd6c95ab045e367974c66cadcf66c5f59d6be",disabled:!p||p&&f,icon:"trash",onClick:()=>{this.arcgisManageVersion.emit({actionType:"deleteVersion",serviceUrl:o,versionInfo:a})},scale:"s",text:c.deleteVersion,textEnabled:!0})))}get el(){return s(this)}},r=class{constructor(t){e(this,t),this.arcgisNewVersion=i(this,"arcgisNewVersion",7),this.arcgisGetVersions=i(this,"arcgisGetVersions",7),this.arcgisManageVersion=i(this,"arcgisManageVersion",7),this._handleFilterChange=()=>{const{versionListElementProps:{versionInfos:e}}=this,i=this._filterInputElement.value.toUpperCase();this._filteredVersionInfos=""===i?e:e.filter((e=>e.versionIdentifier.name.toUpperCase().includes(i)||e.versionIdentifier.guid.toUpperCase().includes(i))),this._filteredVersionInfos.length&&(this.currentPage=1)},this._handleNoticeClosed=()=>{this.versionListElementProps={...this.versionListElementProps,executionError:void 0}},this._handlePaginationChange=e=>{this.currentPage=e.target.startItem},this.currentPage=1,this.versionListElementProps=void 0,this._filteredVersionInfos=void 0}propertiesChangeHandler(e,i){i.versionInfos!==e.versionInfos&&(this._filteredVersionInfos=this.versionListElementProps.versionInfos,this._filterInputElement&&this._handleFilterChange())}componentWillLoad(){this._filteredVersionInfos=this.versionListElementProps.versionInfos}componentDidRender(){this._filterInputElement?.setFocus()}render(){const{currentPage:e,versionListElementProps:{closable:i,currentUser:s,currentVersionIdentifier:n,executionError:r,hasAdvEditingUte:o,heading:c,isVersionAdministrator:a,isVersioningApiAvailable:l,pageSize:d,serviceName:h,serviceUrl:v,state:g,strings:{headers:p},strings:f,versionInfos:b}}=this,u=t("calcite-block",{heading:p.currentVersion,description:n.name,overlayPositioning:"fixed"}),m=t("calcite-action",{id:"actionRefreshVersions",icon:"refresh",text:"",onClick:()=>{this.arcgisGetVersions.emit({serviceUrl:v})},slot:"header-actions-end"},t("calcite-tooltip",{"overlay-positioning":"fixed",referenceElement:"actionRefreshVersions"},t("span",null,f.actions.refreshVersions)));this._paginatedVersionInfos=this._filteredVersionInfos.length>d?this._paginate(this._filteredVersionInfos,d,e):this._filteredVersionInfos;const x=this._filteredVersionInfos.length>d?t("calcite-pagination",{onCalcitePaginationChange:this._handlePaginationChange,pageSize:1,startItem:e,totalItems:Math.ceil(this._filteredVersionInfos.length/d)}):void 0,V=this._paginate(this._paginatedVersionInfos,d,1).map((e=>t("arcgis-version-management-version-item",{versionItemElementProps:{currentUser:s,currentVersionIdentifier:n,isCurrentVersionCard:!1,hasAdvEditingUte:o,isVersionAdministrator:a,isVersioningApiAvailable:l,serviceUrl:v,strings:f,versionInfo:e}}))),E=b.length>d?t("calcite-block",{heading:"",open:!0},t("calcite-input-text",{ref:e=>{this._filterInputElement=e},clearable:!0,icon:"search",onCalciteInputTextInput:this._handleFilterChange,placeholder:f.actions.searchVersions})):void 0,I=t("calcite-list",null,V),k=l&&o?t("calcite-fab",{appearance:"outline-fill",slot:"fab",textEnabled:!0,text:f.actions.newVersion,onClick:()=>{this.arcgisNewVersion.emit({serviceUrl:v})}}):void 0,y=r?t("calcite-notice",{onCalciteNoticeClose:this._handleNoticeClosed,class:"notice",closable:!0,kind:"warning",open:!0,scale:"s",slot:"footer",width:"full"},t("div",{slot:"message"},this._getExecutionError(r))):void 0;return t("calcite-flow-item",{closable:i,description:h,heading:c},t("calcite-panel",{loading:"executing"===g},u,t("calcite-panel",{heading:this._filteredVersionInfos.length?`${f.headers.manageVersions} (${this._filteredVersionInfos.length})`:f.headers.manageVersions},m,E,I,k),x,y))}_getExecutionError(e){const{versionListElementProps:{strings:{executionErrors:i}}}=this;switch(e){case"no-advanced-editing-user-type-extension":return i.noAdvancedEditingUserTypeExtension;case"no-feature-service-found":return i.noFeatureServiceFound;case"no-valid-enterprise-version":return i.notValidEnterpriseVersion;case"no-valid-version-name":return i.invalidVersionName;default:return e}}_paginate(e,i,t){return e.slice((t-1)*i,t*i)}get el(){return s(this)}static get watchers(){return{versionListElementProps:["propertiesChangeHandler"]}}};export{n as arcgis_version_management_version_item,r as arcgis_version_management_version_list}