import {
  i
} from "./chunk-CRH37WFF.js";
import {
  At,
  C,
  F,
  G,
  K,
  Tt,
  Y,
  _,
  r,
  tt
} from "./chunk-YFGQMO6E.js";

// node_modules/@arcgis/core/chunks/persistableUrlUtils.js
function p(e, s) {
  var _a;
  const o = (_a = s == null ? void 0 : s.url) == null ? void 0 : _a.path;
  if (e && o && (e = _(e, o, { preserveProtocolRelative: true }), s.portalItem && s.readResourcePaths)) {
    const t = G(e, s.portalItem.itemUrl);
    null != t && v.test(t) && s.readResourcePaths.push(s.portalItem.resourceFromPath(t).path);
  }
  return (e = I(e, s == null ? void 0 : s.portal)) && d.test(e) ? R(e) : e;
}
function m(e, l, a = y.YES) {
  var _a, _b;
  if (null == (e = e && d.test(e) ? w(e) : e)) return e;
  !Y(e) && (l == null ? void 0 : l.blockedRelativeUrls) && l.blockedRelativeUrls.push(e);
  let c = _(e);
  if (l) {
    const t = ((_a = l.verifyItemRelativeUrls) == null ? void 0 : _a.rootPath) || ((_b = l.url) == null ? void 0 : _b.path);
    if (t) {
      const s = I(t, l.portal), o = I(c, l.portal);
      c = G(o, s, s);
      null != c && c !== o && c !== e && l.verifyItemRelativeUrls && l.verifyItemRelativeUrls.writtenUrls.push(c);
    }
  }
  return c = x(c, l == null ? void 0 : l.portal), Y(c) && (c = K(c)), (l == null ? void 0 : l.resources) && (l == null ? void 0 : l.portalItem) && !Y(c) && !tt(c) && a === y.YES && l.resources.toKeep.push({ resource: l.portalItem.resourceFromPath(c), compress: false }), c;
}
function f(e, t, r2) {
  return p(e, r2);
}
function h(e, t, r2, s) {
  const o = m(e, s);
  void 0 !== o && (t[r2] = o);
}
var d = /\/items\/([^/]+)\/resources\/(.*)/;
var v = /^\.\/resources\//;
function U(e) {
  const t = (e == null ? void 0 : e.match(d)) ?? null;
  return (t == null ? void 0 : t[1]) ?? null;
}
function g(e) {
  const t = (e == null ? void 0 : e.match(d)) ?? null;
  if (null == t) return null;
  const r2 = t[2], s = r2.lastIndexOf("/");
  if (-1 === s) {
    const { path: e2, extension: t2 } = Tt(r2);
    return { prefix: null, filename: e2, extension: t2 };
  }
  const { path: o, extension: n } = Tt(r2.slice(s + 1));
  return { prefix: r2.slice(0, s), filename: o, extension: n };
}
function x(e, t) {
  return t && !t.isPortal && t.urlKey && t.customBaseUrl ? At(e, `${t.urlKey}.${t.customBaseUrl}`, t.portalHostname) : e;
}
function I(e, t) {
  if (!t || t.isPortal || !t.urlKey || !t.customBaseUrl) return e;
  const r2 = `${t.urlKey}.${t.customBaseUrl}`, s = C();
  return F(s, `${s.scheme}://${r2}`) ? At(e, t.portalHostname, r2) : At(e, r2, t.portalHostname);
}
function R(t) {
  if (!t) return t || null;
  let r2 = t;
  return r2 && i && !i.findCredential(r2) && (r2 = r(r2), r2 = r2.replace(/^https?:\/\/www\.arcgis\.com/, "https://cdn.arcgis.com"), r2 = r2.replace(/^https?:\/\/devext\.arcgis\.com/, "https://cdndev.arcgis.com"), r2 = r2.replace(/^https?:\/\/qaext\.arcgis\.com/, "https://cdnqa.arcgis.com")), r2;
}
function w(t) {
  if (!t) return t || null;
  let r2 = t;
  return r2 = r2.replace(/^https?:\/\/cdn\.arcgis\.com/, "https://www.arcgis.com"), r2 = r2.replace(/^https?:\/\/cdndev\.arcgis\.com/, "https://devext.arcgis.com"), r2 = r2.replace(/^https?:\/\/cdnqa\.arcgis\.com/, "https://qaext.arcgis.com"), r2 && i && !i.findCredential(r2) && (r2 = r(r2)), r2;
}
var y;
!function(e) {
  e[e.YES = 0] = "YES", e[e.NO = 1] = "NO";
}(y || (y = {}));
var P = Object.freeze(Object.defineProperty({ __proto__: null, get MarkKeep() {
  return y;
}, ensureMainOnlineDomain: x, fromCDNUrl: w, fromJSON: p, itemIdFromResourceUrl: U, prefixAndFilenameFromResourceUrl: g, read: f, toCDNUrl: R, toJSON: m, write: h }, Symbol.toStringTag, { value: "Module" }));

export {
  p,
  m,
  f,
  h,
  U,
  g,
  x,
  R,
  y,
  P
};
//# sourceMappingURL=chunk-AIYFWM42.js.map
