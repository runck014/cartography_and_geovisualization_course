import {
  d as d5
} from "./chunk-7XRQBOQ2.js";
import {
  T
} from "./chunk-IBWVVVMM.js";
import {
  r as r7
} from "./chunk-AVHNMAYL.js";
import {
  j as j3
} from "./chunk-ZFCZ2Q23.js";
import {
  $,
  j as j4
} from "./chunk-KVWJ4FJP.js";
import {
  h as h2
} from "./chunk-IZK3LHO7.js";
import {
  s as s5
} from "./chunk-NUMNFUBC.js";
import {
  a as a2
} from "./chunk-WVQ2KF5K.js";
import {
  e as e2
} from "./chunk-4YAOPSM4.js";
import {
  o as o2
} from "./chunk-XK5EJSYF.js";
import {
  s as s6
} from "./chunk-JUN5XSQC.js";
import {
  B,
  e,
  r as r4
} from "./chunk-WGQW332V.js";
import {
  r as r5
} from "./chunk-J7T52XOR.js";
import {
  i2 as i4,
  n2
} from "./chunk-MRQ4EVYK.js";
import {
  f,
  l as l2,
  m as m2,
  u as u2
} from "./chunk-3FXXSWHF.js";
import {
  p as p3
} from "./chunk-4RG73KY7.js";
import {
  e as e3,
  u as u3
} from "./chunk-A33GYYOL.js";
import {
  Xe
} from "./chunk-ER5KJVHG.js";
import {
  l as l3
} from "./chunk-YYZ2CTYE.js";
import {
  c as c4
} from "./chunk-7ZA6GWGF.js";
import {
  c as c3
} from "./chunk-5IA763KB.js";
import {
  d as d4
} from "./chunk-G54IOEGF.js";
import {
  b as b3
} from "./chunk-WGIZLWW7.js";
import {
  m as m3
} from "./chunk-PUOCGOJB.js";
import {
  d as d3
} from "./chunk-VILGTHTP.js";
import {
  I,
  c,
  c2,
  i2 as i6,
  i4 as i7,
  n as n4,
  p as p2
} from "./chunk-ATEWWVHG.js";
import {
  i as i5
} from "./chunk-M5RSIRGD.js";
import {
  s as s4
} from "./chunk-44C2A72D.js";
import {
  Ge,
  be,
  i as i8,
  je,
  pe
} from "./chunk-6D5XULXX.js";
import {
  O
} from "./chunk-6RLUKSNK.js";
import {
  i as i3,
  l,
  s as s2
} from "./chunk-UN4ISSP7.js";
import {
  P,
  d as d2,
  v,
  w
} from "./chunk-TKY5RBM3.js";
import {
  E,
  j
} from "./chunk-NHJGPXZH.js";
import {
  o,
  p
} from "./chunk-JS7R723S.js";
import {
  V
} from "./chunk-SIQNRYEG.js";
import {
  j2
} from "./chunk-A3J7W53Y.js";
import {
  s as s3
} from "./chunk-H6RIEXAG.js";
import {
  r as r6
} from "./chunk-6YWQXXBX.js";
import {
  n as n3
} from "./chunk-E2X3OBBC.js";
import {
  U
} from "./chunk-X7VTUWCX.js";
import {
  b2,
  m
} from "./chunk-GD4XDYZL.js";
import {
  a4 as a,
  r as r3
} from "./chunk-33ECLFFF.js";
import {
  r
} from "./chunk-MV5XBD6C.js";
import {
  A,
  b,
  d,
  h,
  k,
  y
} from "./chunk-GRW2QIBT.js";
import {
  u
} from "./chunk-R2PAF6JT.js";
import {
  i2,
  n2 as n,
  r as r2,
  s2 as s
} from "./chunk-PKLD5YJF.js";
import {
  F,
  has,
  i
} from "./chunk-XKQWTZMW.js";

// node_modules/@arcgis/core/widgets/Feature/support/featureUtils.js
var y2 = "esri.widgets.Feature.support.featureUtils";
var m4 = () => n.getLogger(y2);
var g = /href=(""|'')/gi;
var b4 = /(\{([^{\r\n]+)\})/g;
var h3 = /'/g;
var I2 = /^\s*expression\//i;
var T2 = /(\n)/gi;
var w2 = /[\u00A0-\u9999<>&]/gim;
var F2 = /href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi;
var N = /^(?:mailto:|tel:)/;
var j5 = "relationships/";
var Z = E("short-date-short-time");
function L(e11) {
  if (null != e11) return (e11.sourceLayer || e11.layer) ?? void 0;
}
async function E2({ type: e11, value: t6, event: n11 }) {
  try {
    return "function" == typeof t6 ? t6(n11) : await t6;
  } catch (r9) {
    return void m4().error("error", `An error occurred when calling the "${e11}" function`, { error: r9, graphic: n11.graphic, value: t6 });
  }
}
function v2(e11 = "") {
  if (e11) return !N.test(e11.trim().toLowerCase());
}
function x(e11) {
  return !!e11 && I2.test(e11);
}
function C(e11, t6) {
  if (!t6 || !x(t6) || !e11) return;
  const n11 = t6.replace(I2, "").toLowerCase();
  return e11.find(({ name: e12 }) => e12.toLowerCase() === n11);
}
function U2(e11, t6) {
  const n11 = C(t6, e11 == null ? void 0 : e11.fieldName);
  return n11 ? n11.title || null : e11 ? e11.label || e11.fieldName : null;
}
function q(e11, t6) {
  const n11 = t6.get(e11.toLowerCase());
  return `{${(n11 == null ? void 0 : n11.fieldName) || e11}}`;
}
function A2(e11) {
  return e11.replaceAll(g, "");
}
function M(e11, t6) {
  const n11 = $2(t6, e11);
  return n11 ? n11.name : e11;
}
function R(e11, t6) {
  return e11 && e11.map((e12) => M(e12, t6));
}
function $2(e11, t6) {
  return e11 && "function" == typeof e11.getField && t6 ? e11.getField(t6) ?? null : null;
}
function k2(e11) {
  return `${e11}`.trim();
}
function D({ attributes: e11, globalAttributes: t6, layer: n11, text: r9, expressionAttributes: i11, fieldInfoMap: o4 }) {
  return r9 ? z({ formattedAttributes: t6, template: P2(r9, { ...t6, ...i11, ...e11 }, n11), fieldInfoMap: o4 }) : "";
}
function z({ formattedAttributes: e11, template: n11, fieldInfoMap: r9 }) {
  return k2(A2(r2(r2(n11, (e12) => q(e12, r9)), e11)));
}
function O2(e11, t6, n11 = false) {
  const r9 = t6[e11];
  if ("string" == typeof r9) {
    const i11 = "%27", o4 = (n11 ? encodeURIComponent(r9) : r9).replaceAll(h3, i11);
    t6[e11] = o4;
  }
}
function G(e11, t6 = false) {
  const n11 = { ...e11 };
  return Object.keys(n11).forEach((e12) => O2(e12, n11, t6)), n11;
}
function S(e11, n11, r9) {
  const i11 = (n11 = k2(n11)) && "{" !== n11[0];
  return r2(e11, G(r9, i11 || false));
}
function Q(e11, t6) {
  return e11.replaceAll(b4, (e12, n11, r9) => {
    const i11 = $2(t6, r9);
    return i11 ? `{${i11.name}}` : n11;
  });
}
function P2(e11, t6, n11) {
  const r9 = Q(e11, n11);
  return r9 ? r9.replaceAll(F2, (e12, n12, r10) => S(e12, n12 || r10, t6)) : r9;
}
function _(e11, t6) {
  if ("string" == typeof e11 && t6 && null == t6.dateFormat && (null != t6.places || null != t6.digitSeparator)) {
    const t7 = Number(e11);
    if (!isNaN(t7)) return t7;
  }
  return e11;
}
function H(e11) {
  return null != e11 && "object" == typeof e11 && "fieldsIndex" in e11 && "geometryType" in e11 && "getField" in e11 && "load" in e11 && "loaded" in e11 && "objectIdField" in e11 && "spatialReference" in e11 && "type" in e11 && ("feature" === e11.type || "scene" === e11.type || "subtype-sublayer" === e11.type || "sublayer" === e11.type) && "when" in e11;
}
function B2(e11) {
  return null != e11 && "object" == typeof e11 && "createQuery" in e11 && "queryFeatureCount" in e11 && "queryObjectIds" in e11 && "queryRelatedFeatures" in e11 && "queryRelatedFeaturesCount" in e11 && "relationships" in e11;
}
function J(e11) {
  return !!(e11 && "object" == typeof e11 && "createQuery" in e11 && "queryFeatureCount" in e11 && "type" in e11) && ("subtype-sublayer" === e11.type && "parent" in e11 && e11.parent && "object" == typeof e11.parent ? "globalIdField" in e11.parent : "globalIdField" in e11);
}
function K(e11) {
  return H(e11) && B2(e11);
}
function V2(e11) {
  return H(e11) && J(e11);
}
function X(e11, t6) {
  var _a;
  const { fieldInfos: n11, fieldName: r9, preventPlacesFormatting: l9, layer: u9, timeZone: s12 } = t6, c14 = te(n11, r9), d10 = $2(u9, r9);
  if (c14 && !Ge(r9)) {
    const t7 = d10 == null ? void 0 : d10.type, n12 = (_a = c14.format) == null ? void 0 : _a.dateFormat;
    if ("date" === t7 || "date-only" === t7 || "time-only" === t7 || "timestamp-offset" === t7 || n12) return j4(e11, { format: n12, fieldType: t7, timeZoneOptions: { layerTimeZone: u9 && "preferredTimeZone" in u9 ? u9.preferredTimeZone : null, viewTimeZone: s12, datesInUnknownTimezone: !(!u9 || !("datesInUnknownTimezone" in u9)) && !!u9.datesInUnknownTimezone } });
  }
  const p12 = c14 == null ? void 0 : c14.format;
  return "string" == typeof e11 && Ge(r9) && p12 ? Y(e11, p12) : "string" == typeof (e11 = _(e11, p12)) || null == e11 || null == p12 ? ue(e11) : l(e11, l9 ? { ...i3(p12), minimumFractionDigits: 0, maximumFractionDigits: 20 } : i3(p12));
}
function Y(e11, t6) {
  return e11 = e11.trim(), /\d{2}-\d{2}/.test(e11) ? e11 : e11.includes(",") ? ee(e11, ",", ", ", t6) : e11.includes(";") ? ee(e11, ";", "; ", t6) : e11.includes(" ") ? ee(e11, " ", " ", t6) : l(Number(e11), i3(t6));
}
function ee(e11, t6, n11, r9) {
  return e11.trim().split(t6).map((e12) => l(Number(e12), i3(r9))).join(n11);
}
function te(e11, t6) {
  if ((e11 == null ? void 0 : e11.length) && t6) return e11.find((e12) => {
    var _a;
    return ((_a = e12.fieldName) == null ? void 0 : _a.toLowerCase()) === t6.toLowerCase();
  });
}
function ne({ fieldName: e11, graphic: t6, layer: n11 }) {
  if (ye(e11)) return null;
  if (!n11 || "function" != typeof n11.getFeatureType) return null;
  const { typeIdField: r9 } = n11;
  if (!r9 || e11 !== r9) return null;
  const i11 = n11.getFeatureType(t6);
  return i11 ? i11.name : null;
}
function re({ fieldName: e11, value: t6, graphic: n11, layer: r9 }) {
  if (ye(e11)) return null;
  if (!r9 || "function" != typeof r9.getFieldDomain) return null;
  const i11 = n11 && r9.getFieldDomain(e11, { feature: n11, excludeImpliedDomains: has("esri-widget-legacy-field-domain-calculation") });
  return i11 && "coded-value" === i11.type ? i11.getName(t6) : null;
}
function ie(e11, t6, n11, i11) {
  const { creatorField: o4, creationDateField: a5, editorField: l9, editDateField: u9 } = e11;
  if (!t6) return;
  const s12 = p(i11 && "preferredTimeZone" in i11 ? i11.preferredTimeZone : null, !(!i11 || !("datesInUnknownTimezone" in i11)) && !!i11.datesInUnknownTimezone, n11, Z, "date"), f8 = { ...Z, ...s12 }, c14 = t6[u9];
  if ("number" == typeof c14) {
    const e12 = t6[l9];
    return { type: "edit", date: j(c14, f8), user: e12 };
  }
  const d10 = t6[a5];
  if ("number" == typeof d10) {
    const e12 = t6[o4];
    return { type: "create", date: j(d10, f8), user: e12 };
  }
  return null;
}
function oe(e11, t6) {
  const n11 = /* @__PURE__ */ new Map();
  if (!e11) return n11;
  for (const r9 of e11) {
    if (!r9.fieldName) continue;
    const e12 = M(r9.fieldName, t6);
    r9.fieldName = e12, n11.set(e12.toLowerCase(), r9);
  }
  return n11;
}
function ae(e11) {
  const t6 = [];
  if (!e11) return t6;
  const { fieldInfos: n11, content: r9 } = e11;
  return n11 && t6.push(...n11), r9 && Array.isArray(r9) ? (r9.forEach((e12) => {
    if ("fields" === e12.type) {
      const n12 = e12 == null ? void 0 : e12.fieldInfos;
      n12 && t6.push(...n12);
    }
  }), t6) : t6;
}
function le(e11) {
  return e11.replaceAll(w2, (e12) => `&#${e12.charCodeAt(0)};`);
}
function ue(e11) {
  return "string" == typeof e11 ? e11.replaceAll(T2, '<br class="esri-text-new-line" />') : e11;
}
function se(e11) {
  var _a;
  const { value: t6, fieldName: n11, fieldInfos: r9, fieldInfoMap: i11, layer: o4, graphic: a5, timeZone: l9 } = e11;
  if (null == t6) return "";
  const s12 = re({ fieldName: n11, value: t6, graphic: a5, layer: o4 });
  if (s12) return s12;
  const d10 = ne({ fieldName: n11, graphic: a5, layer: o4 });
  if (d10) return d10;
  if (i11.get(n11.toLowerCase())) return X(t6, { fieldInfos: r9 || Array.from(i11.values()), fieldName: n11, layer: o4, timeZone: l9 });
  const p12 = (_a = o4 == null ? void 0 : o4.fieldsIndex) == null ? void 0 : _a.get(n11);
  return p12 && ($(p12) || be(p12)) ? j4(t6, { fieldType: p12.type, timeZoneOptions: { layerTimeZone: o4 && "preferredTimeZone" in o4 ? o4.preferredTimeZone : null, viewTimeZone: l9, datesInUnknownTimezone: !(!o4 || !("datesInUnknownTimezone" in o4)) && !!o4.datesInUnknownTimezone } }) : ue(t6);
}
function fe({ fieldInfos: e11, attributes: t6, layer: n11, graphic: r9, fieldInfoMap: i11, relatedInfos: o4, timeZone: a5 }) {
  const l9 = {};
  return o4 == null ? void 0 : o4.forEach((t7) => be2({ attributes: l9, relatedInfo: t7, fieldInfoMap: i11, fieldInfos: e11, layer: n11, timeZone: a5 })), t6 && Object.keys(t6).forEach((o5) => {
    const u9 = t6[o5];
    l9[o5] = se({ fieldName: o5, fieldInfos: e11, fieldInfoMap: i11, layer: n11, value: u9, graphic: r9, timeZone: a5 });
  }), l9;
}
async function ce(e11, t6) {
  var _a, _b;
  const { layer: n11, graphic: r9, outFields: i11, objectIds: o4, returnGeometry: a5, spatialReference: l9 } = e11, u9 = o4[0];
  if ("number" != typeof u9 && "string" != typeof u9) {
    const e12 = "Could not query required fields for the specified feature. The feature's ID is invalid.", t7 = { layer: n11, graphic: r9, objectId: u9, requiredFields: i11 };
    return m4().warn(e12, t7), null;
  }
  if (!((_b = (_a = O(n11)) == null ? void 0 : _a.operations) == null ? void 0 : _b.supportsQuery)) {
    const e12 = "The specified layer cannot be queried. The following fields will not be available.", t7 = { layer: n11, graphic: r9, requiredFields: i11, returnGeometry: a5 };
    return m4().warn(e12, t7), null;
  }
  const f8 = n11.createQuery();
  f8.objectIds = o4, f8.outFields = (i11 == null ? void 0 : i11.length) ? i11 : [n11.objectIdField], f8.returnGeometry = !!a5, f8.returnZ = !!a5, f8.returnM = !!a5, f8.outSpatialReference = l9;
  return (await n11.queryFeatures(f8, t6)).features[0];
}
async function de(e11) {
  var _a;
  if (!((_a = e11.expressionInfos) == null ? void 0 : _a.length)) return false;
  const t6 = await i8(), { arcadeUtils: { hasGeometryFunctions: n11 } } = t6;
  return n11(e11);
}
async function pe2({ graphic: e11, popupTemplate: t6, layer: n11, spatialReference: r9 }, i11) {
  if (!n11 || !t6) return;
  if ("function" == typeof n11.load && await n11.load(i11), !e11.attributes) return;
  const o4 = n11.objectIdField, a5 = e11.attributes[o4];
  if (null == a5) return;
  const u9 = [a5], s12 = await t6.getRequiredFields(n11.fieldsIndex), f8 = je(s12, e11), c14 = f8 ? [] : s12.includes(o4) ? s12 : [...s12, o4], d10 = t6.returnGeometry || await de(t6);
  if (f8 && !d10) return;
  const p12 = await ce({ layer: n11, graphic: e11, outFields: c14, objectIds: u9, returnGeometry: d10, spatialReference: r9 }, i11);
  p12 && (p12.geometry && (e11.geometry = p12.geometry), p12.attributes && (e11.attributes = { ...e11.attributes, ...p12.attributes }));
}
function ye(e11 = "") {
  return !!e11 && e11.includes(j5);
}
function me(e11) {
  return e11 ? `${j5}${e11.layerId}/${e11.fieldName}` : "";
}
function ge({ attributes: e11, graphic: t6, relatedInfo: n11, fieldInfos: r9, fieldInfoMap: i11, layer: o4, timeZone: a5 }) {
  e11 && t6 && n11 && Object.keys(t6.attributes).forEach((l9) => {
    const u9 = me({ layerId: n11.relation.id.toString(), fieldName: l9 }), s12 = t6.attributes[l9];
    e11[u9] = se({ fieldName: u9, fieldInfos: r9, fieldInfoMap: i11, layer: o4, value: s12, graphic: t6, timeZone: a5 });
  });
}
function be2({ attributes: e11, relatedInfo: t6, fieldInfoMap: n11, fieldInfos: r9, layer: i11, timeZone: o4 }) {
  var _a, _b;
  e11 && t6 && ((_a = t6.relatedFeatures) == null ? void 0 : _a.forEach((a5) => ge({ attributes: e11, graphic: a5, relatedInfo: t6, fieldInfoMap: n11, fieldInfos: r9, layer: i11, timeZone: o4 })), (_b = t6.relatedStatsFeatures) == null ? void 0 : _b.forEach((a5) => ge({ attributes: e11, graphic: a5, relatedInfo: t6, fieldInfoMap: n11, fieldInfos: r9, layer: i11, timeZone: o4 })));
}
var he = (e11) => {
  if (!e11) return false;
  const t6 = e11.toUpperCase();
  return t6.includes("CURRENT_TIMESTAMP") || t6.includes("CURRENT_DATE") || t6.includes("CURRENT_TIME");
};
var Ie = ({ layer: e11, method: t6, query: n11, definitionExpression: r9 }) => {
  var _a, _b;
  if (!((_b = (_a = e11.capabilities) == null ? void 0 : _a.query) == null ? void 0 : _b.supportsCacheHint) || "attachments" === t6) return;
  const i11 = null != n11.where ? n11.where : null, o4 = null != n11.geometry ? n11.geometry : null;
  he(r9) || he(i11) || "extent" === (o4 == null ? void 0 : o4.type) || "tile" === n11.resultType || (n11.cacheHint = true);
};
var Te = ({ query: e11, layer: t6, method: n11 }) => {
  Ie({ layer: t6, method: n11, query: e11, definitionExpression: `${t6.definitionExpression} ${t6.serviceDefinitionExpression ?? ""}` });
};
var we = ({ queryPayload: e11, layer: t6, method: n11 }) => {
  Ie({ layer: t6, method: n11, query: e11, definitionExpression: `${t6.definitionExpression} ${t6.serviceDefinitionExpression ?? ""}` });
};
function Fe(e11, t6, n11) {
  var _a, _b;
  return e11 && t6 && n11 ? "sublayer" === t6.type ? Ze({ layers: (_a = t6.layer) == null ? void 0 : _a.sublayers, map: e11, relatedLayer: t6, relationship: n11 }) || Ze({ layers: (_b = t6.layer) == null ? void 0 : _b.subtables, map: e11, relatedLayer: t6, relationship: n11 }) : Ze({ layers: e11.allLayers, map: e11, relatedLayer: t6, relationship: n11 }) || Ze({ layers: e11.allTables, map: e11, relatedLayer: t6, relationship: n11 }) : null;
}
function Ne(e11, t6) {
  var _a;
  return e11 && "utilityNetworks" in e11 && t6 ? (_a = e11.utilityNetworks) == null ? void 0 : _a.find((e12) => e12.isUtilityLayer(t6)) : null;
}
function je2(e11, t6) {
  return e11 == null ? void 0 : e11.allTables.find((e12) => {
    var _a;
    return "feature" === e12.type && e12.layerId === t6.id && e12.url === ((_a = t6.layer) == null ? void 0 : _a.url);
  });
}
function Ze({ map: e11, relationship: t6, relationship: { relatedTableId: n11 }, relatedLayer: r9, layers: i11 }) {
  var _a;
  if (!i11) return null;
  for (const o4 of i11) {
    if ("map-image" === o4.type) {
      const n12 = Ze({ layers: o4.sublayers, map: e11, relatedLayer: r9, relationship: t6 }) || Ze({ layers: o4.subtables, map: e11, relatedLayer: r9, relationship: t6 });
      if (n12) return n12;
      continue;
    }
    if (!K(o4)) continue;
    if ("sublayer" === r9.type) {
      if (o4 !== r9 && o4.id === n11) return o4.isTable ? je2(e11, o4) : o4;
      continue;
    }
    const i12 = "scene" === r9.type && r9.associatedLayer ? r9.associatedLayer.url : r9.url;
    if (!i12) return null;
    if ("sublayer" !== o4.type) {
      if (o4 !== r9 && o4.url === i12 && o4.layerId === n11) return o4;
    } else if (o4 !== r9 && ((_a = o4.layer) == null ? void 0 : _a.url) === i12 && o4.id === n11) return o4.isTable ? je2(e11, o4) : o4;
  }
  return null;
}

// node_modules/@arcgis/core/widgets/Attachments/AttachmentsViewModel.js
var p4 = { editing: false, operations: { add: true, update: true, delete: true } };
var u4 = V.ofType(a2);
var f2 = class extends b2 {
  constructor(t6) {
    super(t6), this._getAttachmentsPromise = null, this._attachmentLayer = null, this.capabilities = { ...p4 }, this.activeAttachmentInfo = null, this.activeFileInfo = null, this.attachmentInfos = new u4(), this.fileInfos = new V(), this.graphic = null, this.mode = "view", this.filesEnabled = false, this.addHandles(d2(() => this.graphic, () => this._graphicChanged(), P));
  }
  destroy() {
    this._attachmentLayer = null, this.graphic = null;
  }
  castCapabilities(t6) {
    return { ...p4, ...t6 };
  }
  get state() {
    return this._getAttachmentsPromise ? "loading" : this.graphic ? "ready" : "disabled";
  }
  get supportsResizeAttachments() {
    const { graphic: t6 } = this;
    if (!t6) return false;
    const e11 = t6.layer || t6.sourceLayer;
    return (e11 == null ? void 0 : e11.loaded) && "capabilities" in e11 && e11.capabilities && "operations" in e11.capabilities && "supportsResizeAttachments" in e11.capabilities.operations && e11.capabilities.operations.supportsResizeAttachments || false;
  }
  async getAttachments() {
    const { _attachmentLayer: t6, attachmentInfos: e11 } = this;
    if (!t6 || "function" != typeof t6.queryAttachments) throw new s("invalid-layer", "getAttachments(): A valid layer is required.");
    const i11 = this._getObjectId();
    if ("number" != typeof i11) throw new s("invalid-object-id", "getAttachments(): Numeric object id is required");
    const a5 = new c3({ objectIds: [i11], returnMetadata: true }), r9 = [], s12 = t6.queryAttachments(a5).then((t7) => t7[i11] || r9).catch(() => r9);
    this._getAttachmentsPromise = s12, this.notifyChange("state");
    const o4 = await s12;
    return e11.destroyAll(), o4.length && e11.addMany(o4), this._getAttachmentsPromise = null, this.notifyChange("state"), o4;
  }
  async addAttachment(t6, e11 = this.graphic) {
    var _a;
    const { _attachmentLayer: i11, attachmentInfos: a5, capabilities: r9 } = this;
    if (!e11) throw new s("invalid-graphic", "addAttachment(): A valid graphic is required.", { graphic: e11 });
    if (!t6) throw new s("invalid-attachment", "addAttachment(): An attachment is required.", { attachment: t6 });
    if (!((_a = r9.operations) == null ? void 0 : _a.add)) throw new s("invalid-capabilities", "addAttachment(): add capabilities are required.");
    if (!i11 || "function" != typeof i11.addAttachment) throw new s("invalid-layer", "addAttachment(): A valid layer is required.");
    const s12 = i11.addAttachment(e11, t6).then((t7) => this._queryAttachment(t7.objectId, e11)), o4 = await s12;
    return a5.add(o4), o4;
  }
  async deleteAttachment(t6) {
    var _a;
    const { _attachmentLayer: e11, attachmentInfos: i11, graphic: a5, capabilities: r9 } = this;
    if (!t6) throw new s("invalid-attachment-info", "deleteAttachment(): An attachmentInfo is required.", { attachmentInfo: t6 });
    if (!((_a = r9.operations) == null ? void 0 : _a.delete)) throw new s("invalid-capabilities", "deleteAttachment(): delete capabilities are required.");
    if (!e11 || "function" != typeof e11.deleteAttachments) throw new s("invalid-layer", "deleteAttachment(): A valid layer is required.");
    if (!a5) throw new s("invalid-graphic", "deleteAttachment(): A graphic is required.");
    const s12 = e11.deleteAttachments(a5, [t6.id]).then(() => t6), o4 = await s12;
    return i11.remove(o4), o4.destroy(), o4;
  }
  async updateAttachment(t6, e11 = this.activeAttachmentInfo) {
    var _a;
    const { _attachmentLayer: i11, attachmentInfos: a5, graphic: r9, capabilities: s12 } = this;
    if (!t6) throw new s("invalid-attachment", "updateAttachment(): An attachment is required.", { attachment: t6 });
    if (!e11) throw new s("invalid-attachment-info", "updateAttachment(): An attachmentInfo is required.", { attachmentInfo: e11 });
    if (!((_a = s12.operations) == null ? void 0 : _a.update)) throw new s("invalid-capabilities", "updateAttachment(): Update capabilities are required.");
    const o4 = a5.indexOf(e11);
    if (!i11 || "function" != typeof i11.updateAttachment) throw new s("invalid-layer", "updateAttachment(): A valid layer is required.");
    if (!r9) throw new s("invalid-graphic", "updateAttachment(): A graphic is required.");
    const c14 = i11.updateAttachment(r9, e11.id, t6).then((t7) => this._queryAttachment(t7.objectId)), h10 = await c14;
    return a5.splice(o4, 1, h10), h10;
  }
  async commitFiles() {
    return await Promise.all(this.fileInfos.items.map((t6) => this.addAttachment(t6.form))), this.fileInfos.removeAll(), this.getAttachments();
  }
  addFile(t6, e11) {
    if (!t6 || !e11) return null;
    const i11 = { file: t6, form: e11 };
    return this.fileInfos.add(i11), i11;
  }
  updateFile(t6, e11, i11 = this.activeFileInfo) {
    if (!t6 || !e11 || !i11) return null;
    const a5 = this.fileInfos.indexOf(i11);
    return a5 > -1 && this.fileInfos.splice(a5, 1, { file: t6, form: e11 }), this.fileInfos.items[a5];
  }
  deleteFile(t6) {
    const e11 = this.fileInfos.find((e12) => e12.file === t6);
    return e11 ? (this.fileInfos.remove(e11), e11) : null;
  }
  async _queryAttachment(t6, e11) {
    const { _attachmentLayer: i11 } = this;
    if (!t6 || !(i11 == null ? void 0 : i11.queryAttachments)) throw new s("invalid-attachment-id", "Could not query attachment.");
    const a5 = this._getObjectId(e11);
    if ("number" != typeof a5) throw new s("invalid-object-id", "getAttachments(): Numeric object id is required");
    const r9 = new c3({ objectIds: [a5], attachmentsWhere: `AttachmentId=${t6}`, returnMetadata: true });
    return i11.queryAttachments(r9).then((t7) => t7[a5][0]);
  }
  _getObjectId(t6 = this.graphic) {
    return (t6 == null ? void 0 : t6.getObjectId()) ?? null;
  }
  _graphicChanged() {
    this.graphic && (this._setAttachmentLayer(), this.getAttachments().catch(() => this.attachmentInfos.destroyAll()));
  }
  _setAttachmentLayer() {
    const { graphic: t6 } = this, e11 = L(t6);
    this._attachmentLayer = e11 ? "scene" === e11.type && null != e11.associatedLayer ? e11.associatedLayer : e11 : null;
  }
};
r([m()], f2.prototype, "capabilities", void 0), r([s3("capabilities")], f2.prototype, "castCapabilities", null), r([m()], f2.prototype, "activeAttachmentInfo", void 0), r([m()], f2.prototype, "activeFileInfo", void 0), r([m({ readOnly: true, type: u4 })], f2.prototype, "attachmentInfos", void 0), r([m()], f2.prototype, "fileInfos", void 0), r([m({ type: d3 })], f2.prototype, "graphic", void 0), r([m()], f2.prototype, "mode", void 0), r([m({ readOnly: true })], f2.prototype, "state", null), r([m()], f2.prototype, "filesEnabled", void 0), r([m({ readOnly: true })], f2.prototype, "supportsResizeAttachments", null), f2 = r([a("esri.widgets.Attachments.AttachmentsViewModel")], f2);
var y3 = f2;

// node_modules/@arcgis/core/widgets/Attachments/support/attachmentUtils.js
function e4(i11) {
  const e11 = i11.toLowerCase();
  return "image/bmp" === e11 || "image/emf" === e11 || "image/exif" === e11 || "image/gif" === e11 || "image/x-icon" === e11 || "image/jpeg" === e11 || "image/png" === e11 || "image/tiff" === e11 || "image/x-wmf" === e11;
}
function p5(e11) {
  const p12 = n3("esri/themes/base/images/files/");
  return e11 ? "text/plain" === e11 ? `${p12}text-32.svg` : "application/pdf" === e11 ? `${p12}pdf-32.svg` : "text/csv" === e11 ? `${p12}csv-32.svg` : "application/gpx+xml" === e11 ? `${p12}gpx-32.svg` : "application/x-dwf" === e11 ? `${p12}cad-32.svg` : "application/postscript" === e11 || "application/json" === e11 || "text/xml" === e11 || "model/vrml" === e11 ? `${p12}code-32.svg` : "application/x-zip-compressed" === e11 || "application/x-7z-compressed" === e11 || "application/x-gzip" === e11 || "application/x-tar" === e11 || "application/x-gtar" === e11 || "application/x-bzip2" === e11 || "application/gzip" === e11 || "application/x-compress" === e11 || "application/x-apple-diskimage" === e11 || "application/x-rar-compressed" === e11 || "application/zip" === e11 ? `${p12}zip-32.svg` : e11.includes("image/") ? `${p12}image-32.svg` : e11.includes("audio/") ? `${p12}sound-32.svg` : e11.includes("video/") ? `${p12}video-32.svg` : e11.includes("msexcel") || e11.includes("ms-excel") || e11.includes("spreadsheetml") ? `${p12}excel-32.svg` : e11.includes("msword") || e11.includes("ms-word") || e11.includes("wordprocessingml") ? `${p12}word-32.svg` : e11.includes("powerpoint") || e11.includes("presentationml") ? `${p12}report-32.svg` : `${p12}generic-32.svg` : `${p12}generic-32.svg`;
}

// node_modules/@arcgis/core/widgets/support/legacyIcon.js
var i9 = { close: "esri-icon-close", collapse: "esri-icon-collapse", down: "esri-icon-down", downArrow: "esri-icon-down-arrow", dragHorizontal: "esri-icon-drag-horizontal", dragVertical: "esri-icon-drag-vertical", duplicate: "esri-icon-duplicate", expand: "esri-icon-expand", fontFallbackText: "esri-icon-font-fallback-text", forward: "esri-icon-forward", handleVertical: "esri-icon-handle-vertical", icon: "esri-icon", left: "esri-icon-left", locateCircled: "esri-icon-locate-circled", noticeTriangle: "esri-icon-notice-triangle", pause: "esri-icon-pause", play: "esri-icon-play", plus: "esri-icon-plus", radioChecked: "esri-icon-radio-checked", radioUnchecked: "esri-icon-radio-unchecked", refresh: "esri-icon-refresh", reverse: "esri-icon-reverse", right: "esri-icon-right", search: "esri-icon-search", swap: "esri-icon-swap", table: "esri-icon-table", trash: "esri-icon-trash", up: "esri-icon-up", upArrow: "esri-icon-up-arrow", upDownArrows: "esri-icon-up-down-arrows", urbanModel: "esri-icon-urban-model", zoomInMagnifyingGlass: "esri-icon-zoom-in-magnifying-glass", zoomToObject: "esri-icon-zoom-to-object" };

// node_modules/@arcgis/core/widgets/Attachments.js
var A3 = { addButton: true, addSubmitButton: true, cancelAddButton: true, cancelUpdateButton: true, deleteButton: true, errorMessage: true, progressBar: true, updateButton: true };
var w3 = "esri-attachments";
var F3 = { base: w3, loaderContainer: `${w3}__loader-container`, loader: `${w3}__loader`, fadeIn: `${w3}--fade-in`, container: `${w3}__container`, containerList: `${w3}__container--list`, containerPreview: `${w3}__container--preview`, actions: `${w3}__actions`, deleteButton: `${w3}__delete-button`, addAttachmentButton: `${w3}__add-attachment-button`, errorMessage: `${w3}__error-message`, items: `${w3}__items`, item: `${w3}__item`, itemButton: `${w3}__item-button`, itemMask: `${w3}__item-mask`, itemMaskIcon: `${w3}__item-mask--icon`, itemImage: `${w3}__image`, itemImageResizable: `${w3}__image--resizable`, itemLabel: `${w3}__label`, itemFilename: `${w3}__filename`, itemChevronIcon: `${w3}__item-chevron-icon`, itemLink: `${w3}__item-link`, itemLinkOverlay: `${w3}__item-link-overlay`, itemLinkOverlayIcon: `${w3}__item-link-overlay-icon`, itemEditIcon: `${w3}__item-edit-icon`, itemAddIcon: `${w3}__item-add-icon`, itemAddButton: `${w3}__item-add-button`, formNode: `${w3}__form-node`, fileFieldset: `${w3}__file-fieldset`, fileLabel: `${w3}__file-label`, fileName: `${w3}__file-name`, fileInput: `${w3}__file-input`, metadata: `${w3}__metadata`, metadataFieldset: `${w3}__metadata-fieldset`, progressBar: `${w3}__progress-bar` };
var k3 = window.CSS;
var M2 = class extends B {
  constructor(e11, t6) {
    super(e11, t6), this.displayType = "auto", this.messages = null, this.messagesUnits = null, this.selectedFile = null, this.submitting = false, this.viewModel = null, this.visibleElements = { ...A3 }, this._supportsImageOrientation = k3 && k3.supports && k3.supports("image-orientation", "from-image"), this._addAttachmentForm = null, this._updateAttachmentForm = null;
  }
  normalizeCtorArgs(e11) {
    return (e11 == null ? void 0 : e11.viewModel) || (e11 = { viewModel: new y3(), ...e11 }), e11;
  }
  initialize() {
    this.addHandles([v(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.attachmentInfos;
    }, "change", () => this.scheduleRender()), v(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.fileInfos;
    }, "change", () => this.scheduleRender()), d2(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.mode;
    }, () => this._modeChanged(), P)]);
  }
  loadDependencies() {
    return r4({ icon: () => import("./calcite-icon-7LCZHQE3.js") });
  }
  get capabilities() {
    return this.viewModel.capabilities;
  }
  set capabilities(e11) {
    this.viewModel.capabilities = e11;
  }
  get effectiveDisplayType() {
    const { displayType: e11 } = this;
    return e11 && "auto" !== e11 ? e11 : this.viewModel.supportsResizeAttachments ? "preview" : "list";
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(e11) {
    this.viewModel.graphic = e11;
  }
  get icon() {
    return "attachment";
  }
  set icon(e11) {
    this._overrideIfSome("icon", e11);
  }
  get label() {
    var _a;
    return ((_a = this.messages) == null ? void 0 : _a.widgetLabel) ?? "";
  }
  set label(e11) {
    this._overrideIfSome("label", e11);
  }
  castVisibleElements(e11) {
    return { ...A3, ...e11 };
  }
  addAttachment() {
    const { _addAttachmentForm: e11, viewModel: s12 } = this;
    return this._set("submitting", true), this._set("error", null), s12.addAttachment(e11).then((e12) => (this._set("submitting", false), this._set("error", null), s12.mode = "view", e12)).catch((e12) => {
      throw this._set("submitting", false), this._set("error", new s("attachments:add-attachment", this.messages.addErrorMessage, e12)), e12;
    });
  }
  deleteAttachment(e11) {
    const { viewModel: s12 } = this;
    return this._set("submitting", true), this._set("error", null), s12.deleteAttachment(e11).then((e12) => (this._set("submitting", false), this._set("error", null), s12.mode = "view", e12)).catch((e12) => {
      throw this._set("submitting", false), this._set("error", new s("attachments:delete-attachment", this.messages.deleteErrorMessage, e12)), e12;
    });
  }
  updateAttachment() {
    const { viewModel: e11 } = this, { _updateAttachmentForm: s12 } = this;
    return this._set("submitting", true), this._set("error", null), e11.updateAttachment(s12).then((t6) => (this._set("submitting", false), this._set("error", null), e11.mode = "view", t6)).catch((e12) => {
      throw this._set("submitting", false), this._set("error", new s("attachments:update-attachment", this.messages.updateErrorMessage, e12)), e12;
    });
  }
  addFile() {
    const e11 = this.viewModel.addFile(this.selectedFile, this._addAttachmentForm);
    return this.viewModel.mode = "view", e11;
  }
  updateFile() {
    const { viewModel: e11 } = this, t6 = e11.updateFile(this.selectedFile, this._updateAttachmentForm, e11.activeFileInfo);
    return e11.mode = "view", t6;
  }
  deleteFile(e11) {
    var _a;
    const t6 = this.viewModel.deleteFile(e11 || ((_a = this.viewModel.activeFileInfo) == null ? void 0 : _a.file));
    return this.viewModel.mode = "view", t6;
  }
  render() {
    const { submitting: e11, viewModel: t6 } = this, { state: s12 } = t6;
    return n2("div", { class: this.classes(F3.base, e2.widget) }, e11 ? this._renderProgressBar() : null, "loading" === s12 ? this._renderLoading() : this._renderAttachments(), this._renderErrorMessage());
  }
  _renderErrorMessage() {
    const { error: e11, visibleElements: t6 } = this;
    return e11 && t6.errorMessage ? n2("div", { class: F3.errorMessage, key: "error-message" }, e11.message) : null;
  }
  _renderAttachments() {
    const { activeFileInfo: e11, mode: t6, activeAttachmentInfo: s12 } = this.viewModel;
    return "add" === t6 ? this._renderAddForm() : "edit" === t6 ? this._renderDetailsForm(s12 || e11) : this._renderAttachmentContainer();
  }
  _renderLoading() {
    return n2("div", { class: F3.loaderContainer, key: "loader" }, n2("div", { class: F3.loader }));
  }
  _renderProgressBar() {
    return this.visibleElements.progressBar ? n2("div", { class: F3.progressBar, key: "progress-bar" }) : null;
  }
  _renderAddForm() {
    const { submitting: e11, selectedFile: t6 } = this, s12 = e11 || !t6, i11 = this.visibleElements.cancelAddButton ? n2("button", { bind: this, class: this.classes(e2.button, e2.buttonTertiary, e2.buttonSmall, e2.buttonHalf, e11 && e2.buttonDisabled), disabled: e11, onclick: this._cancelForm, type: "button" }, this.messages.cancel) : null, a5 = this.visibleElements.addSubmitButton ? n2("button", { class: this.classes(e2.button, e2.buttonSecondary, e2.buttonSmall, e2.buttonHalf, { [e2.buttonDisabled]: s12 }), disabled: s12, type: "submit" }, this.messages.add) : null, n11 = t6 ? n2("span", { class: F3.fileName, key: "file-name" }, t6.name) : null, l9 = n2("form", { afterCreate: m2, afterRemoved: f, bind: this, "data-node-ref": "_addAttachmentForm", onsubmit: this._submitAddAttachment }, n2("fieldset", { class: F3.fileFieldset }, n11, n2("label", { class: this.classes(F3.fileLabel, e2.button, e2.buttonSecondary) }, t6 ? this.messages.changeFile : this.messages.selectFile, n2("input", { bind: this, class: F3.fileInput, name: "attachment", onchange: this._handleFileInputChange, type: "file" }))), a5, i11);
    return n2("div", { class: F3.formNode, key: "add-form-container" }, l9);
  }
  _renderDetailsForm(e11) {
    var _a, _b, _c;
    const { visibleElements: t6, viewModel: s12, selectedFile: i11, submitting: a5 } = this, { capabilities: l9 } = s12, r9 = a5 || !i11;
    let o4, d10, c14, m9;
    i11 ? (o4 = i11.type, d10 = i11.name, c14 = i11.size) : e11 && "file" in e11 ? (o4 = e11.file.type, d10 = e11.file.name, c14 = e11.file.size) : e11 && "contentType" in e11 && (o4 = e11.contentType, d10 = e11.name, c14 = e11.size, m9 = e11.url);
    const h10 = l9.editing && ((_a = l9.operations) == null ? void 0 : _a.delete) && t6.deleteButton ? n2("button", { bind: this, class: this.classes(e2.button, e2.buttonSmall, e2.buttonTertiary, F3.deleteButton, { [e2.buttonDisabled]: a5 }), disabled: a5, key: "delete-button", onclick: (t7) => this._submitDeleteAttachment(t7, e11), type: "button" }, this.messages.delete) : void 0, u9 = l9.editing && ((_b = l9.operations) == null ? void 0 : _b.update) && t6.updateButton ? n2("button", { class: this.classes(e2.button, e2.buttonSmall, e2.buttonThird, { [e2.buttonDisabled]: r9 }), disabled: r9, key: "update-button", type: "submit" }, this.messages.update) : void 0, b11 = this.visibleElements.cancelUpdateButton ? n2("button", { bind: this, class: this.classes(e2.button, e2.buttonSmall, e2.buttonTertiary, e2.buttonThird, { [e2.buttonDisabled]: a5 }), disabled: a5, key: "cancel-button", onclick: this._cancelForm, type: "button" }, this.messages.cancel) : void 0, f8 = l9.editing && ((_c = l9.operations) == null ? void 0 : _c.update) ? n2("fieldset", { class: F3.fileFieldset, key: "file" }, n2("span", { class: F3.fileName, key: "file-name" }, d10), n2("label", { class: this.classes(F3.fileLabel, e2.button, e2.buttonSecondary) }, this.messages.changeFile, n2("input", { bind: this, class: F3.fileInput, name: "attachment", onchange: this._handleFileInputChange, type: "file" }))) : void 0, v9 = n2("fieldset", { class: F3.metadataFieldset, key: "size" }, n2("label", null, T(this.messagesUnits, c14 ?? 0))), A5 = n2("fieldset", { class: F3.metadataFieldset, key: "content-type" }, n2("label", null, o4)), w11 = null != m9 ? n2("a", { class: F3.itemLink, href: m9, rel: "noreferrer", target: "_blank" }, this._renderImageMask(e11, 400), n2("div", { class: F3.itemLinkOverlay }, n2("span", { class: F3.itemLinkOverlayIcon }, n2("calcite-icon", { icon: "launch" })))) : this._renderImageMask(e11, 400), k4 = n2("form", { afterCreate: m2, afterRemoved: f, bind: this, "data-node-ref": "_updateAttachmentForm", onsubmit: (t7) => this._submitUpdateAttachment(t7, e11) }, n2("div", { class: F3.metadata }, v9, A5), f8, n2("div", { class: F3.actions }, h10, b11, u9));
    return n2("div", { class: F3.formNode, key: "edit-form-container" }, w11, k4);
  }
  _renderImageMask(e11, t6) {
    return e11 ? "file" in e11 ? this._renderGenericImageMask(e11.file.name, e11.file.type) : this._renderImageMaskForAttachment(e11, t6) : null;
  }
  _renderGenericImageMask(e11, t6) {
    const { supportsResizeAttachments: s12 } = this.viewModel, i11 = p5(t6), a5 = { [F3.itemImageResizable]: s12 };
    return n2("div", { class: this.classes(F3.itemMaskIcon, F3.itemMask), key: i11 }, n2("img", { alt: e11, class: this.classes(a5, F3.itemImage), src: i11, title: e11 }));
  }
  _renderImageMaskForAttachment(e11, t6) {
    const { supportsResizeAttachments: s12 } = this.viewModel;
    if (!e11) return null;
    const { contentType: i11, name: a5, url: n11 } = e11;
    if (!s12 || !e4(i11)) return this._renderGenericImageMask(a5, i11);
    const l9 = this._getCSSTransform(e11), r9 = l9 ? { transform: l9, "image-orientation": "none" } : {}, o4 = `${n11}${(n11 == null ? void 0 : n11.includes("?")) ? "&" : "?"}w=${t6}`, d10 = { [F3.itemImageResizable]: s12 };
    return n2("div", { class: this.classes(F3.itemMask), key: o4 }, n2("img", { alt: a5, class: this.classes(d10, F3.itemImage), src: o4, styles: r9, title: a5 }));
  }
  _renderFile(e11) {
    const { file: t6 } = e11;
    return n2("li", { class: F3.item, key: t6 }, n2("button", { "aria-label": this.messages.attachmentDetails, bind: this, class: F3.itemButton, key: "details-button", onclick: () => this._startEditFile(e11), title: this.messages.attachmentDetails, type: "button" }, this._renderImageMask(e11), n2("label", { class: F3.itemLabel }, n2("span", { class: F3.itemFilename }, t6.name || this.messages.noTitle), n2("span", { "aria-hidden": "true", class: this.classes(F3.itemChevronIcon, u2(this.container) ? i9.left : i9.right) }))));
  }
  _renderAttachmentInfo({ attachmentInfo: e11, displayType: t6 }) {
    const { viewModel: s12, effectiveDisplayType: i11 } = this, { capabilities: a5, supportsResizeAttachments: n11 } = s12, { contentType: l9, name: r9, url: o4 } = e11, d10 = this._renderImageMask(e11, "list" === t6 ? 48 : 400), c14 = a5.editing ? n2("span", { "aria-hidden": "true", class: this.classes(F3.itemChevronIcon, u2(this.container) ? i9.left : i9.right) }) : null, m9 = [d10, "preview" === i11 && n11 && e4(l9) ? null : n2("label", { class: F3.itemLabel }, n2("span", { class: F3.itemFilename }, r9 || this.messages.noTitle), c14)], u9 = a5.editing ? n2("button", { "aria-label": this.messages.attachmentDetails, bind: this, class: F3.itemButton, "data-attachment-info-id": e11.id, key: "details-button", onclick: () => this._startEditAttachment(e11), title: this.messages.attachmentDetails, type: "button" }, m9) : n2("a", { class: F3.itemButton, href: o4 ?? void 0, key: "details-link", rel: "noreferrer", target: "_blank" }, m9);
    return n2("li", { class: F3.item, key: e11 }, u9);
  }
  _renderAttachmentContainer() {
    var _a;
    const { effectiveDisplayType: e11, viewModel: t6, visibleElements: s12 } = this, { attachmentInfos: i11, capabilities: a5, fileInfos: n11 } = t6, l9 = !!(i11 == null ? void 0 : i11.length), r9 = !!(n11 == null ? void 0 : n11.length), o4 = { [F3.containerList]: "preview" !== e11, [F3.containerPreview]: "preview" === e11 }, d10 = a5.editing && ((_a = a5.operations) == null ? void 0 : _a.add) && s12.addButton ? n2("button", { bind: this, class: this.classes(e2.button, e2.buttonTertiary, F3.addAttachmentButton), onclick: () => this._startAddAttachment(), type: "button" }, n2("span", { "aria-hidden": "true", class: this.classes(F3.itemAddIcon, i9.plus) }), this.messages.add) : void 0, c14 = l9 ? n2("ul", { class: F3.items, key: "attachments-list" }, i11.toArray().map((t7) => this._renderAttachmentInfo({ attachmentInfo: t7, displayType: e11 }))) : void 0, m9 = r9 ? n2("ul", { class: F3.items, key: "file-list" }, n11.toArray().map((e12) => this._renderFile(e12))) : void 0, h10 = r9 || l9 ? void 0 : n2("div", { class: e2.empty }, this.messages.noAttachments);
    return n2("div", { class: this.classes(F3.container, o4), key: "attachments-container" }, c14, m9, h10, d10);
  }
  _modeChanged() {
    this._set("error", null), this._set("selectedFile", null);
  }
  _handleFileInputChange(e11) {
    var _a;
    const t6 = e11.target, s12 = (_a = t6.files) == null ? void 0 : _a.item(0);
    this._set("selectedFile", s12);
  }
  _submitDeleteAttachment(e11, t6) {
    e11.preventDefault(), t6 && ("file" in t6 ? this.deleteFile(t6.file) : t6 && this.deleteAttachment(t6));
  }
  _submitAddAttachment(e11) {
    e11.preventDefault(), this.viewModel.filesEnabled ? this.addFile() : this.addAttachment();
  }
  _submitUpdateAttachment(e11, t6) {
    e11.preventDefault(), t6 && "file" in t6 ? this.updateFile() : this.updateAttachment();
  }
  _startEditAttachment(e11) {
    const { viewModel: t6 } = this;
    t6.activeFileInfo = null, t6.activeAttachmentInfo = e11, t6.mode = "edit";
  }
  _startEditFile(e11) {
    const { viewModel: t6 } = this;
    t6.activeAttachmentInfo = null, t6.activeFileInfo = e11, t6.mode = "edit";
  }
  _startAddAttachment() {
    this.viewModel.mode = "add";
  }
  _cancelForm(e11) {
    e11.preventDefault(), this.viewModel.mode = "view";
  }
  _getCSSTransform(e11) {
    const { orientationInfo: t6 } = e11;
    return !this._supportsImageOrientation && t6 ? [t6.rotation ? `rotate(${t6.rotation}deg)` : "", t6.mirrored ? "scaleX(-1)" : ""].join(" ") : "";
  }
};
r([m()], M2.prototype, "capabilities", null), r([m()], M2.prototype, "displayType", void 0), r([m({ readOnly: true })], M2.prototype, "effectiveDisplayType", null), r([m()], M2.prototype, "graphic", null), r([m()], M2.prototype, "icon", null), r([m()], M2.prototype, "label", null), r([m(), e("esri/widgets/Attachments/t9n/Attachments")], M2.prototype, "messages", void 0), r([m(), e("esri/core/t9n/Units")], M2.prototype, "messagesUnits", void 0), r([m({ readOnly: true })], M2.prototype, "selectedFile", void 0), r([m({ readOnly: true })], M2.prototype, "submitting", void 0), r([m({ readOnly: true })], M2.prototype, "error", void 0), r([m({ type: y3 })], M2.prototype, "viewModel", void 0), r([m()], M2.prototype, "visibleElements", void 0), r([s3("visibleElements")], M2.prototype, "castVisibleElements", null), M2 = r([a("esri.widgets.Attachments")], M2);
var I3 = M2;

// node_modules/@arcgis/core/widgets/Feature/FeatureAttachments/FeatureAttachmentsViewModel.js
var s7 = class extends y3 {
  constructor(t6) {
    super(t6), this.description = null, this.title = null;
  }
};
r([m()], s7.prototype, "description", void 0), r([m()], s7.prototype, "title", void 0), s7 = r([a("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")], s7);
var c5 = s7;

// node_modules/@arcgis/core/widgets/support/Heading.js
function e5({ level: r9, class: e11, ...n11 }, l9) {
  const a5 = s8(r9);
  return n2(`h${a5}`, { ...n11, "aria-level": String(a5), class: l2(e2.heading, e11), role: "heading" }, l9);
}
function s8(t6) {
  return r6(Math.ceil(t6), 1, 6);
}

// node_modules/@arcgis/core/widgets/Feature/support/FeatureElementInfo.js
var n5 = "esri-feature-element-info";
var p6 = { base: n5, title: `${n5}__title`, description: `${n5}__description` };
var c6 = class extends B {
  constructor(e11, t6) {
    super(e11, t6), this.description = null, this.headingLevel = 2, this.title = null;
  }
  render() {
    return n2("div", { class: p6.base }, this._renderTitle(), this._renderDescription());
  }
  _renderTitle() {
    const { title: e11 } = this;
    return e11 ? n2(e5, { class: p6.title, innerHTML: e11, level: this.headingLevel }) : null;
  }
  _renderDescription() {
    const { description: e11 } = this;
    return e11 ? n2("div", { class: p6.description, innerHTML: e11, key: "description" }) : null;
  }
};
r([m()], c6.prototype, "description", void 0), r([m()], c6.prototype, "headingLevel", void 0), r([m()], c6.prototype, "title", void 0), c6 = r([a("esri.widgets.Feature.support.FeatureElementInfo")], c6);
var l4 = c6;

// node_modules/@arcgis/core/widgets/Feature/FeatureAttachments.js
var d6 = { base: "esri-feature-attachments" };
var h4 = class extends B {
  constructor(e11, t6) {
    super(e11, t6), this._featureElementInfo = null, this.attachmentsWidget = new I3(), this.headingLevel = 2, this.viewModel = new c5();
  }
  initialize() {
    this._featureElementInfo = new l4(), this.addHandles([d2(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.description, (_b = this.viewModel) == null ? void 0 : _b.title, this.headingLevel];
    }, () => this._setupFeatureElementInfo(), P), d2(() => this.viewModel, (e11) => this.attachmentsWidget.viewModel = e11, P)]);
  }
  destroy() {
    var _a;
    this.attachmentsWidget.viewModel = null, this.attachmentsWidget.destroy(), (_a = this._featureElementInfo) == null ? void 0 : _a.destroy();
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e11) {
    this.viewModel.description = e11;
  }
  get displayType() {
    return this.attachmentsWidget.displayType;
  }
  set displayType(e11) {
    this.attachmentsWidget.displayType = e11;
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(e11) {
    this.viewModel.graphic = e11;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e11) {
    this.viewModel.title = e11;
  }
  render() {
    var _a;
    const { attachmentsWidget: e11 } = this;
    return n2("div", { class: d6.base }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), e11 == null ? void 0 : e11.render());
  }
  _setupFeatureElementInfo() {
    var _a;
    const { description: e11, title: t6, headingLevel: i11 } = this;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: e11, title: t6, headingLevel: i11 });
  }
};
r([m({ readOnly: true })], h4.prototype, "attachmentsWidget", void 0), r([m()], h4.prototype, "description", null), r([m()], h4.prototype, "displayType", null), r([m()], h4.prototype, "graphic", null), r([m()], h4.prototype, "headingLevel", void 0), r([m()], h4.prototype, "title", null), r([m({ type: c5 })], h4.prototype, "viewModel", void 0), h4 = r([a("esri.widgets.Feature.FeatureAttachments")], h4);
var c7 = h4;

// node_modules/@arcgis/core/widgets/Feature/FeatureContent/FeatureContentViewModel.js
var c8 = class extends b2 {
  constructor(t6) {
    super(t6), this._loadingPromise = null, this.created = null, this.creator = null, this.destroyer = null, this.graphic = null, this.addHandles(d2(() => this.creator, (t7) => {
      this._destroyContent(), this._createContent(t7);
    }, P));
  }
  destroy() {
    this._destroyContent();
  }
  get state() {
    return this._loadingPromise ? "loading" : "ready";
  }
  _destroyContent() {
    const { created: t6, graphic: e11, destroyer: r9 } = this;
    t6 && e11 && (E2({ type: "content", value: r9, event: { graphic: e11 } }), this._set("created", null));
  }
  async _createContent(t6) {
    const e11 = this.graphic;
    if (!e11 || !t6) return;
    const r9 = E2({ type: "content", value: t6, event: { graphic: e11 } });
    this._loadingPromise = r9, this.notifyChange("state");
    const o4 = await r9;
    r9 === this._loadingPromise && (this._loadingPromise = null, this.notifyChange("state"), this._set("created", o4));
  }
};
r([m({ readOnly: true })], c8.prototype, "created", void 0), r([m()], c8.prototype, "creator", void 0), r([m()], c8.prototype, "destroyer", void 0), r([m({ type: d3 })], c8.prototype, "graphic", void 0), r([m({ readOnly: true })], c8.prototype, "state", null), c8 = r([a("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")], c8);
var p7 = c8;

// node_modules/@arcgis/core/widgets/support/decorators/vmEvent.js
function e6(e11) {
  return (a5) => {
    a5.hasOwnProperty("_delegatedEventNames") || (a5._delegatedEventNames = a5._delegatedEventNames ? a5._delegatedEventNames.slice() : []);
    const n11 = a5._delegatedEventNames, r9 = Array.isArray(e11) ? e11 : t(e11);
    n11.push(...r9);
  };
}
function t(e11) {
  return e11.split(",").map((e12) => e12.trim());
}

// node_modules/@arcgis/core/widgets/support/widget.js
function e7(e11) {
  return e11 && "function" == typeof e11.render;
}
function t3(e11) {
  return e11 && "function" == typeof e11.postMixInProperties && "function" == typeof e11.buildRendering && "function" == typeof e11.postCreate && "function" == typeof e11.startup;
}

// node_modules/@arcgis/core/widgets/Feature/FeatureContent.js
var n7 = "esri-feature-content";
var c10 = { base: n7, loaderContainer: `${n7}__loader-container`, loader: `${n7}__loader` };
var l5 = class extends B {
  constructor(e11, r9) {
    super(e11, r9), this.viewModel = null, this._addTargetToAnchors = (e12) => {
      Array.from(e12.querySelectorAll("a")).forEach((e13) => {
        v2(e13.href) && !e13.hasAttribute("target") && e13.setAttribute("target", "_blank");
      });
    };
  }
  get creator() {
    var _a;
    return (_a = this.viewModel) == null ? void 0 : _a.creator;
  }
  set creator(e11) {
    this.viewModel && (this.viewModel.creator = e11);
  }
  get graphic() {
    var _a;
    return (_a = this.viewModel) == null ? void 0 : _a.graphic;
  }
  set graphic(e11) {
    this.viewModel && (this.viewModel.graphic = e11);
  }
  render() {
    var _a;
    const e11 = (_a = this.viewModel) == null ? void 0 : _a.state;
    return n2("div", { class: c10.base }, "loading" === e11 ? this._renderLoading() : this._renderCreated());
  }
  _renderLoading() {
    return n2("div", { class: c10.loaderContainer, key: "loader" }, n2("div", { class: c10.loader }));
  }
  _renderCreated() {
    var _a;
    const e11 = (_a = this.viewModel) == null ? void 0 : _a.created;
    return e11 ? e11 instanceof HTMLElement ? n2("div", { afterCreate: this._attachToNode, bind: e11, key: e11 }) : e7(e11) ? n2("div", { key: e11 }, !e11.destroyed && e11.render()) : n2("div", { afterCreate: this._addTargetToAnchors, innerHTML: e11, key: e11 }) : null;
  }
  _attachToNode(e11) {
    const r9 = this;
    e11.appendChild(r9);
  }
};
r([m()], l5.prototype, "creator", null), r([m()], l5.prototype, "graphic", null), r([m({ type: p7 })], l5.prototype, "viewModel", void 0), l5 = r([a("esri.widgets.Feature.FeatureContent")], l5);
var p9 = l5;

// node_modules/@arcgis/core/widgets/Feature/FeatureFields/FeatureFieldsViewModel.js
var l6 = class extends b2 {
  constructor(o4) {
    super(o4), this.attributes = null, this.expressionInfos = null, this.description = null, this.fieldInfos = null, this.title = null;
  }
  get formattedFieldInfos() {
    const { expressionInfos: o4, fieldInfos: e11 } = this, t6 = [];
    return e11 == null ? void 0 : e11.forEach((e12) => {
      if (!(!e12.hasOwnProperty("visible") || e12.visible)) return;
      const s12 = e12.clone();
      s12.label = U2(s12, o4), t6.push(s12);
    }), t6;
  }
};
r([m()], l6.prototype, "attributes", void 0), r([m({ type: [i7] })], l6.prototype, "expressionInfos", void 0), r([m()], l6.prototype, "description", void 0), r([m({ type: [n4] })], l6.prototype, "fieldInfos", void 0), r([m({ readOnly: true })], l6.prototype, "formattedFieldInfos", null), r([m()], l6.prototype, "title", void 0), l6 = r([a("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")], l6);
var n8 = l6;

// node_modules/@arcgis/core/widgets/support/uriUtils.js
var s9 = [{ pattern: /^\s*(https?:\/\/([^\s]+))\s*$/i, target: "_blank", label: "{messages.view}" }, { pattern: /^\s*(tel:([^\s]+))\s*$/i, label: "{hierPart}" }, { pattern: /^\s*(mailto:([^\s]+))\s*$/i, label: "{hierPart}" }, { pattern: /^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "App Studio Player" }, { pattern: /^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Collector" }, { pattern: /^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Explorer" }, { pattern: /^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Navigator" }, { pattern: /^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Survey123" }, { pattern: /^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Trek2There" }, { pattern: /^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Workforce" }, { pattern: /^\s*(iform:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "iForm" }, { pattern: /^\s*(flow:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "FlowFinity" }, { pattern: /^\s*(lfmobile:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Laserfische" }, { pattern: /^\s*(mspbi:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Microsoft Power Bi" }];
function a3(a5, p12) {
  if ("string" != typeof p12 || !p12) return p12;
  const r9 = s9.find((e11) => e11.pattern.test(p12));
  if (!r9) return p12;
  const t6 = p12.match(r9.pattern), n11 = t6 == null ? void 0 : t6[2], l9 = r2(r2(r9.label, { messages: a5, hierPart: n11 }), { appName: r9.appName }), i11 = r9.target ? ` target="${r9.target}"` : "", o4 = "_blank" === r9.target ? ' rel="noreferrer"' : "";
  return p12.replace(r9.pattern, `<a${i11} href="$1"${o4}>${l9}</a>`);
}

// node_modules/@arcgis/core/widgets/Feature/FeatureFields.js
var u5 = "esri-feature-fields";
var m5 = { base: u5, fieldHeader: `${u5}__field-header`, fieldData: `${u5}__field-data`, fieldDataDate: `${u5}__field-data--date` };
var c11 = class extends B {
  constructor(e11, t6) {
    super(e11, t6), this._featureElementInfo = null, this.viewModel = new n8(), this.messages = null, this.messagesURIUtils = null;
  }
  initialize() {
    this._featureElementInfo = new l4(), this.addHandles(d2(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.description, (_b = this.viewModel) == null ? void 0 : _b.title];
    }, () => this._setupFeatureElementInfo(), P));
  }
  destroy() {
    var _a;
    (_a = this._featureElementInfo) == null ? void 0 : _a.destroy();
  }
  get attributes() {
    return this.viewModel.attributes;
  }
  set attributes(e11) {
    this.viewModel.attributes = e11;
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e11) {
    this.viewModel.description = e11;
  }
  get expressionInfos() {
    return this.viewModel.expressionInfos;
  }
  set expressionInfos(e11) {
    this.viewModel.expressionInfos = e11;
  }
  get fieldInfos() {
    return this.viewModel.fieldInfos;
  }
  set fieldInfos(e11) {
    this.viewModel.fieldInfos = e11;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e11) {
    this.viewModel.title = e11;
  }
  render() {
    var _a;
    return n2("div", { class: m5.base }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), this._renderFields());
  }
  _renderFieldInfo(e11, t6) {
    var _a;
    const { attributes: s12 } = this.viewModel, i11 = e11.fieldName || "", r9 = e11.label || i11, o4 = s12 ? null == s12[i11] ? "" : s12[i11] : "", l9 = !!((_a = e11.format) == null ? void 0 : _a.dateFormat), n11 = "number" == typeof o4 && !l9 ? this._forceLTR(o4) : a3(this.messagesURIUtils, o4), d10 = { [m5.fieldDataDate]: l9 };
    return n2("tr", { key: `fields-element-info-row-${i11}-${t6}` }, n2("th", { class: m5.fieldHeader, innerHTML: r9, key: `fields-element-info-row-header-${i11}-${t6}` }), n2("td", { class: this.classes(m5.fieldData, d10), innerHTML: n11, key: `fields-element-info-row-data-${i11}-${t6}` }));
  }
  _renderFields() {
    const { formattedFieldInfos: e11 } = this.viewModel;
    return (e11 == null ? void 0 : e11.length) ? n2("table", { class: e2.table, summary: this.messages.fieldsSummary }, n2("tbody", null, e11.map((e12, t6) => this._renderFieldInfo(e12, t6)))) : null;
  }
  _setupFeatureElementInfo() {
    var _a;
    const { description: e11, title: t6 } = this;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: e11, title: t6 });
  }
  _forceLTR(e11) {
    return `&lrm;${e11}`;
  }
};
r([m()], c11.prototype, "attributes", null), r([m()], c11.prototype, "description", null), r([m()], c11.prototype, "expressionInfos", null), r([m()], c11.prototype, "fieldInfos", null), r([m()], c11.prototype, "title", null), r([m({ type: n8, nonNullable: true })], c11.prototype, "viewModel", void 0), r([m(), e("esri/widgets/Feature/t9n/Feature")], c11.prototype, "messages", void 0), r([m(), e("esri/widgets/support/t9n/uriUtils")], c11.prototype, "messagesURIUtils", void 0), c11 = r([a("esri.widgets.Feature.FeatureFields")], c11);
var h6 = c11;

// node_modules/@arcgis/core/widgets/Legend/support/heatmapRampUtils.js
function r8(r9) {
  if (!r9.colorStops) return [];
  const e11 = [...r9.colorStops].filter((o4) => {
    var _a;
    return ((_a = o4.color) == null ? void 0 : _a.a) > 0;
  });
  let t6 = e11.length - 1;
  if (e11 && e11[0]) {
    const r10 = e11[t6];
    r10 && 1 !== r10.ratio && (e11.push(new l3({ ratio: 1, color: r10.color })), t6++);
  }
  return e11.map((o4, e12) => {
    var _a, _b;
    let l9 = "";
    return 0 === e12 ? l9 = ((_a = r9.legendOptions) == null ? void 0 : _a.minLabel) || "low" : e12 === t6 && (l9 = ((_b = r9.legendOptions) == null ? void 0 : _b.maxLabel) || "high"), { color: o4.color, label: l9, ratio: o4.ratio };
  }).reverse();
}

// node_modules/@arcgis/core/renderers/support/utils.js
var v4 = E("short-date");
async function w5(e11, l9, t6) {
  r3(e11, l9, () => []).push(...t6);
}
async function x2(l9) {
  var _a, _b;
  const t6 = /* @__PURE__ */ new Map();
  if (!l9) return t6;
  if ("visualVariables" in l9 && l9.visualVariables) {
    const e11 = l9.visualVariables.filter((e12) => "color" === e12.type);
    for (const l10 of e11) {
      const e12 = (await r7(l10) ?? []).map((e13) => e13.color);
      await w5(t6, l10.field || l10.valueExpression, e12);
    }
  }
  if ("heatmap" === l9.type) {
    const e11 = r8(l9).map((e12) => e12.color);
    await w5(t6, l9.field || l9.valueExpression, e11);
  } else if ("pie-chart" === l9.type) {
    for (const e11 of l9.attributes) await w5(t6, e11.field || e11.valueExpression, [e11.color]);
    await w5(t6, "default", [(_a = l9 == null ? void 0 : l9.othersCategory) == null ? void 0 : _a.color, h2(l9.backgroundFillSymbol, null)]);
  } else if ("dot-density" === l9.type) {
    for (const e11 of l9.attributes) await w5(t6, e11.field || e11.valueExpression, [e11.color]);
    await w5(t6, "default", [l9.backgroundColor]);
  } else if ("unique-value" === l9.type) if ("predominance" === ((_b = l9.authoringInfo) == null ? void 0 : _b.type)) for (const e11 of l9.uniqueValueInfos ?? []) await w5(t6, e11.value.toString(), [h2(e11.symbol, null)]);
  else {
    const e11 = (l9.uniqueValueInfos ?? []).map((e12) => h2(e12.symbol, null)), { field: i11, field2: o4, field3: a5, valueExpression: n11 } = l9;
    (i11 || n11) && await w5(t6, i11 || n11, e11), o4 && await w5(t6, o4, e11), a5 && await w5(t6, a5, e11);
  }
  else if ("class-breaks" === l9.type) {
    const e11 = l9.classBreakInfos.map((e12) => h2(e12.symbol, null)), { field: i11, valueExpression: o4 } = l9;
    await w5(t6, i11 ?? o4, e11);
  } else "simple" === l9.type && await w5(t6, "default", [h2(l9.symbol, null)]);
  return "defaultSymbol" in l9 && l9.defaultSymbol && await w5(t6, "default", [h2(l9.defaultSymbol, null)]), t6.forEach((l10, i11) => {
    const o4 = i(l10.filter(Boolean), (e11, l11) => JSON.stringify(e11) === JSON.stringify(l11));
    t6.set(i11, o4);
  }), t6;
}

// node_modules/@arcgis/core/widgets/Feature/support/relatedFeatureUtils.js
var d8 = "esri.widgets.Feature.support.relatedFeatureUtils";
var p10 = () => n.getLogger(d8);
var m6 = /* @__PURE__ */ new Map();
function h7(e11) {
  if (!ye(e11)) return null;
  const [t6, r9] = e11.split("/").slice(1);
  return { layerId: t6, fieldName: r9 };
}
function y5(e11, t6) {
  if (!t6.relationships) return null;
  let r9 = null;
  const { relationships: i11 } = t6;
  return i11.some((t7) => t7.id === parseInt(e11, 10) && (r9 = t7, true)), r9;
}
function I4({ originRelationship: e11, relationships: t6, layerId: r9 }) {
  return t6.find(({ relatedTableId: t7, id: i11 }) => `${t7}` === r9 && i11 === (e11 == null ? void 0 : e11.id)) ?? null;
}
function F4(e11, t6) {
  const r9 = t6.toLowerCase();
  for (const i11 in e11) if (i11.toLowerCase() === r9) return e11[i11];
  return null;
}
function g2(e11, t6) {
  const r9 = y5(e11, t6);
  if (!r9) return;
  return { url: `${t6.url}/${r9.relatedTableId}`, sourceSpatialReference: t6.spatialReference, relation: r9, relatedFields: [], outStatistics: [] };
}
function S2(e11, t6) {
  if (!t6) return;
  if (!e11) return;
  const { features: r9, statsFeatures: i11 } = e11, o4 = r9 == null ? void 0 : r9.value;
  t6.relatedFeatures = o4 ? o4.features : [];
  const s12 = i11 == null ? void 0 : i11.value;
  t6.relatedStatsFeatures = s12 ? s12.features : [];
}
function b5(e11, t6, r9, i11) {
  var _a;
  const o4 = new d4();
  return o4.outFields = ["*"], o4.relationshipId = "number" == typeof t6.id ? t6.id : parseInt(t6.id, 10), o4.objectIds = [e11.attributes[r9.objectIdField]], o4.gdbVersion = r9.gdbVersion ?? null, o4.historicMoment = r9.historicMoment ?? null, ((_a = r9.queryRelatedFeatures) == null ? void 0 : _a.call(r9, o4, i11)) ?? Promise.resolve({});
}
function w6(e11, t6, r9) {
  let i11 = 0;
  const o4 = [];
  for (; i11 < t6.length; ) o4.push(`${e11} IN (${t6.slice(i11, r9 + i11)})`), i11 += r9;
  return o4.join(" OR ");
}
function j6(e11) {
  return e11 ? i(e11) : void 0;
}
function R2(e11) {
  return e11 ? i(e11, (e12, t6) => JSON.stringify(e12.toJSON()) === JSON.stringify(t6.toJSON())) : void 0;
}
async function $3(e11, t6, r9, i11) {
  const o4 = r9.layerId.toString(), { layerInfo: u9, relation: c14, relatedFields: f8, outStatistics: d10, url: p12, sourceSpatialReference: m9 } = t6, h10 = j6(f8), y10 = R2(d10);
  if (!u9 || !c14) return null;
  const g10 = I4({ originRelationship: c14, relationships: u9.relationships, layerId: o4 });
  if ((g10 == null ? void 0 : g10.relationshipTableId) && g10.keyFieldInRelationshipTable) {
    const t7 = (await b5(e11, g10, r9, i11))[e11.attributes[r9.objectIdField]];
    if (!t7) return null;
    const o5 = t7.features.map((e12) => e12.attributes[u9.objectIdField]);
    if ((y10 == null ? void 0 : y10.length) && u9.supportsStatistics) {
      const e12 = new b3();
      e12.where = w6(u9.objectIdField, o5, 1e3), e12.outFields = h10, e12.outStatistics = y10, e12.sourceSpatialReference = m9;
      const r10 = { features: Promise.resolve(t7), statsFeatures: s5(p12, e12) };
      return y(r10);
    }
  }
  const S4 = g10 == null ? void 0 : g10.keyField;
  if (S4) {
    const t7 = pe(L2(u9.fields, S4)), o5 = F4(e11.attributes, c14.keyField), f9 = t7 ? `${S4}=${o5}` : `${S4}='${o5}'`, d11 = r9.historicMoment, I8 = r9.gdbVersion, g11 = s5(p12, new b3({ where: f9, outFields: h10, sourceSpatialReference: m9, historicMoment: d11, gdbVersion: I8 }), i11), b11 = !!(y10 == null ? void 0 : y10.length) && u9.supportsStatistics ? s5(p12, new b3({ where: f9, outFields: h10, outStatistics: y10, sourceSpatialReference: m9 }), i11) : null, w11 = { features: g11 };
    return b11 && (w11.statsFeatures = b11), y(w11);
  }
  return null;
}
function N2(t6, r9) {
  return U(t6, { query: { f: "json" }, signal: r9 == null ? void 0 : r9.signal });
}
function v5({ relatedInfos: e11, layer: t6 }, i11) {
  const n11 = {};
  return e11.forEach((e12, i12) => {
    const { relation: o4 } = e12;
    if (!o4) {
      const e13 = new s("relation-required", "A relation is required on a layer to retrieve related records.");
      throw p10().error(e13), e13;
    }
    const { relatedTableId: s12 } = o4;
    if ("number" != typeof s12) {
      const e13 = new s("A related table ID is required on a layer to retrieve related records.");
      throw p10().error(e13), e13;
    }
    const l9 = `${t6.url}/${s12}`, a5 = m6.get(l9), u9 = a5 ?? N2(l9);
    a5 || m6.set(l9, u9), n11[i12] = u9;
  }), h(y(n11), i11);
}
function T3({ graphic: e11, relatedInfos: t6, layer: r9 }, i11) {
  const o4 = {};
  return t6.forEach((t7, s12) => {
    t7.layerInfo && (o4[s12] = $3(e11, t7, r9, i11));
  }), y(o4);
}
function q2({ relatedInfo: e11, fieldName: t6, fieldInfo: r9 }) {
  var _a, _b;
  if ((_a = e11.relatedFields) == null ? void 0 : _a.push(t6), r9.statisticType) {
    const i11 = new m3({ statisticType: r9.statisticType, onStatisticField: t6, outStatisticFieldName: t6 });
    (_b = e11.outStatistics) == null ? void 0 : _b.push(i11);
  }
}
function L2(e11, t6) {
  if (null != e11) {
    t6 = t6.toLowerCase();
    for (const r9 of e11) if (r9 && r9.name.toLowerCase() === t6) return r9;
  }
  return null;
}

// node_modules/@arcgis/core/widgets/Feature/FeatureMedia/FeatureMediaViewModel.js
var I5 = { chartAnimation: true };
var v6 = class extends b2 {
  constructor(t6) {
    super(t6), this.abilities = { ...I5 }, this.activeMediaInfoIndex = 0, this.attributes = null, this.description = null, this.fieldInfoMap = null, this.formattedAttributes = null, this.expressionAttributes = null, this.isAggregate = false, this.layer = null, this.mediaInfos = null, this.popupTemplate = null, this.relatedInfos = null, this.title = null;
  }
  castAbilities(t6) {
    return { ...I5, ...t6 };
  }
  get activeMediaInfo() {
    return this.formattedMediaInfos[this.activeMediaInfoIndex] || null;
  }
  get formattedMediaInfos() {
    return this._formatMediaInfos() || [];
  }
  get formattedMediaInfoCount() {
    return this.formattedMediaInfos.length;
  }
  setActiveMedia(t6) {
    this._setContentElementMedia(t6);
  }
  next() {
    this._pageContentElementMedia(1);
  }
  previous() {
    this._pageContentElementMedia(-1);
  }
  _setContentElementMedia(t6) {
    const { formattedMediaInfoCount: e11 } = this, i11 = (t6 + e11) % e11;
    this.activeMediaInfoIndex = i11;
  }
  _pageContentElementMedia(t6) {
    const { activeMediaInfoIndex: e11 } = this, i11 = e11 + t6;
    this._setContentElementMedia(i11);
  }
  _formatMediaInfos() {
    const { mediaInfos: t6, layer: e11 } = this, o4 = this.attributes ?? {}, r9 = this.formattedAttributes ?? {}, a5 = this.expressionAttributes ?? {}, s12 = this.fieldInfoMap ?? /* @__PURE__ */ new Map();
    return (t6 == null ? void 0 : t6.map((t7) => {
      const i11 = t7 == null ? void 0 : t7.clone();
      if (!i11) return null;
      if (i11.title = D({ attributes: o4, fieldInfoMap: s12, globalAttributes: r9, expressionAttributes: a5, layer: e11, text: i11.title }), i11.caption = D({ attributes: o4, fieldInfoMap: s12, globalAttributes: r9, expressionAttributes: a5, layer: e11, text: i11.caption }), i11.altText = D({ attributes: o4, fieldInfoMap: s12, globalAttributes: r9, expressionAttributes: a5, layer: e11, text: i11.altText }), "image" === i11.type) {
        if (!i11.value) return;
        return this._setImageValue({ value: i11.value, formattedAttributes: r9, layer: e11 }), i11.value.sourceURL ? i11 : void 0;
      }
      if ("pie-chart" === i11.type || "line-chart" === i11.type || "column-chart" === i11.type || "bar-chart" === i11.type) {
        if (!i11.value) return;
        return this._setChartValue({ value: i11.value, chartType: i11.type, attributes: o4, formattedAttributes: r9, layer: e11, expressionAttributes: a5 }), i11;
      }
      return null;
    }).filter(F)) ?? [];
  }
  _setImageValue(t6) {
    const e11 = this.fieldInfoMap ?? /* @__PURE__ */ new Map(), { value: i11, formattedAttributes: o4, layer: r9 } = t6, { linkURL: a5, sourceURL: s12 } = i11;
    if (s12) {
      const t7 = Q(s12, r9);
      i11.sourceURL = z({ formattedAttributes: o4, template: t7, fieldInfoMap: e11 });
    }
    if (a5) {
      const t7 = Q(a5, r9);
      i11.linkURL = z({ formattedAttributes: o4, template: t7, fieldInfoMap: e11 });
    }
  }
  _setChartValue(t6) {
    const { value: e11, attributes: i11, formattedAttributes: o4, chartType: r9, layer: a5, expressionAttributes: s12 } = t6, { popupTemplate: l9, relatedInfos: n11 } = this, { fields: p12, normalizeField: d10 } = e11, m9 = a5;
    e11.fields = R(p12, m9), d10 && (e11.normalizeField = M(d10, m9));
    if (!p12.some((t7) => !!(null != o4[t7] || ye(t7) && (n11 == null ? void 0 : n11.size)))) return;
    const h10 = (l9 == null ? void 0 : l9.fieldInfos) ?? [];
    p12.forEach((t7, a6) => {
      var _a;
      const l10 = (_a = e11.colors) == null ? void 0 : _a[a6];
      if (ye(t7)) return void (e11.series = [...e11.series, ...this._getRelatedChartInfos({ fieldInfos: h10, fieldName: t7, formattedAttributes: o4, chartType: r9, value: e11, color: l10 })]);
      const n12 = this._getChartOption({ value: e11, attributes: i11, chartType: r9, formattedAttributes: o4, expressionAttributes: s12, fieldName: t7, fieldInfos: h10, color: l10 });
      e11.series.push(n12);
    });
  }
  _getRelatedChartInfos(t6) {
    var _a;
    const { fieldInfos: e11, fieldName: i11, formattedAttributes: o4, chartType: r9, value: a5, color: s12 } = t6, l9 = [], n11 = h7(i11), p12 = n11 && ((_a = this.relatedInfos) == null ? void 0 : _a.get(n11.layerId.toString()));
    if (!p12) return l9;
    const { relatedFeatures: d10, relation: u9 } = p12;
    if (!u9 || !d10) return l9;
    const { cardinality: f8 } = u9;
    d10.forEach((t7) => {
      const { attributes: p13 } = t7;
      p13 && Object.keys(p13).forEach((t8) => {
        t8 === n11.fieldName && l9.push(this._getChartOption({ value: a5, attributes: p13, formattedAttributes: o4, fieldName: i11, chartType: r9, relatedFieldName: t8, hasMultipleRelatedFeatures: (d10 == null ? void 0 : d10.length) > 1, fieldInfos: e11, color: s12 }));
      });
    });
    return "one-to-many" === f8 || "many-to-many" === f8 ? l9 : [l9[0]];
  }
  _getTooltip({ label: t6, value: e11, chartType: i11 }) {
    return "pie-chart" === i11 ? `${t6}` : `${t6}: ${e11}`;
  }
  _getChartOption(t6) {
    var _a;
    const { value: e11, attributes: i11, formattedAttributes: o4, expressionAttributes: r9, fieldName: a5, relatedFieldName: n11, fieldInfos: p12, chartType: d10, hasMultipleRelatedFeatures: u9, color: I8 } = t6, v9 = this.layer, M6 = this.fieldInfoMap ?? /* @__PURE__ */ new Map(), { normalizeField: A5, tooltipField: g10 } = e11, x4 = A5 ? ye(A5) ? i11[h7(A5).fieldName] : i11[A5] : null, _6 = x(a5) && r9 && void 0 !== r9[a5] ? r9[a5] : n11 && void 0 !== i11[n11] ? i11[n11] : void 0 !== i11[a5] ? i11[a5] : o4[a5], C4 = new p2({ fieldName: a5, color: I8, value: void 0 === _6 ? null : _6 && x4 ? _6 / x4 : _6 });
    if (ye(a5)) {
      const t7 = M6.get(a5.toLowerCase()), e12 = g10 && M6.get(g10.toLowerCase()), r10 = (t7 == null ? void 0 : t7.fieldName) ?? a5, s12 = u9 && g10 ? h7(g10).fieldName : (e12 == null ? void 0 : e12.fieldName) ?? g10, l9 = u9 && s12 ? i11[s12] : o4[s12] ?? (t7 == null ? void 0 : t7.label) ?? (t7 == null ? void 0 : t7.fieldName) ?? n11, p13 = u9 && n11 ? i11[n11] : o4[r10];
      return C4.tooltip = this._getTooltip({ label: l9, value: p13, chartType: d10 }), C4;
    }
    const T5 = te(p12, a5), N3 = M(a5, v9), F10 = g10 && void 0 !== o4[g10] ? o4[g10] : U2(T5 || new n4({ fieldName: N3 }), (_a = this.popupTemplate) == null ? void 0 : _a.expressionInfos), j9 = o4[N3];
    return C4.tooltip = this._getTooltip({ label: F10, value: j9, chartType: d10 }), C4;
  }
};
r([m()], v6.prototype, "abilities", void 0), r([s3("abilities")], v6.prototype, "castAbilities", null), r([m()], v6.prototype, "activeMediaInfoIndex", void 0), r([m({ readOnly: true })], v6.prototype, "activeMediaInfo", null), r([m()], v6.prototype, "attributes", void 0), r([m()], v6.prototype, "description", void 0), r([m()], v6.prototype, "fieldInfoMap", void 0), r([m()], v6.prototype, "formattedAttributes", void 0), r([m()], v6.prototype, "expressionAttributes", void 0), r([m({ readOnly: true })], v6.prototype, "formattedMediaInfos", null), r([m()], v6.prototype, "isAggregate", void 0), r([m()], v6.prototype, "layer", void 0), r([m({ readOnly: true })], v6.prototype, "formattedMediaInfoCount", null), r([m()], v6.prototype, "mediaInfos", void 0), r([m()], v6.prototype, "popupTemplate", void 0), r([m()], v6.prototype, "relatedInfos", void 0), r([m()], v6.prototype, "title", void 0), v6 = r([a("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")], v6);
var M3 = v6;

// node_modules/@arcgis/core/widgets/Feature/FeatureMedia.js
var g3 = "esri-feature-media";
var v7 = { base: g3, mediaContainer: `${g3}__container`, mediaItemContainer: `${g3}__item-container`, mediaItem: `${g3}__item`, mediaItemText: `${g3}__item-text`, mediaItemTitle: `${g3}__item-title`, mediaItemCaption: `${g3}__item-caption`, mediaNavigation: `${g3}__item-navigation`, mediaPagination: `${g3}__pagination`, mediaPaginationText: `${g3}__pagination-text`, mediaPrevious: `${g3}__previous`, mediaPreviousIconLTR: `${g3}__previous-icon`, mediaPreviousIconRTL: `${g3}__previous-icon--rtl`, mediaNext: `${g3}__next`, mediaNextIconLTR: `${g3}__next-icon`, mediaNextIconRTL: `${g3}__next-icon--rtl`, mediaChart: `${g3}__chart`, mediaPaginationButton: `${g3}__pagination-button`, mediaPaginationIcon: `${g3}__pagination-icon`, mediaChartRendered: `${g3}__chart--rendered` };
var M4 = 15;
var w7 = "category";
var A4 = "value";
var I6 = "rgba(50, 50, 50, 1)";
var C2 = 250;
var y6 = 500;
var x3 = 200;
var T4 = class extends B {
  constructor(e11, t6) {
    super(e11, t6), this._refreshTimer = null, this._refreshIntervalInfo = null, this._featureElementInfo = null, this._chartRootMap = /* @__PURE__ */ new WeakMap(), this.viewModel = new M3(), this.messages = null, this._disposeChart = (e12) => {
      var _a;
      (_a = this._chartRootMap.get(e12)) == null ? void 0 : _a.dispose(), this._chartRootMap.delete(e12);
    }, this._createChart = async (e12) => {
      const { destroyed: t7, viewModel: i11 } = this;
      if (t7 || !i11 || !e12) return;
      const { createRoot: r9 } = await import("./chartUtilsAm5-EEBGNWVY.js"), a5 = await r9(e12);
      this._chartRootMap.set(e12, a5), this._renderChart({ mediaInfo: i11.activeMediaInfo, root: a5 });
    };
  }
  initialize() {
    this._featureElementInfo = new l4(), this.addHandles([d2(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.activeMediaInfo, (_b = this.viewModel) == null ? void 0 : _b.activeMediaInfoIndex];
    }, () => this._setupMediaRefreshTimer(), P), d2(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.description, (_b = this.viewModel) == null ? void 0 : _b.title];
    }, () => this._setupFeatureElementInfo(), P)]);
  }
  loadDependencies() {
    return r4({ icon: () => import("./calcite-icon-7LCZHQE3.js") });
  }
  destroy() {
    var _a;
    this._clearMediaRefreshTimer(), (_a = this._featureElementInfo) == null ? void 0 : _a.destroy();
  }
  get attributes() {
    return this.viewModel.attributes;
  }
  set attributes(e11) {
    this.viewModel.attributes = e11;
  }
  get activeMediaInfoIndex() {
    return this.viewModel.activeMediaInfoIndex;
  }
  set activeMediaInfoIndex(e11) {
    this.viewModel.activeMediaInfoIndex = e11;
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e11) {
    this.viewModel.description = e11;
  }
  get fieldInfoMap() {
    return this.viewModel.fieldInfoMap;
  }
  set fieldInfoMap(e11) {
    this.viewModel.fieldInfoMap = e11;
  }
  get layer() {
    return this.viewModel.layer;
  }
  set layer(e11) {
    this.viewModel.layer = e11;
  }
  get mediaInfos() {
    return this.viewModel.mediaInfos;
  }
  set mediaInfos(e11) {
    this.viewModel.mediaInfos = e11;
  }
  get popupTemplate() {
    return this.viewModel.popupTemplate;
  }
  set popupTemplate(e11) {
    this.viewModel.popupTemplate = e11;
  }
  get relatedInfos() {
    return this.viewModel.relatedInfos;
  }
  set relatedInfos(e11) {
    this.viewModel.relatedInfos = e11;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e11) {
    this.viewModel.title = e11;
  }
  render() {
    var _a;
    return n2("div", { bind: this, class: v7.base, onkeyup: this._handleMediaKeyup }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), this._renderMedia());
  }
  _renderMedia() {
    const { formattedMediaInfoCount: e11, activeMediaInfoIndex: t6 } = this.viewModel, i11 = this._renderMediaText();
    return e11 ? n2("div", { class: v7.mediaContainer, key: "media-element-container" }, this._renderMediaInfo(), n2("div", { class: v7.mediaNavigation }, i11, e11 > 1 ? n2("div", { class: v7.mediaPagination }, this._renderMediaPageButton("previous"), n2("span", { class: v7.mediaPaginationText }, s2(this.messages.pageText, { index: t6 + 1, total: e11 })), this._renderMediaPageButton("next")) : null)) : null;
  }
  _renderMediaText() {
    const { activeMediaInfo: e11 } = this.viewModel;
    if (!e11) return null;
    const t6 = e11 && e11.title ? n2("div", { class: v7.mediaItemTitle, innerHTML: e11.title, key: "media-title" }) : null, i11 = e11 && e11.caption ? n2("div", { class: v7.mediaItemCaption, innerHTML: e11.caption, key: "media-caption" }) : null;
    return t6 || i11 ? n2("div", { class: v7.mediaItemText, key: "media-text" }, t6, i11) : null;
  }
  _renderImageMediaInfo(e11) {
    if (!e11.value) return null;
    const { _refreshIntervalInfo: t6 } = this, { activeMediaInfoIndex: i11, formattedMediaInfoCount: r9 } = this.viewModel, { value: a5, refreshInterval: o4, altText: s12, title: n11, type: l9 } = e11, { sourceURL: d10, linkURL: c14 } = a5, p12 = v2(c14 ?? void 0) ? "_blank" : "_self", h10 = "_blank" === p12 ? "noreferrer" : "", f8 = o4 ? t6 : null, _6 = f8 ? f8.timestamp : 0, g10 = f8 ? f8.sourceURL : d10, v9 = n2("img", { alt: s12 || n11, key: `media-${l9}-${i11}-${r9}-${_6}`, src: g10 ?? void 0 });
    return (c14 ? n2("a", { href: c14, rel: h10, target: p12, title: n11 }, v9) : null) ?? v9;
  }
  _renderChartMediaInfo(e11) {
    const { activeMediaInfoIndex: t6, formattedMediaInfoCount: i11 } = this.viewModel;
    return n2("div", { afterCreate: this._createChart, afterRemoved: this._disposeChart, bind: this, class: v7.mediaChart, key: `media-${e11.type}-${t6}-${i11}` });
  }
  _renderMediaInfoType() {
    const { activeMediaInfo: e11 } = this.viewModel;
    return e11 ? "image" === e11.type ? this._renderImageMediaInfo(e11) : e11.type.includes("chart") ? this._renderChartMediaInfo(e11) : null : null;
  }
  _renderMediaInfo() {
    const { activeMediaInfo: e11 } = this.viewModel;
    return e11 ? n2("div", { class: v7.mediaItemContainer, key: "media-container" }, n2("div", { class: v7.mediaItem, key: "media-item-container" }, this._renderMediaInfoType())) : null;
  }
  _renderMediaPageButton(e11) {
    if (this.viewModel.formattedMediaInfoCount < 2) return null;
    const t6 = "previous" === e11, i11 = t6 ? this.messages.previous : this.messages.next, r9 = t6 ? "chevron-left" : "chevron-right", a5 = t6 ? "media-previous" : "media-next", o4 = t6 ? this._previous : this._next;
    return n2("button", { "aria-label": i11, bind: this, class: v7.mediaPaginationButton, key: a5, onclick: o4, tabIndex: 0, title: i11, type: "button" }, n2("calcite-icon", { class: v7.mediaPaginationIcon, icon: r9, scale: "s" }));
  }
  _setupFeatureElementInfo() {
    var _a;
    const { description: e11, title: t6 } = this;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: e11, title: t6 });
  }
  _next() {
    this.viewModel.next();
  }
  _previous() {
    this.viewModel.previous();
  }
  _getRenderer() {
    if (!this.viewModel) return;
    const { isAggregate: e11, layer: t6 } = this.viewModel;
    return e11 && (t6 == null ? void 0 : t6.featureReduction) && "renderer" in t6.featureReduction ? t6.featureReduction.renderer : t6 == null ? void 0 : t6.renderer;
  }
  async _getSeriesColors(e11) {
    const { colorAm5: t6 } = await import("./chartCommon-A3MQNZ7V.js"), i11 = /* @__PURE__ */ new Map();
    return e11.forEach((e12) => {
      e12.color && i11.set(e12, t6(e12.color.toCss(true)));
    }), i11;
  }
  async _getRendererColors() {
    const { colorAm5: e11 } = await import("./chartCommon-A3MQNZ7V.js"), t6 = /* @__PURE__ */ new Map(), i11 = this._getRenderer(), r9 = "default";
    if (!i11) return t6;
    const a5 = await x2(i11);
    a5.delete(r9);
    return Array.from(a5.values()).every((e12) => 1 === (e12 == null ? void 0 : e12.length)) ? (Array.from(a5.keys()).forEach((i12) => {
      var _a, _b;
      const r10 = (_b = (_a = a5.get(i12)) == null ? void 0 : _a[0]) == null ? void 0 : _b.toCss(true);
      r10 && t6.set(i12, e11(r10));
    }), t6) : t6;
  }
  _handleMediaKeyup(e11) {
    const { key: t6 } = e11;
    "ArrowLeft" === t6 && (e11.stopPropagation(), this.viewModel.previous()), "ArrowRight" === t6 && (e11.stopPropagation(), this.viewModel.next());
  }
  _canAnimateChart() {
    return !!this.viewModel && (!!this.viewModel.abilities.chartAnimation && !o2());
  }
  _getChartAnimationMS() {
    return this._canAnimateChart() ? C2 : 0;
  }
  _getChartSeriesAnimationMS() {
    return this._canAnimateChart() ? y6 : 0;
  }
  async _renderChart(e11) {
    const { root: t6, mediaInfo: i11 } = e11, { value: r9, type: a5 } = i11, { ResponsiveThemeAm5: o4, DarkThemeAm5: s12, AnimatedThemeAm5: n11, ColorSetAm5: l9, ThemeAm5: d10, esriChartColorSet: m9 } = await import("./chartCommon-A3MQNZ7V.js"), c14 = d10.new(t6);
    c14.rule("ColorSet").set("colors", m9), c14.rule("ColorSet").set("reuse", true);
    const p12 = [o4.new(t6), c14];
    r5() && p12.push(s12.new(t6)), this._canAnimateChart() && p12.push(n11.new(t6)), t6.setThemes(p12);
    const h10 = await this._getRendererColors(), u9 = await this._getSeriesColors(r9.series), _6 = l9.new(t6, {}), g10 = u9.get(r9.series[0]), v9 = g10 ? { lineSettings: { stroke: g10 } } : void 0, M6 = r9.series.map((e12, t7) => {
      const i12 = u9.get(e12) || h10.get(e12.fieldName) || _6.getIndex(t7);
      return { [w7]: e12.tooltip, [A4]: e12.value, columnSettings: { fill: i12, stroke: i12 }, ...v9 };
    }).filter((e12) => "pie-chart" !== a5 || null != e12.value && e12.value > 0);
    "pie-chart" === a5 ? this._createPieChart(e11, M6) : this._createXYChart(e11, M6);
  }
  _getDirection() {
    return u2(this.container) ? "rtl" : "ltr";
  }
  async _customizeChartTooltip(e11, t6 = "horizontal") {
    var _a;
    const { colorAm5: i11 } = await import("./chartCommon-A3MQNZ7V.js");
    e11.setAll({ pointerOrientation: t6 }), (_a = e11.get("background")) == null ? void 0 : _a.setAll({ stroke: i11(I6) }), e11.label.setAll({ direction: this._getDirection(), oversizedBehavior: "wrap", maxWidth: x3 });
  }
  async _createPieChart(e11, t6) {
    const { TooltipAm5: i11 } = await import("./chartCommon-A3MQNZ7V.js"), { PieChartAm5: r9, PieSeriesAm5: a5 } = await import("./pieChart-ITMTOGE3.js"), { mediaInfo: o4, root: s12 } = e11, { title: n11 } = o4, l9 = 5, d10 = (o4 == null ? void 0 : o4.altText) || (o4 == null ? void 0 : o4.title) || "", m9 = s12.container.children.push(r9.new(s12, { ariaLabel: d10, focusable: true, paddingBottom: l9, paddingTop: l9, paddingLeft: l9, paddingRight: l9 })), c14 = "{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})", p12 = i11.new(s12, { labelText: c14 }), h10 = m9.series.push(a5.new(s12, { name: n11, valueField: A4, categoryField: w7, tooltip: p12 }));
    h10.ticks.template.set("forceHidden", true), h10.labels.template.set("forceHidden", true), h10.slices.template.states.create("active", { shiftRadius: l9 }), this._customizeChartTooltip(p12), h10.slices.template.setAll({ ariaLabel: c14, focusable: true, templateField: "columnSettings" }), h10.data.setAll(t6), h10.appear(this._getChartSeriesAnimationMS()), m9.appear(this._getChartAnimationMS()), m9.root.dom.classList.toggle(v7.mediaChartRendered, true);
  }
  _getMinSeriesValue(e11) {
    let t6 = 0;
    return e11.forEach((e12) => t6 = Math.min(e12.value, t6)), t6;
  }
  async _createColumnChart(e11, t6, i11) {
    const { TooltipAm5: r9, ScrollbarAm5: a5 } = await import("./chartCommon-A3MQNZ7V.js"), { CategoryAxisAm5: o4, AxisRendererXAm5: s12, ValueAxisAm5: n11, AxisRendererYAm5: l9, ColumnSeriesAm5: d10 } = await import("./xyChart-EO6T4VON.js"), { mediaInfo: m9, root: c14 } = t6, { value: h10, title: u9 } = m9;
    e11.setAll({ wheelX: "panX", wheelY: "zoomX" });
    const f8 = e11.xAxes.push(o4.new(c14, { renderer: s12.new(c14, { inversed: u2(this.container) }), categoryField: w7 }));
    f8.get("renderer").labels.template.setAll({ forceHidden: true });
    const _6 = e11.yAxes.push(n11.new(c14, { renderer: l9.new(c14, { inside: false }), min: this._getMinSeriesValue(h10.series) }));
    _6.get("renderer").labels.template.setAll({ direction: this._getDirection() });
    const g10 = "{categoryX}", v9 = r9.new(c14, { labelText: g10 }), I8 = e11.series.push(d10.new(c14, { name: u9, xAxis: f8, yAxis: _6, valueYField: A4, categoryXField: w7, tooltip: v9 }));
    this._customizeChartTooltip(v9), I8.columns.template.setAll({ ariaLabel: g10, focusable: true, templateField: "columnSettings" }), h10.series.length > M4 && e11.set("scrollbarX", a5.new(c14, { orientation: "horizontal" })), f8.data.setAll(i11), I8.data.setAll(i11), I8.appear(this._getChartSeriesAnimationMS()), e11.appear(this._getChartAnimationMS());
  }
  async _createBarChart(e11, t6, i11) {
    const { TooltipAm5: r9, ScrollbarAm5: a5 } = await import("./chartCommon-A3MQNZ7V.js"), { CategoryAxisAm5: o4, AxisRendererXAm5: s12, ValueAxisAm5: n11, AxisRendererYAm5: l9, ColumnSeriesAm5: d10 } = await import("./xyChart-EO6T4VON.js"), { mediaInfo: m9, root: c14 } = t6, { value: h10, title: u9 } = m9;
    e11.setAll({ wheelX: "panY", wheelY: "zoomY" });
    const f8 = e11.yAxes.push(o4.new(c14, { renderer: l9.new(c14, { inversed: true }), categoryField: w7 }));
    f8.get("renderer").labels.template.setAll({ forceHidden: true });
    const _6 = e11.xAxes.push(n11.new(c14, { renderer: s12.new(c14, { inside: false, inversed: u2(this.container) }), min: this._getMinSeriesValue(h10.series) }));
    _6.get("renderer").labels.template.setAll({ direction: this._getDirection() });
    const g10 = "{categoryY}", v9 = r9.new(c14, { labelText: g10 }), I8 = e11.series.push(d10.new(c14, { name: u9, xAxis: _6, yAxis: f8, valueXField: A4, categoryYField: w7, tooltip: v9 }));
    this._customizeChartTooltip(v9, "vertical"), I8.columns.template.setAll({ ariaLabel: g10, focusable: true, templateField: "columnSettings" }), h10.series.length > M4 && e11.set("scrollbarY", a5.new(c14, { orientation: "vertical" })), f8.data.setAll(i11), I8.data.setAll(i11), I8.appear(this._getChartSeriesAnimationMS()), e11.appear(this._getChartAnimationMS());
  }
  async _createLineChart(e11, t6, i11) {
    var _a, _b, _c;
    const { TooltipAm5: r9, ScrollbarAm5: a5 } = await import("./chartCommon-A3MQNZ7V.js"), { CategoryAxisAm5: o4, AxisRendererXAm5: s12, ValueAxisAm5: n11, AxisRendererYAm5: l9, LineSeriesAm5: d10 } = await import("./xyChart-EO6T4VON.js"), { root: m9, mediaInfo: c14 } = t6, { value: h10, title: u9 } = c14;
    e11.setAll({ wheelX: "panX", wheelY: "zoomX" });
    const f8 = e11.xAxes.push(o4.new(m9, { renderer: s12.new(m9, { inversed: u2(this.container) }), categoryField: w7 }));
    f8.get("renderer").labels.template.setAll({ forceHidden: true });
    const _6 = e11.yAxes.push(n11.new(m9, { renderer: l9.new(m9, { inside: false }), min: this._getMinSeriesValue(h10.series) }));
    _6.get("renderer").labels.template.setAll({ direction: this._getDirection() });
    const g10 = "{categoryX}", v9 = (_b = (_a = i11[0]) == null ? void 0 : _a.lineSettings) == null ? void 0 : _b.stroke, I8 = r9.new(m9, { getFillFromSprite: !v9, labelText: g10 });
    v9 && ((_c = I8.get("background")) == null ? void 0 : _c.setAll({ fill: v9 }));
    const C4 = e11.series.push(d10.new(m9, { name: u9, xAxis: f8, yAxis: _6, valueYField: A4, categoryXField: w7, tooltip: I8 }));
    C4.strokes.template.setAll({ templateField: "lineSettings" }), this._customizeChartTooltip(I8, "vertical"), h10.series.length > M4 && e11.set("scrollbarX", a5.new(m9, { orientation: "horizontal" })), f8.data.setAll(i11), C4.data.setAll(i11), C4.appear(this._getChartSeriesAnimationMS()), e11.appear(this._getChartAnimationMS());
  }
  async _createXYChart(e11, t6) {
    const { XYChartAm5: i11, XYCursorAm5: r9 } = await import("./xyChart-EO6T4VON.js"), { root: a5, mediaInfo: o4 } = e11, { type: s12 } = o4, n11 = (o4 == null ? void 0 : o4.altText) || (o4 == null ? void 0 : o4.title) || "", l9 = a5.container.children.push(i11.new(a5, { ariaLabel: n11, focusable: true, panX: true, panY: true }));
    l9.set("cursor", r9.new(a5, {})), "column-chart" === s12 && await this._createColumnChart(l9, e11, t6), "bar-chart" === s12 && await this._createBarChart(l9, e11, t6), "line-chart" === s12 && await this._createLineChart(l9, e11, t6), l9.root.dom.classList.toggle(v7.mediaChartRendered, true);
  }
  _clearMediaRefreshTimer() {
    const { _refreshTimer: e11 } = this;
    e11 && (clearTimeout(e11), this._refreshTimer = null);
  }
  _updateMediaInfoTimestamp(e11) {
    const t6 = Date.now();
    this._refreshIntervalInfo = { timestamp: t6, sourceURL: e11 && this._getImageSource(e11, t6) };
  }
  _setupMediaRefreshTimer() {
    this._clearMediaRefreshTimer();
    const { activeMediaInfo: e11 } = this.viewModel;
    "image" === (e11 == null ? void 0 : e11.type) && (e11 == null ? void 0 : e11.refreshInterval) > 0 && this._setRefreshTimeout(e11);
  }
  _setRefreshTimeout(e11) {
    const { refreshInterval: t6, value: i11 } = e11, r9 = 6e4 * t6;
    this._updateMediaInfoTimestamp(i11.sourceURL);
    const a5 = setInterval(() => {
      this._updateMediaInfoTimestamp(i11.sourceURL);
    }, r9);
    this._refreshTimer = a5;
  }
  _getImageSource(e11, t6) {
    const i11 = e11.includes("?") ? "&" : "?", [r9, a5 = ""] = e11.split("#");
    return `${r9}${i11}timestamp=${t6}${a5 ? "#" : ""}${a5}`;
  }
};
r([m()], T4.prototype, "_refreshIntervalInfo", void 0), r([m()], T4.prototype, "attributes", null), r([m()], T4.prototype, "activeMediaInfoIndex", null), r([m()], T4.prototype, "description", null), r([m()], T4.prototype, "fieldInfoMap", null), r([m()], T4.prototype, "layer", null), r([m()], T4.prototype, "mediaInfos", null), r([m()], T4.prototype, "popupTemplate", null), r([m()], T4.prototype, "relatedInfos", null), r([m()], T4.prototype, "title", null), r([m({ type: M3 })], T4.prototype, "viewModel", void 0), r([m(), e("esri/widgets/Feature/t9n/Feature")], T4.prototype, "messages", void 0), T4 = r([a("esri.widgets.Feature.FeatureMedia")], T4);
var b6 = T4;

// node_modules/@arcgis/core/core/throttle.js
function e8(e11, t6, l9, n11) {
  let o4 = null, p12 = 1e3;
  "number" == typeof t6 ? (p12 = t6, n11 = l9) : (o4 = t6 ?? null, p12 = l9);
  let r9, u9 = 0;
  const a5 = () => {
    u9 = 0, e11.apply(n11, r9);
  }, c14 = (...e12) => {
    o4 && o4.apply(n11, e12), r9 = e12, p12 ? u9 || (u9 = setTimeout(a5, p12)) : a5();
  };
  return c14.remove = () => {
    u9 && (clearTimeout(u9), u9 = 0);
  }, c14.forceUpdate = () => {
    u9 && (clearTimeout(u9), a5());
  }, c14.hasPendingUpdates = () => !!u9, c14;
}

// node_modules/@arcgis/core/widgets/Feature/support/arcadeFeatureUtils.js
var s10 = "esri.widgets.Feature.support.arcadeFeatureUtils";
var p11 = () => n.getLogger(s10);
function c13(e11) {
  return "string" == typeof e11 ? ue(le(e11)) : Array.isArray(e11) ? u7(e11) : "esri.arcade.Dictionary" === (e11 == null ? void 0 : e11.declaredClass) ? l7(e11) : e11;
}
function u7(e11) {
  return `<ul class="esri-widget__list">${e11.map((e12) => `<li>${"string" == typeof e12 ? ue(le(e12)) : e12}</li>`).join("")}</ul>`;
}
function l7(e11) {
  const r9 = e11.keys().map((r10) => {
    const t6 = e11.field(r10);
    return `<tr><th>${r10}</th><td>${"string" == typeof t6 ? ue(le(t6)) : t6}</td></tr>`;
  }).join("");
  return `<table class="${e2.table}">${r9}</table>`;
}
function d9() {
  return import("./arcade-XEFROZXY.js");
}
function f3(e11) {
  return "createQuery" in e11 && "queryFeatures" in e11;
}
async function g4({ graphic: e11, view: r9, options: t6 }) {
  const { isAggregate: a5, layer: o4 } = e11;
  if (!a5 || !o4 || "2d" !== (r9 == null ? void 0 : r9.type)) return [];
  const i11 = await r9.whenLayerView(o4);
  if (!f3(i11)) return [];
  const n11 = i11.createQuery(), s12 = e11.getObjectId();
  n11.aggregateIds = null != s12 ? [s12] : [];
  const { features: p12 } = await i11.queryFeatures(n11, t6);
  return p12;
}
function y7({ layer: e11, aggregatedFeatures: r9, interceptor: t6 }) {
  const { fields: o4, objectIdField: i11, geometryType: n11, spatialReference: s12, displayField: p12 } = e11;
  return new Xe({ fields: o4, objectIdField: i11, geometryType: n11, spatialReference: s12, displayField: p12, interceptor: t6, ..."feature" === e11.type ? { templates: e11.templates, typeIdField: e11.typeIdField, types: e11.types } : null, source: r9 });
}
async function m7({ expressionInfo: r9, arcade: t6, interceptor: a5, spatialReference: o4, map: i11, graphic: n11, location: s12, view: c14, options: u9 }) {
  var _a;
  if (!(r9 == null ? void 0 : r9.expression)) return null;
  const { isAggregate: l9 } = n11, d10 = (n11.sourceLayer || n11.layer) ?? void 0, f8 = l9 ? "feature-reduction-popup" : "popup", m9 = t6.createArcadeProfile(f8), w11 = t6.createArcadeExecutor(r9.expression, m9).catch((e11) => p11().error("arcade-executor-error", { error: e11, expressionInfo: r9 })), [h10, F10] = await Promise.all([g4({ graphic: n11, view: c14, options: u9 }), w11]);
  if (!F10) return null;
  const $5 = "feature-reduction-popup" === f8 ? y7({ layer: d10, aggregatedFeatures: h10, interceptor: a5 }) : void 0, v9 = { ..."feature-reduction-popup" === f8 ? { $aggregatedFeatures: $5 } : { $datastore: d10 == null ? void 0 : d10.url, $layer: null != d10 && j3(d10) ? d10 : "scene" === (d10 == null ? void 0 : d10.type) && null != d10.associatedLayer ? d10.associatedLayer : void 0, $map: i11, $userInput: s12, $graph: "knowledge-graph-sublayer" === (d10 == null ? void 0 : d10.type) ? (_a = d10 == null ? void 0 : d10.parentCompositeLayer) == null ? void 0 : _a.knowledgeGraph : void 0 }, $feature: n11 }, x4 = { abortSignal: (u9 == null ? void 0 : u9.signal) ?? void 0, interceptor: a5 ?? void 0, rawOutput: true, spatialReference: o4 ?? void 0, timeZone: c14 == null ? void 0 : c14.timeZone };
  return await F10.executeAsync(v9, x4).catch((e11) => p11().error("arcade-execution-error", { error: e11, graphic: n11, expressionInfo: r9 })).finally(() => $5 == null ? void 0 : $5.destroy());
}
async function w8({ expressionInfos: e11, spatialReference: r9, graphic: a5, interceptor: o4, map: i11, view: n11, location: s12, options: p12 }) {
  if (!(e11 == null ? void 0 : e11.length)) return {};
  const u9 = await d9(), l9 = {};
  for (const t6 of e11) l9[`expression/${t6.name}`] = m7({ expressionInfo: t6, arcade: u9, interceptor: o4, spatialReference: r9, map: i11, graphic: a5, location: s12, view: n11, options: p12 });
  const f8 = await y(l9), g10 = {};
  for (const t6 in f8) g10[t6] = c13(f8[t6].value);
  return g10;
}

// node_modules/@arcgis/core/widgets/Feature/FeatureExpression/FeatureExpressionViewModel.js
var w9 = 1;
var j7 = class extends b2 {
  constructor(t6) {
    super(t6), this._abortController = null, this.expressionInfo = null, this.graphic = null, this.contentElement = null, this.contentElementViewModel = null, this.interceptor = null, this.location = null, this.view = null, this._cancelQuery = () => {
      const { _abortController: t7 } = this;
      t7 && t7.abort(), this._abortController = null;
    }, this._createVM = () => {
      var _a, _b;
      const t7 = (_a = this.contentElement) == null ? void 0 : _a.type;
      (_b = this.contentElementViewModel) == null ? void 0 : _b.destroy();
      const e11 = "fields" === t7 ? new n8() : "media" === t7 ? new M3() : "text" === t7 ? new p7() : null;
      this._set("contentElementViewModel", e11);
    }, this._compile = async () => {
      this._cancelQuery();
      const t7 = new AbortController();
      this._abortController = t7, await this._compileExpression(), this._abortController === t7 && (this._abortController = null);
    }, this._compileThrottled = e8(this._compile, w9, this), this._compileExpression = async () => {
      const { expressionInfo: t7, graphic: e11, interceptor: o4, spatialReference: n11, map: r9, location: i11, view: s12, _abortController: l9 } = this;
      if (!t7 || !e11) return void this._set("contentElement", null);
      const m9 = await d9();
      if (l9 !== this._abortController) return;
      const d10 = await m7({ arcade: m9, expressionInfo: t7, graphic: e11, location: i11, interceptor: o4, map: r9, spatialReference: n11, view: s12 });
      if (!d10 || "esri.arcade.Dictionary" !== d10.declaredClass) return void this._set("contentElement", null);
      const h10 = await d10.castAsJsonAsync(l9 == null ? void 0 : l9.signal), u9 = h10 == null ? void 0 : h10.type, _6 = "media" === u9 ? I.fromJSON(h10) : "text" === u9 ? c2.fromJSON(h10) : "fields" === u9 ? c.fromJSON(h10) : null;
      "media" === _6.type && !_6.mediaInfos || "fields" === _6.type && !_6.fieldInfos || "text" === _6.type && !_6.text ? this._set("contentElement", null) : this._set("contentElement", _6);
    }, this.addHandles([d2(() => [this.expressionInfo, this.graphic, this.map, this.spatialReference, this.view], () => this._compileThrottled(), P), d2(() => [this.contentElement], () => this._createVM(), P)]);
  }
  initialize() {
    this.addHandles(this._compileThrottled);
  }
  destroy() {
    var _a;
    this._cancelQuery(), (_a = this.contentElementViewModel) == null ? void 0 : _a.destroy(), this._set("contentElementViewModel", null), this._set("contentElement", null);
  }
  get spatialReference() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.spatialReference) ?? null;
  }
  set spatialReference(t6) {
    this._override("spatialReference", t6);
  }
  get state() {
    const { _abortController: t6, contentElement: e11, contentElementViewModel: o4 } = this;
    return t6 ? "loading" : e11 || o4 ? "ready" : "disabled";
  }
  get map() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.map) ?? null;
  }
  set map(t6) {
    this._override("map", t6);
  }
};
r([m()], j7.prototype, "_abortController", void 0), r([m({ type: i6 })], j7.prototype, "expressionInfo", void 0), r([m({ type: d3 })], j7.prototype, "graphic", void 0), r([m({ readOnly: true })], j7.prototype, "contentElement", void 0), r([m({ readOnly: true })], j7.prototype, "contentElementViewModel", void 0), r([m()], j7.prototype, "interceptor", void 0), r([m({ type: j2 })], j7.prototype, "location", void 0), r([m()], j7.prototype, "spatialReference", null), r([m({ readOnly: true })], j7.prototype, "state", null), r([m()], j7.prototype, "map", null), r([m()], j7.prototype, "view", void 0), j7 = r([a("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")], j7);
var C3 = j7;

// node_modules/@arcgis/core/widgets/Feature/FeatureExpression.js
var m8 = "esri-feature";
var u8 = { base: `${m8}-expression`, loadingSpinnerContainer: `${m8}__loading-container` };
var g5 = class extends B {
  constructor(e11, t6) {
    super(e11, t6), this._contentWidget = null, this.viewModel = new C3();
  }
  initialize() {
    this.addHandles(d2(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.contentElementViewModel;
    }, () => this._setupExpressionWidget(), P));
  }
  loadDependencies() {
    return r4({ loader: () => import("./calcite-loader-GZNTWKUG.js") });
  }
  destroy() {
    this._destroyContentWidget();
  }
  render() {
    var _a;
    const { state: e11 } = this.viewModel;
    return n2("div", { class: u8.base }, "loading" === e11 ? this._renderLoading() : "disabled" === e11 ? null : (_a = this._contentWidget) == null ? void 0 : _a.render());
  }
  _renderLoading() {
    return n2("div", { class: u8.loadingSpinnerContainer, key: "loading-container" }, n2("calcite-loader", { inline: true, label: "" }));
  }
  _destroyContentWidget() {
    const { _contentWidget: e11 } = this;
    e11 && (e11.viewModel = null, e11.destroy()), this._contentWidget = null;
  }
  _setupExpressionWidget() {
    const { contentElementViewModel: e11, contentElement: t6 } = this.viewModel, o4 = t6 == null ? void 0 : t6.type;
    this._destroyContentWidget();
    const s12 = e11 ? "fields" === o4 ? new h6({ viewModel: e11 }) : "media" === o4 ? new b6({ viewModel: e11 }) : "text" === o4 ? new p9({ viewModel: e11 }) : null : null;
    this._contentWidget = s12, this.scheduleRender();
  }
};
r([m({ type: C3 })], g5.prototype, "viewModel", void 0), g5 = r([a("esri.widgets.Feature.FeatureExpression")], g5);
var h8 = g5;

// node_modules/@arcgis/core/widgets/FeatureForm/featureFormUtils.js
var S3;
!function(e11) {
  e11.TOO_SHORT = "length-validation-error::too-short", e11.TOO_LONG = "length-validation-error::too-long";
}(S3 || (S3 = {}));
var P4 = (e11) => {
  var _a;
  const t6 = [];
  if (e11.formTemplate) {
    const { description: n11, title: r9 } = e11.formTemplate;
    (_a = e11.fields) == null ? void 0 : _a.forEach((e12) => {
      const i11 = r9 && i2(r9, e12.name), l9 = n11 && i2(n11, e12.name);
      (i11 || l9) && t6.push(e12.name);
    });
  }
  return t6;
};

// node_modules/@arcgis/core/widgets/Feature/FeatureRelationship/FeatureRelationshipViewModel.js
var g6 = 100;
var _2 = class extends i5(s4(b2)) {
  constructor(e11) {
    super(e11), this._loaded = false, this._queryAbortController = null, this._queryPageAbortController = null, this._queryFeatureCountAbortController = null, this.featuresPerPage = 10, this.description = null, this.graphic = null, this.layer = null, this.map = null, this.orderByFields = null, this.featureCount = 0, this.relationshipId = null, this.showAllEnabled = false, this.title = null, this._cancelQuery = () => {
      const { _queryAbortController: e12 } = this;
      e12 && e12.abort(), this._queryAbortController = null;
    }, this._cancelQueryFeatureCount = () => {
      const { _queryFeatureCountAbortController: e12 } = this;
      e12 && e12.abort(), this._queryFeatureCountAbortController = null;
    }, this._cancelQueryPage = () => {
      const { _queryPageAbortController: e12 } = this;
      e12 && e12.abort(), this._queryPageAbortController = null;
    }, this._queryController = async () => {
      this._cancelQuery();
      const e12 = new AbortController();
      this._queryAbortController = e12, await d(this._query()), this._queryAbortController === e12 && (this._queryAbortController = null);
    }, this._queryFeatureCountController = async () => {
      this._loaded = false, this._cancelQueryFeatureCount();
      const e12 = new AbortController();
      this._queryFeatureCountAbortController = e12, await d(this._queryFeatureCount()), this._queryFeatureCountAbortController === e12 && (this._queryFeatureCountAbortController = null), this._loaded = true;
    }, this._queryPageController = async () => {
      const e12 = new AbortController();
      this._queryPageAbortController = e12, await d(this._queryPage()), this._queryPageAbortController === e12 && (this._queryPageAbortController = null);
    }, this._queryDebounced = k(this._queryController, g6), this._queryFeatureCountDebounced = k(this._queryFeatureCountController, g6), this._queryPageDebounced = k(this._queryPageController, g6), this._query = async () => {
      const { _queryAbortController: e12, relatedFeatures: t6 } = this;
      this.featureCount && (this._destroyRelatedFeatureViewModels(), this.featurePage = 1, t6.destroyAll(), this.destroyed || t6.addMany(this._sliceFeatures(await this._queryRelatedFeatures({ signal: e12 == null ? void 0 : e12.signal }))));
    }, this.addHandles([d2(() => {
      var _a;
      return [this.displayCount, this.graphic, this.layer, (_a = this.layer) == null ? void 0 : _a.loaded, this.map, this.orderByFields, this.relationshipId, this.featuresPerPage, this.showAllEnabled, this.canQuery, this.featureCount];
    }, () => this._queryDebounced(), P), d2(() => [this.featurePage, this.showAllEnabled], () => this._queryPageDebounced()), d2(() => [this.layer, this.relationshipId, this.objectId, this.canQuery], () => this._queryFeatureCountDebounced())]);
  }
  destroy() {
    this._destroyRelatedFeatureViewModels(), this.relatedFeatures.destroyAll(), this._cancelQuery(), this._cancelQueryFeatureCount(), this._cancelQueryPage();
  }
  set featurePage(e11) {
    const { featuresPerPage: t6, featureCount: r9 } = this, o4 = 1, l9 = Math.ceil(r9 / t6) || 1;
    this._set("featurePage", Math.min(Math.max(e11, o4), l9));
  }
  get featurePage() {
    return this._get("featurePage");
  }
  get orderByFieldsFixedCasing() {
    const { orderByFields: e11, relatedLayer: t6 } = this;
    return e11 && (t6 == null ? void 0 : t6.loaded) ? e11.map((e12) => {
      const r9 = e12.clone();
      return r9.field = M(e12.field, t6), r9;
    }) : e11 ?? [];
  }
  get supportsCacheHint() {
    var _a, _b, _c;
    return !!((_c = (_b = (_a = this.layer) == null ? void 0 : _a.capabilities) == null ? void 0 : _b.queryRelated) == null ? void 0 : _c.supportsCacheHint);
  }
  get canLoad() {
    return !!this.map && null != this.relationshipId && "number" == typeof this.objectId;
  }
  get canQuery() {
    var _a, _b;
    const e11 = (_b = (_a = this.layer) == null ? void 0 : _a.capabilities) == null ? void 0 : _b.queryRelated;
    return !!(this.relatedLayer && this.relationship && null != this.relationshipId && null != this.objectId && (e11 == null ? void 0 : e11.supportsCount) && (e11 == null ? void 0 : e11.supportsPagination));
  }
  get itemDescriptionFieldName() {
    var _a;
    return ((_a = this.orderByFieldsFixedCasing[0]) == null ? void 0 : _a.field) || null;
  }
  set displayCount(e11) {
    const t6 = 0, r9 = 10;
    this._set("displayCount", Math.min(Math.max(e11, t6), r9));
  }
  get displayCount() {
    return this._get("displayCount");
  }
  get objectId() {
    var _a, _b;
    return (this.objectIdField && ((_b = (_a = this.graphic) == null ? void 0 : _a.attributes) == null ? void 0 : _b[this.objectIdField])) ?? null;
  }
  get objectIdField() {
    var _a;
    return ((_a = this.layer) == null ? void 0 : _a.objectIdField) || null;
  }
  get relatedFeatures() {
    return this._get("relatedFeatures") || new V();
  }
  get relatedLayer() {
    const { layer: e11, map: t6, relationship: r9 } = this;
    return (e11 == null ? void 0 : e11.loaded) && t6 && r9 ? Fe(t6, e11, r9) ?? null : null;
  }
  get relationship() {
    var _a;
    const { relationshipId: e11, layer: t6 } = this;
    return null != e11 ? ((_a = t6 == null ? void 0 : t6.relationships) == null ? void 0 : _a.find(({ id: t7 }) => t7 === e11)) ?? null : null;
  }
  get relatedFeatureViewModels() {
    return this._get("relatedFeatureViewModels") || new V();
  }
  get state() {
    const { _queryAbortController: e11, _queryFeatureCountAbortController: t6, _queryPageAbortController: r9, canQuery: o4, _loaded: l9, canLoad: s12 } = this;
    return t6 || s12 && !l9 ? "loading" : e11 || r9 ? "querying" : o4 ? "ready" : "disabled";
  }
  getRelatedFeatureByObjectId(e11) {
    return this.relatedFeatures.find((t6) => t6.getObjectId() === e11);
  }
  refresh() {
    this._queryFeatureCountDebounced();
  }
  _destroyRelatedFeatureViewModels() {
    var _a;
    (_a = this.relatedFeatureViewModels) == null ? void 0 : _a.destroyAll();
  }
  async _queryFeatureCount() {
    const { layer: e11, relatedLayer: t6, relationshipId: r9, objectId: o4, _queryFeatureCountAbortController: l9, canQuery: s12, supportsCacheHint: a5 } = this;
    if (await (e11 == null ? void 0 : e11.load()), await (t6 == null ? void 0 : t6.load()), !s12 || !e11 || !t6 || null == o4) return void this._set("featureCount", 0);
    const i11 = t6.createQuery(), { historicMoment: n11, gdbVersion: u9 } = e11, d10 = new d4({ cacheHint: a5, gdbVersion: u9, historicMoment: n11, relationshipId: r9, returnGeometry: false, objectIds: [o4], where: i11.where ?? void 0 }), h10 = await e11.queryRelatedFeaturesCount(d10, { signal: l9 == null ? void 0 : l9.signal });
    this._set("featureCount", h10[o4] || 0);
  }
  _sliceFeatures(e11) {
    const { showAllEnabled: t6, displayCount: r9 } = this;
    return t6 ? e11 : r9 ? e11.slice(0, r9) : [];
  }
  async _queryPage() {
    const { relatedFeatures: e11, featurePage: t6, showAllEnabled: r9, _queryPageAbortController: o4, featureCount: l9 } = this;
    !r9 || t6 < 2 || !l9 || e11.addMany(await this._queryRelatedFeatures({ signal: o4 == null ? void 0 : o4.signal }));
  }
  async _queryRelatedFeatures(e11) {
    var _a;
    const { orderByFieldsFixedCasing: t6, showAllEnabled: r9, featuresPerPage: l9, displayCount: s12, layer: a5, relationshipId: i11, featurePage: n11, featureCount: u9, relatedLayer: d10, supportsCacheHint: h10 } = this, { canQuery: y10, objectId: c14 } = this;
    if (!y10 || !a5 || !d10 || null == c14) return [];
    const C4 = r9 ? ((n11 - 1) * l9 + u9) % u9 : 0, g10 = r9 ? l9 : s12, _6 = d10.objectIdField, F10 = [...t6.map((e12) => e12.field), ...P4(d10), _6].filter(F), m9 = t6.map((e12) => `${e12.field} ${e12.order}`), f8 = d10.createQuery(), { historicMoment: q3, gdbVersion: A5 } = a5, P5 = new d4({ orderByFields: m9, start: C4, num: g10, outFields: F10, cacheHint: h10, historicMoment: q3, gdbVersion: A5, relationshipId: i11, returnGeometry: false, objectIds: [c14], where: f8.where ?? void 0 }), w11 = await a5.queryRelatedFeatures(P5, { signal: e11 == null ? void 0 : e11.signal }), j9 = ((_a = w11[c14]) == null ? void 0 : _a.features) || [];
    return j9.forEach((e12) => {
      e12.sourceLayer = d10, e12.layer = d10;
    }), j9;
  }
};
r([m()], _2.prototype, "_loaded", void 0), r([m()], _2.prototype, "_queryAbortController", void 0), r([m()], _2.prototype, "_queryPageAbortController", void 0), r([m()], _2.prototype, "_queryFeatureCountAbortController", void 0), r([m({ value: 1 })], _2.prototype, "featurePage", null), r([m()], _2.prototype, "featuresPerPage", void 0), r([m({ readOnly: true })], _2.prototype, "orderByFieldsFixedCasing", null), r([m({ readOnly: true })], _2.prototype, "supportsCacheHint", null), r([m({ readOnly: true })], _2.prototype, "canLoad", null), r([m({ readOnly: true })], _2.prototype, "canQuery", null), r([m()], _2.prototype, "description", void 0), r([m({ readOnly: true })], _2.prototype, "itemDescriptionFieldName", null), r([m({ value: 3 })], _2.prototype, "displayCount", null), r([m({ type: d3 })], _2.prototype, "graphic", void 0), r([m()], _2.prototype, "layer", void 0), r([m()], _2.prototype, "map", void 0), r([m({ readOnly: true })], _2.prototype, "objectId", null), r([m({ readOnly: true })], _2.prototype, "objectIdField", null), r([m()], _2.prototype, "orderByFields", void 0), r([m({ readOnly: true })], _2.prototype, "relatedFeatures", null), r([m({ readOnly: true })], _2.prototype, "relatedLayer", null), r([m({ readOnly: true })], _2.prototype, "relationship", null), r([m()], _2.prototype, "featureCount", void 0), r([m({ readOnly: true })], _2.prototype, "relatedFeatureViewModels", null), r([m()], _2.prototype, "relationshipId", void 0), r([m()], _2.prototype, "showAllEnabled", void 0), r([m()], _2.prototype, "state", null), r([m()], _2.prototype, "title", void 0), _2 = r([a("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")], _2);
var F6 = _2;

// node_modules/@arcgis/core/widgets/Feature/FeatureRelationship.js
var f4;
var b8 = "esri-feature";
var g7 = `${b8}-relationship`;
var y8 = { base: g7, listContainer: `${g7}__list`, listItem: `${g7}__list-item`, listItemHidden: `${g7}__list-item--hidden`, listContainerQuerying: `${g7}__list--querying`, featureObserver: `${b8}__feature-observer`, stickySpinnerContainer: `${b8}__sticky-loading-container`, loadingSpinnerContainer: `${b8}__loading-container` };
var F7 = { title: true, description: true };
var I7 = f4 = class extends B {
  constructor(e11, t6) {
    super(e11, t6), this._featureElementInfo = null, this._relatedFeatureIntersectionObserverNode = null, this._relatedFeatureIntersectionObserver = new IntersectionObserver(([e12]) => {
      (e12 == null ? void 0 : e12.isIntersecting) && this._increaseFeaturePage();
    }, { root: window.document }), this.flowItems = null, this.flowType = "feature-relationship", this.headingLevel = 2, this.viewModel = new F6(), this.messages = null, this.messagesCommon = null, this.visibleElements = { ...F7 }, this._increaseFeaturePage = () => {
      const { state: e12, showAllEnabled: t7, relatedFeatures: s12, featuresPerPage: i11, featurePage: r9 } = this.viewModel;
      "ready" === e12 && t7 && s12.length >= i11 * r9 && this.viewModel.featurePage++;
    };
  }
  initialize() {
    this._featureElementInfo = new l4(), this.addHandles([d2(() => [this.viewModel.description, this.viewModel.title, this.headingLevel], () => this._setupFeatureElementInfo(), P), d2(() => [this.viewModel.state, this.viewModel.showAllEnabled, this._relatedFeatureIntersectionObserverNode], () => this._handleRelatedFeatureObserverChange()), v(() => this.viewModel.relatedFeatureViewModels, "change", () => this._setupRelatedFeatureViewModels())]);
  }
  loadDependencies() {
    return r4({ icon: () => import("./calcite-icon-7LCZHQE3.js"), list: () => import("./calcite-list-J46ETVO2.js"), "list-item": () => import("./calcite-list-item-XAMOLEZU.js"), loader: () => import("./calcite-loader-GZNTWKUG.js"), notice: () => import("./calcite-notice-QIIO24YX.js") });
  }
  destroy() {
    this._unobserveRelatedFeatureObserver(), this._featureElementInfo = u(this._featureElementInfo);
  }
  get displayShowAllButton() {
    const { showAllEnabled: e11, featureCount: t6, displayCount: s12, state: i11 } = this.viewModel;
    return !e11 && !!t6 && "ready" === i11 && (t6 > s12 || 0 === s12);
  }
  get displayListItems() {
    return this.displayShowAllButton || this.viewModel.relatedFeatureViewModels.length > 0;
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e11) {
    this.viewModel.description = e11;
  }
  get featureCountDescription() {
    const { messages: e11 } = this, { featureCount: t6 } = this.viewModel;
    return s2(e11 == null ? void 0 : e11.numberRecords, { number: t6 });
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e11) {
    this.viewModel.title = e11;
  }
  castVisibleElements(e11) {
    return { ...F7, ...e11 };
  }
  render() {
    var _a;
    const { state: e11 } = this.viewModel;
    return n2("div", { class: this.classes(y8.base, e2.widget) }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), "loading" === e11 ? this._renderLoading() : "disabled" === e11 ? this._renderRelationshipNotFound() : this._renderRelatedFeatures());
  }
  async _selectRecord(e11) {
    const { flowItems: t6, featureVisibleElements: s12 } = this;
    if (!t6) return;
    e11.abilities = { relationshipContent: true };
    const { default: i11 } = await import("./Feature-QHGZSKE2.js");
    t6.push(new i11({ flowItems: t6, flowType: this.flowType, viewModel: e11, visibleElements: s12 }));
  }
  _showAllRecords() {
    const { flowItems: e11 } = this;
    if (!e11) return;
    const { viewModel: t6, featureVisibleElements: s12 } = this;
    t6.showAllEnabled = true;
    const i11 = new f4({ flowItems: e11, featureVisibleElements: s12, visibleElements: { title: false, description: false }, viewModel: t6 });
    e11.push(i11);
  }
  _renderStickyLoading() {
    return "querying" === this.viewModel.state ? n2("div", { class: y8.stickySpinnerContainer, key: "sticky-loader" }, this._renderLoadingIcon()) : null;
  }
  _renderLoadingIcon() {
    return n2("calcite-loader", { inline: true, label: "" });
  }
  _renderLoading() {
    return n2("div", { class: y8.loadingSpinnerContainer, key: "loading-container" }, this._renderLoadingIcon());
  }
  _renderShowAllIconNode() {
    return n2("calcite-icon", { icon: "list", scale: "s", slot: "content-end" });
  }
  _renderChevronIconNode() {
    const e11 = u2(this.container) ? "chevron-left" : "chevron-right";
    return n2("calcite-icon", { icon: e11, scale: "s", slot: "content-end" });
  }
  _renderRelatedFeature(e11) {
    var _a;
    const { itemDescriptionFieldName: t6 } = this.viewModel, s12 = e11.title;
    e11.description = t6 && ((_a = e11.formattedAttributes) == null ? void 0 : _a.global[t6]);
    const i11 = "loading" === e11.state;
    return n2("calcite-list-item", { class: this.classes(y8.listItem, { [y8.listItemHidden]: i11 }), description: e11.description ?? "", key: e11.uid, label: s12, onCalciteListItemSelect: () => this._selectRecord(e11) }, this._renderChevronIconNode());
  }
  _renderShowAllListItem() {
    var _a;
    return this.displayShowAllButton ? n2("calcite-list-item", { description: this.featureCountDescription, key: "show-all-item", label: (_a = this.messages) == null ? void 0 : _a.showAll, onCalciteListItemSelect: () => this._showAllRecords() }, this._renderShowAllIconNode()) : null;
  }
  _renderNoRelatedFeaturesMessage() {
    var _a;
    return n2("calcite-notice", { icon: "information", key: "no-related-features-message", kind: "brand", open: true, scale: "s", width: "full" }, n2("div", { slot: "message" }, (_a = this.messages) == null ? void 0 : _a.noRelatedFeatures));
  }
  _renderFeatureObserver() {
    return n2("div", { afterCreate: this._relatedFeatureIntersectionObserverCreated, bind: this, class: y8.featureObserver, key: "feature-observer" });
  }
  _renderList() {
    const { relatedFeatureViewModels: e11 } = this.viewModel;
    return n2("calcite-list", null, e11.toArray().map((e12) => this._renderRelatedFeature(e12)), this._renderShowAllListItem());
  }
  _renderRelatedFeatures() {
    const { displayListItems: e11 } = this, { state: t6 } = this.viewModel;
    return n2("div", { class: this.classes(y8.listContainer, { [y8.listContainerQuerying]: "querying" === t6 }), key: "list-container" }, e11 ? this._renderList() : "ready" === t6 ? this._renderNoRelatedFeaturesMessage() : null, this._renderStickyLoading(), this._renderFeatureObserver());
  }
  _renderRelationshipNotFound() {
    var _a;
    return n2("calcite-notice", { icon: "exclamation-mark-triangle", key: "relationship-not-found", kind: "danger", open: true, scale: "s", width: "full" }, n2("div", { slot: "message" }, (_a = this.messages) == null ? void 0 : _a.relationshipNotFound));
  }
  _setupRelatedFeatureViewModels() {
    const { relatedFeatureViewModels: e11 } = this.viewModel, t6 = "related-feature-viewmodels";
    this.removeHandles(t6), e11 == null ? void 0 : e11.forEach((e12) => {
      this.addHandles(d2(() => [e12.title, e12.state], () => this.scheduleRender(), P), t6);
    }), this.scheduleRender();
  }
  _setupFeatureElementInfo() {
    var _a;
    const { headingLevel: e11, visibleElements: t6 } = this, s12 = t6.description && this.description, i11 = t6.title && this.title;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: s12, title: i11, headingLevel: e11 });
  }
  async _handleRelatedFeatureObserverChange() {
    this._unobserveRelatedFeatureObserver();
    const { state: e11, showAllEnabled: t6 } = this.viewModel;
    await A(0), this._relatedFeatureIntersectionObserverNode && "ready" === e11 && t6 && this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode);
  }
  _relatedFeatureIntersectionObserverCreated(e11) {
    this._relatedFeatureIntersectionObserverNode = e11;
  }
  _unobserveRelatedFeatureObserver() {
    this._relatedFeatureIntersectionObserverNode && this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode);
  }
};
r([m()], I7.prototype, "_relatedFeatureIntersectionObserverNode", void 0), r([m({ readOnly: true })], I7.prototype, "displayShowAllButton", null), r([m({ readOnly: true })], I7.prototype, "displayListItems", null), r([m()], I7.prototype, "description", null), r([m({ readOnly: true })], I7.prototype, "featureCountDescription", null), r([m()], I7.prototype, "featureVisibleElements", void 0), r([m()], I7.prototype, "flowItems", void 0), r([m()], I7.prototype, "flowType", void 0), r([m()], I7.prototype, "headingLevel", void 0), r([m()], I7.prototype, "title", null), r([m({ type: F6 })], I7.prototype, "viewModel", void 0), r([m(), e("esri/widgets/Feature/t9n/Feature")], I7.prototype, "messages", void 0), r([m(), e("esri/t9n/common")], I7.prototype, "messagesCommon", void 0), r([m()], I7.prototype, "visibleElements", void 0), r([s3("visibleElements")], I7.prototype, "castVisibleElements", null), I7 = f4 = r([a("esri.widgets.Feature.FeatureRelationship")], I7);
var M5 = I7;

// node_modules/@arcgis/core/widgets/Feature/FeatureUtilityNetworkAssociations/resources.js
var o3 = { fromGlobalId: "fromglobalid", fromNetworkSourceId: "fromnetworksourceid", fromTerminalId: "fromterminalid", toGlobalId: "toglobalid", toNetworkSourceId: "tonetworksourceid", toTerminalId: "toterminalid", associationType: "associationtype", globalId: "globalid", status: "status", isContentVisible: "iscontentvisible", percentAlong: "percentalong", assetGroup: "assetgroup", assetType: "assettype" };

// node_modules/@arcgis/core/widgets/Feature/FeatureUtilityNetworkAssociations/FeatureUtilityNetworkAssociationsViewModel.js
var f5 = 100;
var _3 = class extends i5(s4(b2)) {
  constructor(t6) {
    super(t6), this._loaded = false, this._queryAbortController = null, this._queryPageAbortController = null, this._queryFeatureCountAbortController = null, this.networkSourceIdsInUse = /* @__PURE__ */ new Set(), this.description = null, this.graphic = null, this.layer = null, this.map = null, this.featureCount = 0, this.associationTypes = null, this.showAllEnabled = false, this.title = null, this.attachmentsFeatureCount = 0, this.structureFeatureCount = 0, this.contentFeatureCount = 0, this.containerFeatureCount = 0, this.connectivityFeatureCount = 0, this._cancelQuery = () => {
      const { _queryAbortController: t7 } = this;
      t7 && t7.abort(), this._queryAbortController = null;
    }, this._cancelQueryFeatureCount = () => {
      const { _queryFeatureCountAbortController: t7 } = this;
      t7 && t7.abort(), this._queryFeatureCountAbortController = null;
    }, this._queryController = async (t7) => {
      this._cancelQuery();
      const e11 = new AbortController();
      this._queryAbortController = e11, await d(this._query(t7)), this._queryAbortController === e11 && (this._queryAbortController = null);
    }, this._queryFeatureCountController = async () => {
      this._loaded = false, this._cancelQueryFeatureCount();
      const t7 = new AbortController();
      this._queryFeatureCountAbortController = t7, await d(this._queryFeatureCount()), this._queryFeatureCountAbortController === t7 && (this._queryFeatureCountAbortController = null), this._loaded = true;
    }, this._queryDebounced = k(this._queryController, f5), this._queryFeatureCountDebounced = k(this._queryFeatureCountController, f5);
  }
  initialize() {
    var _a, _b;
    (_a = this.associationTypes) == null ? void 0 : _a.forEach((t6) => {
      t6.open = false;
    }), this.addHandles([...((_b = this.associationTypes) == null ? void 0 : _b.map((t6) => d2(() => t6.open, () => {
      t6.open && this._queryDebounced(t6);
    }))) ?? [], d2(() => [this.graphic, this.layer, this.map, this.associationTypes, this.objectId, this.globalId, this.canQuery], () => this._queryFeatureCountDebounced(), P)]);
  }
  destroy() {
    this._cancelQuery(), this._cancelQueryFeatureCount(), this._destroyAssociatedFeatureViewModels();
  }
  get supportsCacheHint() {
    var _a, _b, _c;
    return !!((_c = (_b = (_a = this.layer) == null ? void 0 : _a.capabilities) == null ? void 0 : _b.query) == null ? void 0 : _c.supportsCacheHint);
  }
  get canLoad() {
    return !!this.map && !!this.associationTypes && "string" == typeof this.globalId;
  }
  get canQuery() {
    var _a, _b;
    const t6 = (_b = (_a = this.layer) == null ? void 0 : _a.capabilities) == null ? void 0 : _b.query;
    return !!this.associationTypes && "string" == typeof this.globalId && !!(t6 == null ? void 0 : t6.supportsPagination);
  }
  get objectId() {
    var _a, _b;
    return (this.objectIdField && ((_b = (_a = this.graphic) == null ? void 0 : _a.attributes) == null ? void 0 : _b[this.objectIdField])) ?? null;
  }
  get objectIdField() {
    var _a;
    return ((_a = this.layer) == null ? void 0 : _a.objectIdField) || null;
  }
  get globalId() {
    var _a, _b;
    return (this.globalIdField && ((_b = (_a = this.graphic) == null ? void 0 : _a.attributes) == null ? void 0 : _b[this.globalIdField])) ?? null;
  }
  get globalIdField() {
    const { layer: t6 } = this;
    return "subtype-sublayer" === (t6 == null ? void 0 : t6.type) && (t6 == null ? void 0 : t6.parent) ? t6.parent.globalIdField ?? null : (t6 == null ? void 0 : t6.globalIdField) ?? null;
  }
  get state() {
    const { _queryAbortController: t6, _queryFeatureCountAbortController: e11, _queryPageAbortController: o4, canQuery: r9, _loaded: s12, canLoad: a5 } = this;
    return e11 || a5 && !s12 ? "loading" : t6 || o4 ? "querying" : r9 && 0 !== this.featureCount ? "ready" : "disabled";
  }
  get utilityNetwork() {
    const { layer: t6, map: e11 } = this;
    return (t6 == null ? void 0 : t6.loaded) && e11 ? "subtype-sublayer" === (t6 == null ? void 0 : t6.type) && (t6 == null ? void 0 : t6.parent) ? Ne(e11, t6.parent) ?? null : Ne(e11, t6) ?? null : null;
  }
  get associationsLayer() {
    const { utilityNetwork: t6 } = this;
    return (t6 == null ? void 0 : t6.loaded) ? new Xe({ url: t6.networkSystemLayers.associationsTableUrl, gdbVersion: t6.gdbVersion }) : null;
  }
  get attachmentsAssociations() {
    return this._get("attachmentsAssociations") || new V();
  }
  get structureAssociations() {
    return this._get("structureAssociations") || new V();
  }
  get contentAssociations() {
    return this._get("contentAssociations") || new V();
  }
  get containerAssociations() {
    return this._get("containerAssociations") || new V();
  }
  get connectivityAssociations() {
    return this._get("connectivityAssociations") || new V();
  }
  get associationFeatures() {
    return this._get("associationFeatures") || new s6();
  }
  get associationViewModels() {
    return this._get("associationViewModels") || /* @__PURE__ */ new Map();
  }
  refresh() {
    this._queryFeatureCountDebounced();
  }
  _destroyAssociatedFeatureViewModels() {
    this.associationViewModels.forEach((t6) => t6.destroyAll());
  }
  _generateGlobalIdWhereClause(t6, e11) {
    const { globalId: o4, networkSourceIdsInUse: r9 } = this, { associatedNetworkSourceId: s12 } = t6, a5 = e11.fieldsIndex.get(o3.fromGlobalId), n11 = e11.fieldsIndex.get(o3.toGlobalId), i11 = e11.fieldsIndex.get(o3.fromNetworkSourceId), l9 = e11.fieldsIndex.get(o3.toNetworkSourceId), u9 = null != s12, c14 = `(${Array.from(r9.values())})`, d10 = u9 ? ` AND ${l9.name} = ${s12} AND ${l9.name} IN ${c14}` : "", y10 = u9 ? ` AND ${i11.name} = ${s12} AND ${i11.name} IN ${c14}` : "";
    switch (t6.type) {
      case "connectivity":
        return `((${a5.name} = '${o4}'${d10}) OR (${n11.name} = '${o4}'${y10}))`;
      case "attachment":
      case "content":
        return `${a5.name} = '${o4}'${d10}`;
      case "container":
      case "structure":
        return `${n11.name} = '${o4}'${y10}`;
      default:
        return "";
    }
  }
  _generateNetworkSourceIdWhereClause(t6) {
    const { networkSourceIdsInUse: e11 } = this, o4 = `(${Array.from(e11.values())})`, r9 = t6.fieldsIndex.get(o3.fromNetworkSourceId), s12 = t6.fieldsIndex.get(o3.toNetworkSourceId);
    return `(${r9.name} IN ${o4} AND ${s12.name} IN ${o4})`;
  }
  _generateAssociationTypeWhereClause(t6, e11) {
    const o4 = e11.fieldsIndex.get(o3.associationType);
    switch (t6.type) {
      case "attachment":
      case "structure":
        return `${o4.name} = 3`;
      case "connectivity":
        return `${o4.name} IN  (1, 4, 5, 6)`;
      case "container":
      case "content":
        return `${o4.name} = 2`;
      default:
        return "";
    }
  }
  _generateWhereClause(t6, e11) {
    const o4 = e11.fieldsIndex.get(o3.status), r9 = `(${e3.join(",")})`, s12 = `${o4.name} IN ${r9}`;
    return `(${this._generateGlobalIdWhereClause(t6, e11)} AND ${s12} AND ${this._generateAssociationTypeWhereClause(t6, e11)})`;
  }
  async _loadUtiltyNetworks() {
    var _a;
    const t6 = this.map;
    if (!t6) return;
    await Promise.allSettled(((_a = t6.utilityNetworks) == null ? void 0 : _a.map(async (t7) => {
      await t7.load();
    })) ?? []);
    const e11 = (t7) => {
      if ("layerId" in t7 && o4.isUtilityLayer(t7)) {
        const e12 = o4.getSourceIdByLayerId(t7.layerId);
        null !== e12 && this.networkSourceIdsInUse.add(e12);
      }
    }, o4 = this.utilityNetwork;
    this._set("networkSourceIdsInUse", /* @__PURE__ */ new Set()), t6.allLayers.forEach(e11), t6.allTables.forEach(e11);
  }
  async _findLayersBySourceId(t6) {
    const { utilityNetwork: e11, map: o4 } = this, r9 = (t7) => {
      const o5 = t7;
      if (!t7.url) return false;
      if (o5.layerId === s12) {
        return t7.url.replace(/\/\d+$/, "") === (e11 == null ? void 0 : e11.featureServiceUrl);
      }
      return false;
    };
    await (e11 == null ? void 0 : e11.load());
    const s12 = e11.getLayerIdBySourceId(t6), a5 = o4.allLayers.filter(r9), n11 = o4.allTables.filter(r9), i11 = a5.concat(n11).toArray();
    return await Promise.allSettled(i11.map((t7) => t7.load())), i11;
  }
  _clearAssociations() {
    this.attachmentsAssociations.removeAll(), this.structureAssociations.removeAll(), this.contentAssociations.removeAll(), this.containerAssociations.removeAll(), this.connectivityAssociations.removeAll();
  }
  _clearFeatures() {
    this.associationFeatures.forEach((t6) => t6.removeAll()), this.associationFeatures.clear();
  }
  _getAssociationsByType(t6) {
    switch (t6) {
      case "attachment":
        return this.attachmentsAssociations;
      case "structure":
        return this.structureAssociations;
      case "connectivity":
        return this.connectivityAssociations;
      case "container":
        return this.containerAssociations;
      case "content":
        return this.contentAssociations;
    }
  }
  _createAssociationFromFeature(t6, e11) {
    if (!t6) return null;
    const o4 = u3.get(e11.attributes[t6.fieldsIndex.get(o3.associationType).name]);
    return new d5({ globalId: e11.attributes[t6.fieldsIndex.get(o3.globalId).name], fromNetworkElement: new p3({ globalId: e11.attributes[t6.fieldsIndex.get(o3.fromGlobalId).name], networkSourceId: e11.attributes[t6.fieldsIndex.get(o3.fromNetworkSourceId).name], terminalId: e11.attributes[t6.fieldsIndex.get(o3.fromTerminalId).name] }), toNetworkElement: new p3({ globalId: e11.attributes[t6.fieldsIndex.get(o3.toGlobalId).name], networkSourceId: e11.attributes[t6.fieldsIndex.get(o3.toNetworkSourceId).name], terminalId: e11.attributes[t6.fieldsIndex.get(o3.toTerminalId).name] }), associationType: o4, status: e11.attributes[t6.fieldsIndex.get(o3.status).name], isContentVisible: e11.attributes[t6.fieldsIndex.get(o3.isContentVisible).name], percentAlong: e11.attributes[t6.fieldsIndex.get(o3.percentAlong).name] });
  }
  async _queryLayer(t6, e11, o4, r9, s12) {
    const a5 = t6.fieldsIndex.get(o3.assetGroup), n11 = t6.fieldsIndex.get(o3.assetType), i11 = null != o4, l9 = null != r9, u9 = "(" + e11.map((t7) => `'${t7}'`).join(", ") + ")", c14 = i11 ? ` AND ${a5 == null ? void 0 : a5.name} = ${o4}` : "", d10 = i11 && l9 ? ` AND ${n11 == null ? void 0 : n11.name} = ${r9}` : "", y10 = `${t6.globalIdField} IN ${u9}` + c14 + d10, h10 = new b3({ outFields: ["*"], cacheHint: this.supportsCacheHint, where: y10 });
    return await this._queryAll(h10, t6, { signal: s12 == null ? void 0 : s12.signal });
  }
  async _createAssociationFeatureObjects(t6, e11, o4, r9, s12, a5) {
    if (0 === t6.length) return [];
    const n11 = /* @__PURE__ */ new Map();
    for (const [l9, u9] of e11) {
      const t7 = await this._findLayersBySourceId(l9);
      for (const e12 of t7) {
        (await this._queryLayer(e12, u9, r9, s12, a5)).forEach((t8) => {
          if (t8.getEffectivePopupTemplate() && t8.layer) {
            const o5 = n11.get(t8.attributes[e12.globalIdField]) ?? [];
            o5.push(t8), n11.set(t8.attributes[e12.globalIdField], o5);
          }
        });
      }
    }
    const i11 = [];
    return t6.toArray().forEach((t7) => {
      const e12 = t7.fromNetworkElement.globalId === o4 ? t7.toNetworkElement : t7.fromNetworkElement;
      (n11.get(e12.globalId) ?? []).forEach((o5) => {
        var _a, _b;
        const r10 = (_b = (_a = this.utilityNetwork) == null ? void 0 : _a.getTerminalById(e12 == null ? void 0 : e12.terminalId)) == null ? void 0 : _b.name;
        i11.push({ association: t7, feature: o5, terminalName: r10 });
      });
    }), i11;
  }
  _parseFeatureObjects(t6, e11) {
    t6.forEach((t7) => {
      const o4 = t7 == null ? void 0 : t7.feature, r9 = o4.layer, a5 = e11.get(r9) ?? new V();
      a5.add(t7), e11.set(r9, a5);
    });
  }
  async _queryAll(t6, e11, o4) {
    var _a;
    const r9 = [];
    let s12 = 0, a5 = false;
    t6.num = ((_a = e11.sourceJSON) == null ? void 0 : _a.maxRecordCount) ?? 2e3;
    do {
      t6.start = s12;
      const n11 = await e11.queryFeatures(t6, o4);
      r9.push(...n11.features), a5 = n11.exceededTransferLimit, a5 && (s12 += n11.features.length);
    } while (a5);
    return r9;
  }
  async _queryAssociatedFeatureCount(t6) {
    const { layer: e11, globalId: o4, supportsCacheHint: r9, associationTypes: s12, associationsLayer: a5, utilityNetwork: n11, canQuery: i11 } = this;
    if (await Promise.allSettled([e11 == null ? void 0 : e11.load(), n11 == null ? void 0 : n11.load(), a5 == null ? void 0 : a5.load()]), this._clearAssociations(), !(i11 && e11 && s12 && a5)) return;
    const l9 = a5.fieldsIndex.get(o3.toGlobalId).name, u9 = a5.fieldsIndex.get(o3.fromGlobalId).name, c14 = s12.map((t7) => this._generateWhereClause(t7, a5)), d10 = this._generateNetworkSourceIdWhereClause(a5), y10 = c14.join(" OR "), h10 = new b3({ outFields: ["*"], cacheHint: r9, returnGeometry: false, where: `(${y10}) AND (${d10})` }), p12 = await this._queryAll(h10, a5, { signal: t6 == null ? void 0 : t6.signal }), m9 = /* @__PURE__ */ new Map();
    s12.forEach((t7) => {
      m9.set(t7.type, []);
    }), p12.forEach((t7) => {
      const e12 = a5.fieldsIndex.get(o3.associationType);
      switch (t7.attributes[e12.name]) {
        case 1:
        case 4:
        case 5:
        case 6:
          t7.attributes[u9] === o4 ? m9.get("connectivity").push(t7.attributes[l9]) : m9.get("connectivity").push(t7.attributes[u9]), this.connectivityAssociations.add(this._createAssociationFromFeature(a5, t7));
          break;
        case 2:
          t7.attributes[u9] === o4 ? (m9.get("content").push(t7.attributes[l9]), this.contentAssociations.add(this._createAssociationFromFeature(a5, t7))) : (m9.get("container").push(t7.attributes[u9]), this.containerAssociations.add(this._createAssociationFromFeature(a5, t7)));
          break;
        case 3:
          t7.attributes[u9] === o4 ? (m9.get("attachment").push(t7.attributes[l9]), this.attachmentsAssociations.add(this._createAssociationFromFeature(a5, t7))) : (m9.get("structure").push(t7.attributes[u9]), this.structureAssociations.add(this._createAssociationFromFeature(a5, t7)));
      }
    });
    const g10 = s12.map(async (e12) => {
      const { associatedNetworkSourceId: o5, associatedAssetGroup: r10, associatedAssetType: s13 } = e12, a6 = m9.get(e12.type), n12 = null != r10 ? await this._countAssociatedFeatures(o5, a6, r10, s13, t6) : a6.length;
      switch (e12.type) {
        case "attachment":
          this._set("attachmentsFeatureCount", n12);
          break;
        case "structure":
          this._set("structureFeatureCount", n12);
          break;
        case "content":
          this._set("contentFeatureCount", n12);
          break;
        case "container":
          this._set("containerFeatureCount", n12);
          break;
        case "connectivity":
          this._set("connectivityFeatureCount", n12);
      }
    });
    await Promise.allSettled(g10);
  }
  async _countAssociatedFeatureCount(t6, e11, o4, r9, s12) {
    const a5 = t6.fieldsIndex.get(o3.assetGroup), n11 = t6.fieldsIndex.get(o3.assetType), i11 = null != r9, l9 = "(" + e11.map((t7) => `'${t7}'`).join(", ") + ")", u9 = ` AND ${a5 == null ? void 0 : a5.name} = ${o4}`, c14 = i11 ? ` AND ${n11 == null ? void 0 : n11.name} = ${r9}` : "", d10 = `${t6.globalIdField} IN ${l9}` + u9 + c14;
    return t6.queryFeatureCount({ where: d10, outFields: ["*"], returnGeometry: false }, { signal: s12 == null ? void 0 : s12.signal });
  }
  async _countAssociatedFeatures(t6, e11, o4, r9, s12) {
    if (0 === e11.length) return 0;
    const a5 = (await this._findLayersBySourceId(t6)).map(async (t7) => this._countAssociatedFeatureCount(t7, e11, o4, r9, s12));
    return (await Promise.all(a5)).reduce((t7, e12) => t7 + e12, 0);
  }
  async _queryAssociatedFeatures(t6, e11) {
    const { layer: o4, globalId: r9, associationTypes: s12, associationsLayer: a5, utilityNetwork: n11, canQuery: i11, associationFeatures: l9 } = this;
    if (await Promise.allSettled([o4 == null ? void 0 : o4.load(), n11 == null ? void 0 : n11.load(), a5 == null ? void 0 : a5.load()]), !(i11 && o4 && s12 && a5)) return;
    const u9 = this._getAssociationsByType(t6.type), { associatedAssetGroup: c14, associatedAssetType: d10 } = t6, y10 = /* @__PURE__ */ new Map();
    u9.forEach((t7) => {
      const { networkSourceId: e12, elementGlobalId: o5 } = t7.fromNetworkElement.globalId === r9 ? { networkSourceId: t7.toNetworkElement.networkSourceId, elementGlobalId: t7.toNetworkElement.globalId } : { networkSourceId: t7.fromNetworkElement.networkSourceId, elementGlobalId: t7.fromNetworkElement.globalId }, s13 = y10.get(e12) || [];
      s13.push(o5), y10.set(e12, s13);
    });
    const h10 = await this._createAssociationFeatureObjects(u9, y10, r9, c14, d10, e11);
    this._parseFeatureObjects(h10, l9);
  }
  async _queryFeatureCount() {
    await this._loadUtiltyNetworks();
    const { _queryFeatureCountAbortController: t6, canQuery: e11 } = this;
    e11 ? (await this._queryAssociatedFeatureCount(t6), this._set("featureCount", this.attachmentsFeatureCount + this.structureFeatureCount + this.contentFeatureCount + this.containerFeatureCount + this.connectivityFeatureCount)) : this._set("featureCount", 0);
  }
  async _query(t6) {
    await this._loadUtiltyNetworks();
    const { _queryAbortController: e11 } = this;
    this.featureCount && (this._destroyAssociatedFeatureViewModels(), this._clearFeatures(), this.destroyed || await this._queryAssociatedFeatures(t6, { signal: e11 == null ? void 0 : e11.signal }));
  }
};
r([m()], _3.prototype, "_loaded", void 0), r([m()], _3.prototype, "_queryAbortController", void 0), r([m()], _3.prototype, "_queryPageAbortController", void 0), r([m()], _3.prototype, "_queryFeatureCountAbortController", void 0), r([m({ readOnly: true })], _3.prototype, "supportsCacheHint", null), r([m({ readOnly: true })], _3.prototype, "canLoad", null), r([m({ readOnly: true })], _3.prototype, "canQuery", null), r([m()], _3.prototype, "networkSourceIdsInUse", void 0), r([m()], _3.prototype, "description", void 0), r([m({ type: d3 })], _3.prototype, "graphic", void 0), r([m()], _3.prototype, "layer", void 0), r([m()], _3.prototype, "map", void 0), r([m({ readOnly: true })], _3.prototype, "objectId", null), r([m({ readOnly: true })], _3.prototype, "objectIdField", null), r([m({ readOnly: true })], _3.prototype, "globalId", null), r([m({ readOnly: true })], _3.prototype, "globalIdField", null), r([m()], _3.prototype, "featureCount", void 0), r([m()], _3.prototype, "associationTypes", void 0), r([m()], _3.prototype, "showAllEnabled", void 0), r([m()], _3.prototype, "state", null), r([m()], _3.prototype, "title", void 0), r([m({ readOnly: true })], _3.prototype, "utilityNetwork", null), r([m({ readOnly: true })], _3.prototype, "associationsLayer", null), r([m({ readOnly: true })], _3.prototype, "attachmentsFeatureCount", void 0), r([m({ readOnly: true })], _3.prototype, "structureFeatureCount", void 0), r([m({ readOnly: true })], _3.prototype, "attachmentsAssociations", null), r([m({ readOnly: true })], _3.prototype, "structureAssociations", null), r([m({ readOnly: true })], _3.prototype, "contentFeatureCount", void 0), r([m({ readOnly: true })], _3.prototype, "containerFeatureCount", void 0), r([m({ readOnly: true })], _3.prototype, "contentAssociations", null), r([m({ readOnly: true })], _3.prototype, "containerAssociations", null), r([m({ readOnly: true })], _3.prototype, "connectivityFeatureCount", void 0), r([m({ readOnly: true })], _3.prototype, "connectivityAssociations", null), r([m({ readOnly: true })], _3.prototype, "associationFeatures", null), r([m({ readOnly: true })], _3.prototype, "associationViewModels", null), _3 = r([a("esri.widgets.Feature.FeatureUtilityNetworkAssociations.FeatureUtilityNetworkAssociationsViewModel")], _3);
var F8 = _3;

// node_modules/@arcgis/core/widgets/Feature/FeatureUtilityNetworkAssociations/VisibleElements.js
var s11 = class extends b2 {
  constructor(o4) {
    super(o4), this.title = true, this.description = true;
  }
};
r([m({ type: Boolean, nonNullable: true })], s11.prototype, "title", void 0), r([m({ type: Boolean, nonNullable: true })], s11.prototype, "description", void 0), s11 = r([a("esri.widgets.Feature.FeatureUtilityNetworkAssociations.VisibleElements")], s11);
var i10 = s11;

// node_modules/@arcgis/core/widgets/Feature/FeatureUtilityNetworkAssociationType.js
var _4;
var g8 = "esri-feature";
var f6 = `${g8}-relationship`;
var w10 = { base: f6, listContainer: `${f6}__list`, listItem: `${f6}__list-item`, listItemHidden: `${f6}__list-item--hidden`, listContainerQuerying: `${f6}__list--querying`, featureObserver: `${g8}__feature-observer`, stickySpinnerContainer: `${g8}__sticky-loading-container`, loadingSpinnerContainer: `${g8}__loading-container`, expander: `${f6}__expander`, filterContainer: `${g8}__filter-container` };
var F9 = _4 = class extends B {
  constructor(e11, t6) {
    super(e11, t6), this.flowType = "feature-utility-network-association-type", this.description = null, this.headingLevel = 2, this.title = null, this.viewModel = new F8(), this.parentFeatureViewModel = null, this.listType = null, this.selectedLayer = null, this.flowItems = null, this.messages = null, this.messagesCommon = null, this.visibleElements = new i10(), this._featuresPerPage = 50, this._maxNumFeatures = 1e3, this._currentFeaturePage = 1, this._previewDisplayCount = 3, this._associatedFeatureIntersectionObserverNode = null, this._associatedFeatureIntersectionObserver = new IntersectionObserver(([e12]) => {
      (e12 == null ? void 0 : e12.isIntersecting) && this._increaseFeaturePage();
    }, { root: window.document }), this._tooltipReferenceMap = new s6(), this._filterText = "";
  }
  initialize() {
    this.addHandles([d2(() => [this._associatedFeatureIntersectionObserverNode], () => this._handleAssociatedFeatureObserverChange())]);
  }
  loadDependencies() {
    return r4({ chip: () => import("./calcite-chip-H22QYBMM.js"), icon: () => import("./calcite-icon-7LCZHQE3.js"), input: () => import("./calcite-input-ATVHSFHY.js"), loader: () => import("./calcite-loader-GZNTWKUG.js"), list: () => import("./calcite-list-J46ETVO2.js"), "list-item": () => import("./calcite-list-item-XAMOLEZU.js"), tooltip: () => import("./calcite-tooltip-53XBFCKU.js") });
  }
  destroy() {
    this._tooltipReferenceMap.clear();
  }
  get _numAssociatedFeatures() {
    const e11 = this.viewModel.associationViewModels;
    return this.selectedLayer ? e11.get(this.selectedLayer).length : 0;
  }
  set currentFeaturePage(e11) {
    const { _featuresPerPage: t6, _numAssociatedFeatures: i11 } = this, s12 = 1, o4 = Math.ceil(i11 / t6) || 1;
    this._currentFeaturePage = Math.max(Math.min(e11, o4), s12);
  }
  get currentFeaturePage() {
    return this._currentFeaturePage;
  }
  render() {
    const e11 = this.viewModel.associationViewModels, { state: t6, showAllEnabled: i11 } = this.viewModel, { state: s12 } = this.parentFeatureViewModel ?? {};
    return n2("div", { class: this.classes(w10.base, e2.widget) }, "loading" === t6 || "querying" === t6 || "loading" === s12 ? this._renderLoading() : n2("calcite-list", null, i11 && this.selectedLayer ? n2(i4, null, this._renderFilter(), this._renderAssociatedFeatureListPage(), this._renderFeatureObserver()) : Array.from(e11.keys(), (t7) => this._renderTypeList(t7, e11.get(t7)))));
  }
  _renderFilter() {
    return n2("div", { class: w10.filterContainer, key: "filter" }, n2("calcite-input", { icon: "search", placeholder: this.messages.associationFilterPlaceholder, type: "search", onCalciteInputInput: (e11) => {
      this._filterText = e11.target.value.trim().toLowerCase(), this._currentFeaturePage = 1;
    } }));
  }
  _showAllAssociations(e11) {
    const { flowItems: t6, viewModel: i11, description: s12 } = this;
    if (!t6 || !e11) return;
    i11.showAllEnabled = true;
    const o4 = new _4({ selectedLayer: e11, title: e11 == null ? void 0 : e11.title, flowItems: t6, parentFeatureViewModel: this.parentFeatureViewModel, featureVisibleElements: this.featureVisibleElements, description: s12, visibleElements: { title: false, description: false }, viewModel: i11 });
    t6.push(o4);
  }
  _renderAssociatedFeatureListPage() {
    const { currentFeaturePage: e11, _featuresPerPage: t6, _maxNumFeatures: i11, _filterText: s12 } = this, o4 = Math.min(e11 * t6, i11), r9 = this.viewModel.associationViewModels.get(this.selectedLayer).filter((e12) => c4(e12.featureViewModel).toLowerCase().includes(s12)).slice(0, o4);
    return [...this._renderTooltips(r9), ...this._renderAssociatedFeatureList(r9)];
  }
  async _handleAssociatedFeatureObserverChange() {
    this._associatedFeatureIntersectionObserverNode && this._associatedFeatureIntersectionObserver.unobserve(this._associatedFeatureIntersectionObserverNode);
    const { state: e11, showAllEnabled: i11 } = this.viewModel;
    await A(0), this._associatedFeatureIntersectionObserverNode && "ready" === e11 && i11 && this._associatedFeatureIntersectionObserver.observe(this._associatedFeatureIntersectionObserverNode);
  }
  _associatedFeatureIntersectionObserverCreated(e11) {
    this._associatedFeatureIntersectionObserverNode = e11;
  }
  _renderFeatureObserver() {
    return n2("div", { afterCreate: this._associatedFeatureIntersectionObserverCreated, bind: this, class: w10.featureObserver, key: "feature-observer" });
  }
  _increaseFeaturePage() {
    this.currentFeaturePage++;
  }
  _renderLoading() {
    return n2("div", { class: w10.loadingSpinnerContainer, key: "loading-container" }, this._renderLoadingIcon());
  }
  _renderLoadingIcon() {
    return n2("calcite-loader", { inline: true, label: "" });
  }
  isConnectivity(e11) {
    return ["connectivity", "junction-junction-connectivity", "junction-edge-from-connectivity", "junction-midspan-connectivity", "junction-edge-to-connectivity"].includes(e11.association.associationType);
  }
  _getConnectivityTooltip(e11) {
    switch (e11) {
      case "connectivity":
      case "junction-junction-connectivity":
        return this.messages.associationsJunctionJunction;
      case "junction-edge-from-connectivity":
        return this.messages.associationsJunctionEdgeFrom;
      case "junction-midspan-connectivity":
        return this.messages.associationsJunctionEdgeMidspan;
      case "junction-edge-to-connectivity":
        return this.messages.associationsJunctionEdgeTo;
      default:
        return "";
    }
  }
  _renderItemTooltip(e11) {
    const { _tooltipReferenceMap: t6 } = this;
    return this.isConnectivity(e11) ? n2("calcite-tooltip", { key: `tooltip-${e11.featureViewModel.uid}`, referenceElement: t6.get(e11.featureViewModel.uid) }, this._getConnectivityTooltip(e11.association.associationType)) : null;
  }
  _renderConnectivityIcon(e11, t6) {
    let i11;
    switch (e11) {
      case "junction-edge-from-connectivity":
        i11 = "connection-end-left";
        break;
      case "junction-edge-to-connectivity":
        i11 = "connection-end-right";
        break;
      case "junction-midspan-connectivity":
        i11 = "connection-middle";
        break;
      default:
        i11 = "connection-to-connection";
    }
    return n2("calcite-icon", { afterCreate: (e12) => this._tooltipReferenceMap.set(t6, e12), afterRemoved: () => this._tooltipReferenceMap.delete(t6), icon: i11, scale: "s", slot: "content-start" });
  }
  _formatPercentAlong(e11) {
    return `${l(e11.association.percentAlong, { style: "percent", maximumFractionDigits: 2 })}`;
  }
  _renderAssociatedFeature(e11) {
    const { featureViewModel: t6 } = e11, i11 = c4(t6), s12 = "loading" === t6.state, o4 = this._findFlowItem(t6), r9 = o4 < 0 && this._isParentFeature(t6), n11 = r9 || o4 >= 0, l9 = this.isConnectivity(e11), c14 = l9 && "junction-midspan-connectivity" === e11.association.associationType;
    return n2("calcite-list-item", { class: this.classes(w10.listItem, { [w10.listItemHidden]: s12 }), description: e11.terminalName ?? "", key: `associated-feature-type-${t6.uid}`, label: i11, onCalciteListItemSelect: () => this._handleFeatureClick(r9, o4, t6) }, l9 ? this._renderConnectivityIcon(e11.association.associationType, e11.featureViewModel.uid) : null, c14 ? n2("calcite-chip", { scale: "s", slot: "content-end", value: e11.association.percentAlong }, this._formatPercentAlong(e11)) : null, this._renderChevronIconNode(n11));
  }
  async _selectAssociation(e11) {
    const { flowItems: t6, featureVisibleElements: i11 } = this;
    if (!t6) return;
    e11.abilities = { utilityNetworkAssociationsContent: true };
    const { default: s12 } = await import("./Feature-QHGZSKE2.js");
    t6.push(new s12({ flowItems: t6, flowType: "feature-association", viewModel: e11, visibleElements: i11 }));
  }
  _handleFeatureClick(e11, t6, i11) {
    if (e11) this.flowItems.drain((e12) => {
      "showAllEnabled" in e12.viewModel && (e12.viewModel.showAllEnabled = false), e12.viewModel = null, e12.destroy();
    });
    else if (t6 < 0 || !this.flowItems) this._selectAssociation(i11);
    else for (; this.flowItems.length > t6 + 1; ) {
      const e12 = this.flowItems.pop();
      e12 && ("showAllEnabled" in e12.viewModel && (e12.viewModel.showAllEnabled = false), e12.viewModel = null, e12.destroy());
    }
  }
  _featureViewModelMatch(e11, t6) {
    const i11 = e11.graphic, s12 = i11 == null ? void 0 : i11.layer;
    let o4 = null;
    "subtype-sublayer" === (s12 == null ? void 0 : s12.type) && s12.parent ? o4 = s12.parent.globalIdField ?? null : s12 && "globalIdField" in s12 && (o4 = s12.globalIdField);
    const r9 = o4 ? i11 == null ? void 0 : i11.attributes[o4] : null, n11 = t6.graphic, a5 = n11 == null ? void 0 : n11.layer;
    let l9 = null;
    "subtype-sublayer" === (a5 == null ? void 0 : a5.type) && a5.parent ? l9 = a5.parent.globalIdField ?? null : a5 && "globalIdField" in a5 && (l9 = a5.globalIdField);
    const c14 = l9 ? n11 == null ? void 0 : n11.attributes[l9] : null;
    return r9 && c14 && r9 === c14;
  }
  _isParentFeature(e11) {
    var _a;
    const t6 = (_a = this.flowItems) == null ? void 0 : _a.getItemAt(0);
    if (!t6) return false;
    const i11 = t6.parentFeatureViewModel;
    return this._featureViewModelMatch(i11, e11);
  }
  _findFlowItem(e11) {
    var _a;
    return ((_a = this.flowItems) == null ? void 0 : _a.findIndex((t6) => {
      if ("feature" !== t6.flowType) return false;
      const i11 = t6.viewModel;
      return this._featureViewModelMatch(i11, e11);
    })) ?? -1;
  }
  _renderTooltips(e11) {
    return e11.toArray().map((e12) => this._renderItemTooltip(e12));
  }
  _renderAssociatedFeatureList(e11) {
    return e11.toArray().map((e12) => this._renderAssociatedFeature(e12));
  }
  _renderChevronIconNode(e11) {
    return n2("calcite-icon", { flipRtl: true, icon: e11 ? "move-up" : "chevron-right", scale: "s", slot: "content-end" });
  }
  _renderTypeList(e11, t6) {
    const { messages: i11 } = this, s12 = t6.slice(0, this._previewDisplayCount), o4 = s12.length < t6.length;
    return n2("calcite-list-item", { key: "show-all", label: e11.title, open: true, value: e11.id }, n2("calcite-chip", { scale: "s", slot: "actions-end", value: e11.id }, t6.length), n2("calcite-list", { group: e11.id }, [this._renderTooltips(s12), this._renderAssociatedFeatureList(s12)], o4 ? n2("calcite-list-item", { description: s2(i11 == null ? void 0 : i11.numberRecords, { number: t6.length.toString() }), key: "show-all-item", label: i11.showAll, onCalciteListItemSelect: () => this._showAllAssociations(e11) }, n2("calcite-icon", { icon: "list", scale: "s", slot: "content-end" })) : null));
  }
};
r([m()], F9.prototype, "flowType", void 0), r([m()], F9.prototype, "description", void 0), r([m()], F9.prototype, "headingLevel", void 0), r([m()], F9.prototype, "title", void 0), r([m({ type: F8 })], F9.prototype, "viewModel", void 0), r([m()], F9.prototype, "parentFeatureViewModel", void 0), r([m()], F9.prototype, "listType", void 0), r([m()], F9.prototype, "selectedLayer", void 0), r([m()], F9.prototype, "featureVisibleElements", void 0), r([m()], F9.prototype, "flowItems", void 0), r([m(), e("esri/widgets/Feature/t9n/Feature")], F9.prototype, "messages", void 0), r([m(), e("esri/t9n/common")], F9.prototype, "messagesCommon", void 0), r([m({ type: i10, nonNullable: true })], F9.prototype, "visibleElements", void 0), r([m()], F9.prototype, "_featuresPerPage", void 0), r([m()], F9.prototype, "_maxNumFeatures", void 0), r([m()], F9.prototype, "_numAssociatedFeatures", null), r([m()], F9.prototype, "_currentFeaturePage", void 0), r([m()], F9.prototype, "currentFeaturePage", null), r([m()], F9.prototype, "_previewDisplayCount", void 0), r([m()], F9.prototype, "_associatedFeatureIntersectionObserverNode", void 0), r([m()], F9.prototype, "_tooltipReferenceMap", void 0), r([m()], F9.prototype, "_filterText", void 0), F9 = _4 = r([a("esri.widgets.Feature.FeatureUtilityNetworkAssociationType")], F9);
var b9 = F9;

// node_modules/@arcgis/core/widgets/Feature/FeatureUtilityNetworkAssociations.js
var y9 = "esri-feature";
var v8 = `${y9}-relationship`;
var g9 = { base: v8, listContainer: `${v8}__list`, listItem: `${v8}__list-item`, listItemHidden: `${v8}__list-item--hidden`, listContainerQuerying: `${v8}__list--querying`, featureObserver: `${y9}__feature-observer`, stickySpinnerContainer: `${y9}__sticky-loading-container`, loadingSpinnerContainer: `${y9}__loading-container`, expander: `${v8}__expander` };
var f7 = class extends B {
  constructor(e11, t6) {
    super(e11, t6), this._featureElementInfo = null, this.flowType = "feature-utility-network-associations", this.flowItems = null, this.parentFeatureViewModel = null, this.headingLevel = 2, this.viewModel = new F8(), this.messages = null, this.messagesCommon = null, this.visibleElements = new i10();
  }
  initialize() {
    this._featureElementInfo = new l4(), this.addHandles([d2(() => [this.viewModel.description, this.viewModel.title, this.headingLevel], () => this._setupFeatureElementInfo(), P)]);
  }
  loadDependencies() {
    return r4({ chip: () => import("./calcite-chip-H22QYBMM.js"), icon: () => import("./calcite-icon-7LCZHQE3.js"), loader: () => import("./calcite-loader-GZNTWKUG.js"), notice: () => import("./calcite-notice-QIIO24YX.js"), list: () => import("./calcite-list-J46ETVO2.js"), "list-item": () => import("./calcite-list-item-XAMOLEZU.js") });
  }
  destroy() {
    this._featureElementInfo = u(this._featureElementInfo);
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e11) {
    this.viewModel.description = e11;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e11) {
    this.viewModel.title = e11;
  }
  render() {
    var _a;
    const { state: e11 } = this.viewModel;
    return n2("div", { class: this.classes(g9.base, e2.widget) }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), "loading" === e11 ? this._renderLoading() : "disabled" === e11 ? this._renderAssociationNotFound() : this._renderContent());
  }
  _renderStickyLoading() {
    return "querying" === this.viewModel.state ? n2("div", { class: g9.stickySpinnerContainer, key: "sticky-loader" }, this._renderLoadingIcon()) : null;
  }
  _renderLoadingIcon() {
    return n2("calcite-loader", { inline: true, label: "" });
  }
  _renderLoading() {
    return n2("div", { class: g9.loadingSpinnerContainer, key: "loading-container" }, this._renderLoadingIcon());
  }
  _renderAssociationNotFound() {
    var _a;
    return n2("calcite-notice", { icon: "exclamation-mark-triangle", key: "association-not-found", kind: "danger", open: true, scale: "s", width: "full" }, n2("div", { slot: "message" }, (_a = this.messages) == null ? void 0 : _a.noAssociations));
  }
  _setupFeatureElementInfo() {
    var _a;
    const { headingLevel: e11, visibleElements: t6 } = this, i11 = t6.description && this.description, s12 = t6.title && this.title;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: i11, title: s12, headingLevel: e11 });
  }
  _getAssociationTypeTitle(e11) {
    const { messages: t6 } = this;
    if (e11.title) return e11.title;
    switch (e11.type) {
      case "attachment":
        return t6.associationsAttachments;
      case "connectivity":
        return t6.associationsConnectivity;
      case "structure":
        return t6.associationsStructure;
      case "content":
        return t6.associationsContents;
      case "container":
        return t6.associationsContainer;
    }
  }
  _selectAssociationType(e11) {
    var _a;
    const { viewModel: t6, flowItems: i11, parentFeatureViewModel: s12 } = this;
    if (!i11) return;
    const { associationTypes: o4 } = t6;
    o4.forEach((t7) => {
      t7.type === e11.type ? t7.open = true : t7.open = false;
    });
    const n11 = new b9({ viewModel: t6, parentFeatureViewModel: s12, listType: e11, title: this._getAssociationTypeTitle(e11), featureVisibleElements: this.featureVisibleElements, description: (_a = this.parentFeatureViewModel) == null ? void 0 : _a.title, flowItems: i11 });
    i11.push(n11);
  }
  _renderAssociationType(e11) {
    const t6 = this._getAssociationTypeTitle(e11);
    return n2("calcite-list-item", { description: e11.description, key: `association-type-${e11.type}`, label: t6, value: e11.type, onCalciteListItemSelect: () => this._selectAssociationType(e11) }, n2("calcite-chip", { scale: "s", slot: "content-end", value: e11.type }, this._getFeatureCount(e11.type)), n2("calcite-icon", { flipRtl: true, icon: "chevron-right", scale: "s", slot: "content-end" }));
  }
  _getFeatureCount(e11) {
    switch (e11) {
      case "attachment":
        return this.viewModel.attachmentsFeatureCount;
      case "structure":
        return this.viewModel.structureFeatureCount;
      case "content":
        return this.viewModel.contentFeatureCount;
      case "container":
        return this.viewModel.containerFeatureCount;
      case "connectivity":
        return this.viewModel.connectivityFeatureCount;
    }
  }
  _renderAssociations(e11) {
    return n2("div", null, this._getFeatureCount(e11.type) > 0 ? this._renderAssociationType(e11) : null);
  }
  _renderContent() {
    const { state: e11, associationTypes: t6 } = this.viewModel;
    return n2("div", { class: this.classes(g9.listContainer, { [g9.listContainerQuerying]: "querying" === e11 }), key: "list-container" }, "ready" === e11 ? n2("calcite-list", null, t6.map((e12) => this._renderAssociations(e12))) : null, this._renderStickyLoading());
  }
};
r([m()], f7.prototype, "flowType", void 0), r([m()], f7.prototype, "flowItems", void 0), r([m()], f7.prototype, "parentFeatureViewModel", void 0), r([m()], f7.prototype, "featureVisibleElements", void 0), r([m()], f7.prototype, "description", null), r([m()], f7.prototype, "headingLevel", void 0), r([m()], f7.prototype, "title", null), r([m({ type: F8 })], f7.prototype, "viewModel", void 0), r([m(), e("esri/widgets/Feature/t9n/Feature")], f7.prototype, "messages", void 0), r([m(), e("esri/t9n/common")], f7.prototype, "messagesCommon", void 0), r([m({ type: i10, nonNullable: true })], f7.prototype, "visibleElements", void 0), f7 = r([a("esri.widgets.Feature.FeatureUtilityNetworkAssociations")], f7);
var _5 = f7;

// node_modules/@arcgis/core/arcade/featureset/support/FeatureSetQueryInterceptor.js
var e9 = class {
  constructor(e11, a5) {
    this.preLayerQueryCallback = e11, this.preRequestCallback = a5, this.preLayerQueryCallback || (this.preLayerQueryCallback = (e12) => {
    }), this.preRequestCallback || (this.preLayerQueryCallback = (e12) => {
    });
  }
};

// node_modules/@arcgis/core/widgets/Feature/FeatureViewModel.js
var X2;
var Y2 = 1;
var $4 = "content-view-models";
var ee2 = "relationship-view-models";
var te2 = "association-view-models";
var ie2 = { attachmentsContent: true, chartAnimation: true, customContent: true, expressionContent: true, fieldsContent: true, mediaContent: true, textContent: true, relationshipContent: true, utilityNetworkAssociationsContent: true };
var oe2 = X2 = class extends s4(b2) {
  constructor(e11) {
    super(e11), this._error = null, this._featureAbortController = null, this._associationVMAbortController = null, this._graphicChangedThrottled = e8(this._graphicChanged, Y2, this), this._expressionAttributes = null, this._graphicExpressionAttributes = null, this.abilities = { ...ie2 }, this.content = null, this.contentViewModels = [], this.description = null, this.defaultPopupTemplateEnabled = false, this.formattedAttributes = null, this.lastEditInfo = null, this.location = null, this.relatedInfos = /* @__PURE__ */ new Map(), this.title = "", this.view = null, this._isAllowedContentType = (e12) => {
      const { abilities: t6 } = this;
      return "attachments" === e12.type && !!t6.attachmentsContent || "custom" === e12.type && !!t6.customContent || "fields" === e12.type && !!t6.fieldsContent || "media" === e12.type && !!t6.mediaContent || "text" === e12.type && !!t6.textContent || "expression" === e12.type && !!t6.expressionContent || "relationship" === e12.type && !!t6.relationshipContent || "utility-network-associations" === e12.type && !!t6.utilityNetworkAssociationsContent;
    }, this.addHandles(d2(() => [this.graphic, this._effectivePopupTemplate, this.abilities, this.timeZone], () => this._graphicChangedThrottled(), P));
  }
  initialize() {
    this.addHandles(this._graphicChangedThrottled);
  }
  destroy() {
    this._clear(), this._cancelFeatureQuery(), this._error = null, this.graphic = null, this._destroyContentViewModels(), this.relatedInfos.clear();
  }
  get _effectivePopupTemplate() {
    return null != this.graphic ? this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled) : null;
  }
  get _fieldInfoMap() {
    return oe(ae(this._effectivePopupTemplate), this._sourceLayer);
  }
  get _sourceLayer() {
    return L(this.graphic);
  }
  castAbilities(e11) {
    return { ...ie2, ...e11 };
  }
  get isTable() {
    var _a;
    return ((_a = this._sourceLayer) == null ? void 0 : _a.isTable) || false;
  }
  get state() {
    return this.graphic ? this._error ? "error" : this.waitingForContent ? "loading" : "ready" : "disabled";
  }
  set graphic(e11) {
    this._featureAbortController = new AbortController(), this._set("graphic", (e11 == null ? void 0 : e11.clone()) ?? null);
  }
  get spatialReference() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.spatialReference) ?? null;
  }
  set spatialReference(e11) {
    this._override("spatialReference", e11);
  }
  get timeZone() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.timeZone) ?? o;
  }
  set timeZone(e11) {
    this._overrideIfSome("timeZone", e11);
  }
  get map() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.map) || null;
  }
  set map(e11) {
    this._override("map", e11);
  }
  get waitingForContent() {
    return !(!this._featureAbortController && !this._associationVMAbortController);
  }
  setActiveMedia(e11, t6) {
    const i11 = this.contentViewModels[e11];
    i11 instanceof M3 && i11.setActiveMedia(t6);
  }
  nextMedia(e11) {
    const t6 = this.contentViewModels[e11];
    t6 instanceof M3 && t6.next();
  }
  previousMedia(e11) {
    const t6 = this.contentViewModels[e11];
    t6 instanceof M3 && t6.previous();
  }
  async updateGeometry() {
    var _a;
    const { graphic: e11, spatialReference: t6, _sourceLayer: i11 } = this;
    await (i11 == null ? void 0 : i11.load());
    const o4 = i11 == null ? void 0 : i11.objectIdField;
    if (!o4 || !e11 || !i11) return;
    const r9 = (_a = e11 == null ? void 0 : e11.attributes) == null ? void 0 : _a[o4];
    if (null == r9) return;
    const s12 = [r9];
    if (!e11.geometry) {
      const o5 = await ce({ layer: i11, graphic: e11, outFields: [], objectIds: s12, returnGeometry: true, spatialReference: t6 }), r10 = o5 == null ? void 0 : o5.geometry;
      r10 && (e11.geometry = r10);
    }
  }
  _clear() {
    this._set("title", ""), this._set("content", null), this._set("formattedAttributes", null);
  }
  async _graphicChanged() {
    this._cancelFeatureQuery(), this._error = null, this._clear();
    const { graphic: e11 } = this;
    if (!e11) return;
    const t6 = new AbortController();
    this._featureAbortController = t6;
    try {
      await this._queryFeature({ signal: t6.signal });
    } catch (i11) {
      b(i11) || (this._error = i11, n.getLogger(this).error("error", "The popupTemplate could not be displayed for this feature.", { error: i11, graphic: e11, popupTemplate: this._effectivePopupTemplate }));
    }
    this._featureAbortController === t6 && (this._featureAbortController = null);
  }
  _cancelFeatureQuery() {
    const { _featureAbortController: e11 } = this;
    e11 && e11.abort(), this._featureAbortController = null;
  }
  _compileContentElement(e11, t6) {
    return "attachments" === e11.type ? this._compileAttachments(e11, t6) : "custom" === e11.type ? this._compileCustom(e11, t6) : "fields" === e11.type ? this._compileFields(e11, t6) : "media" === e11.type ? this._compileMedia(e11, t6) : "text" === e11.type ? this._compileText(e11, t6) : "expression" === e11.type ? this._compileExpression(e11, t6) : "relationship" === e11.type ? this._compileRelationship(e11, t6) : "utility-network-associations" === e11.type ? this._compileUtilityNetworkAssociation(e11, t6) : void 0;
  }
  _compileContent(e11) {
    if (this._destroyContentViewModels(), this.graphic) return Array.isArray(e11) ? e11.filter(this._isAllowedContentType).map((e12, t6) => this._compileContentElement(e12, t6)).filter(F) : "string" == typeof e11 ? this._compileText(new c2({ text: e11 }), 0).text : e11;
  }
  _destroyContentViewModels() {
    this.removeHandles(ee2), this.removeHandles($4), this.contentViewModels.forEach((e11) => e11 && !e11.destroyed && e11.destroy()), this._set("contentViewModels", []);
  }
  _matchesFeature(e11, t6) {
    var _a;
    const i11 = (_a = e11 == null ? void 0 : e11.graphic) == null ? void 0 : _a.getObjectId(), o4 = t6 == null ? void 0 : t6.getObjectId();
    return null != i11 && null != o4 && i11 === o4;
  }
  _setRelatedFeaturesViewModels({ relatedFeatureViewModels: e11, relatedFeatures: t6, map: i11 }) {
    const { view: o4, spatialReference: r9, timeZone: s12 } = this;
    t6 == null ? void 0 : t6.filter(Boolean).forEach((t7) => {
      e11.some((e12) => this._matchesFeature(e12, t7)) || e11.add(new X2({ abilities: { relationshipContent: false }, map: i11, view: o4, spatialReference: r9, timeZone: s12, graphic: t7 }));
    }), e11.forEach((i12) => {
      const o5 = t6 == null ? void 0 : t6.find((e12) => this._matchesFeature(i12, e12));
      o5 || e11.remove(i12);
    });
  }
  _setExpressionContentVM(e11, t6) {
    const i11 = this.formattedAttributes, { contentElement: o4, contentElementViewModel: r9 } = e11, s12 = o4 == null ? void 0 : o4.type;
    r9 && s12 && ("fields" === s12 && (this._createFieldsFormattedAttributes({ contentElement: o4, contentElementIndex: t6, formattedAttributes: i11 }), r9.set(this._createFieldsVMParams(o4, t6))), "media" === s12 && (this._createMediaFormattedAttributes({ contentElement: o4, contentElementIndex: t6, formattedAttributes: i11 }), r9.set(this._createMediaVMParams(o4, t6))), "text" === s12 && r9.set(this._createTextVMParams(o4)));
  }
  _compileRelationship(e11, t6) {
    const { displayCount: i11, orderByFields: o4, relationshipId: r9, title: s12, description: n11 } = e11, { _sourceLayer: a5, graphic: l9, map: c14 } = this;
    if (!K(a5)) return;
    const p12 = new F6({ displayCount: i11, graphic: l9, orderByFields: o4, relationshipId: r9, layer: a5, map: c14, ...this._compileTitleAndDesc({ title: s12, description: n11 }) });
    return this.contentViewModels[t6] = p12, this.addHandles(v(() => p12.relatedFeatures, "change", () => this._setRelatedFeaturesViewModels(p12)), ee2), e11;
  }
  _matchesGlobalFeature(e11, t6) {
    const i11 = e11 == null ? void 0 : e11.association.globalId, o4 = t6 == null ? void 0 : t6.association.globalId;
    return null != i11 && null != o4 && i11 === o4;
  }
  async _setUpUtilityNetworkAssociationsViewModels(e11, t6, i11) {
    const { view: o4, spatialReference: r9, timeZone: n11 } = this;
    e11.forEach((i12, o5) => {
      const r10 = t6.get(o5);
      r10 ? i12.forEach((t7) => {
        r10.find((e12) => this._matchesGlobalFeature(t7, e12)) || (i12.remove(t7), 0 === i12.length && e11.delete(o5));
      }) : (i12.removeAll(), e11.delete(o5));
    }), t6.forEach((t7, a6) => {
      const l9 = e11.get(a6) || new V();
      t7 == null ? void 0 : t7.filter(Boolean).forEach((e12) => {
        l9.some((t8) => this._matchesGlobalFeature(t8, e12)) || l9.add({ association: e12.association, featureViewModel: new X2({ abilities: { utilityNetworkAssociationsContent: false }, map: i11, view: o4, spatialReference: r9, timeZone: n11, graphic: e12.feature }), terminalName: e12.terminalName });
      }), e11.set(a6, l9);
    });
    const a5 = new AbortController();
    this._associationVMAbortController = a5, await this._sortListObjectsByTitle(e11, { signal: a5.signal }), this._associationVMAbortController === a5 && (this._associationVMAbortController = null);
  }
  async _sortListObjectsByTitle(e11, t6) {
    for (const i11 of e11.values()) {
      const e12 = i11.map((e13) => w(() => "ready" === e13.featureViewModel.state, t6 == null ? void 0 : t6.signal));
      await Promise.all(e12), i11.sort(this._compareByFeatureTitle);
    }
  }
  _compareByFeatureTitle(e11, t6) {
    const i11 = c4(e11.featureViewModel), o4 = c4(t6.featureViewModel);
    return i11.localeCompare(o4, void 0, { numeric: true });
  }
  _compileUtilityNetworkAssociation(e11, t6) {
    const { title: i11, description: o4, associationTypes: r9 } = e11, { _sourceLayer: s12, graphic: n11, map: a5 } = this;
    if (!V2(s12)) return;
    const l9 = new F8({ graphic: n11, associationTypes: r9, layer: s12, map: a5, ...this._compileTitleAndDesc({ title: i11, description: o4 }) });
    return this.contentViewModels[t6] = l9, this.addHandles([d2(() => l9.associationFeatures.values(), () => this._setUpUtilityNetworkAssociationsViewModels(l9.associationViewModels, l9.associationFeatures, l9.map))], te2), e11;
  }
  _compileExpression(e11, t6) {
    const { expressionInfo: i11 } = e11, { graphic: o4, map: r9, spatialReference: s12, view: n11, location: a5 } = this, l9 = new C3({ expressionInfo: i11, graphic: o4, interceptor: X2.interceptor, map: r9, spatialReference: s12, view: n11, location: a5 });
    return this.contentViewModels[t6] = l9, this.addHandles(d2(() => l9.contentElementViewModel, () => this._setExpressionContentVM(l9, t6), P), $4), e11;
  }
  _compileAttachments(e11, t6) {
    const { graphic: i11 } = this, { description: o4, title: r9 } = e11;
    return this.contentViewModels[t6] = new c5({ graphic: i11, ...this._compileTitleAndDesc({ title: r9, description: o4 }) }), e11;
  }
  _compileCustom(e11, t6) {
    const { graphic: i11 } = this, { creator: o4, destroyer: r9 } = e11;
    return this.contentViewModels[t6] = new p7({ graphic: i11, creator: o4, destroyer: r9 }), e11;
  }
  _compileTitleAndDesc({ title: e11, description: t6 }) {
    const { _fieldInfoMap: i11, _sourceLayer: o4, graphic: r9, formattedAttributes: s12 } = this, n11 = r9 == null ? void 0 : r9.attributes, a5 = this._expressionAttributes, l9 = s12.global;
    return { title: D({ attributes: n11, fieldInfoMap: i11, globalAttributes: l9, expressionAttributes: a5, layer: o4, text: e11 }), description: D({ attributes: n11, fieldInfoMap: i11, globalAttributes: l9, expressionAttributes: a5, layer: o4, text: t6 }) };
  }
  _createFieldsVMParams(e11, t6) {
    const i11 = this._effectivePopupTemplate, o4 = this.formattedAttributes, r9 = { ...o4 == null ? void 0 : o4.global, ...o4 == null ? void 0 : o4.content[t6] }, s12 = (e11 == null ? void 0 : e11.fieldInfos) || (i11 == null ? void 0 : i11.fieldInfos), n11 = s12 == null ? void 0 : s12.filter(({ fieldName: e12 }) => !!e12 && (x(e12) || ye(e12) || r9.hasOwnProperty(e12))), a5 = i11 == null ? void 0 : i11.expressionInfos, { description: l9, title: c14 } = e11;
    return { attributes: r9, expressionInfos: a5, fieldInfos: n11, ...this._compileTitleAndDesc({ title: c14, description: l9 }) };
  }
  _compileFields(e11, t6) {
    const i11 = e11.clone(), o4 = new n8(this._createFieldsVMParams(e11, t6));
    return this.contentViewModels[t6] = o4, i11.fieldInfos = o4.formattedFieldInfos.slice(), i11;
  }
  _createMediaVMParams(e11, t6) {
    const { abilities: i11, graphic: o4, _fieldInfoMap: r9, _effectivePopupTemplate: s12, relatedInfos: n11, _sourceLayer: a5, _expressionAttributes: l9 } = this, c14 = this.formattedAttributes, p12 = (o4 == null ? void 0 : o4.attributes) ?? {}, { description: d10, mediaInfos: u9, title: h10 } = e11;
    return { abilities: { chartAnimation: i11.chartAnimation }, activeMediaInfoIndex: e11.activeMediaInfoIndex || 0, attributes: p12, isAggregate: o4 == null ? void 0 : o4.isAggregate, layer: a5, fieldInfoMap: r9, formattedAttributes: { ...c14 == null ? void 0 : c14.global, ...c14 == null ? void 0 : c14.content[t6] }, expressionAttributes: l9, mediaInfos: u9, popupTemplate: s12, relatedInfos: n11, ...this._compileTitleAndDesc({ title: h10, description: d10 }) };
  }
  _compileMedia(e11, t6) {
    const i11 = e11.clone(), o4 = new M3(this._createMediaVMParams(e11, t6));
    return i11.mediaInfos = o4.formattedMediaInfos.slice(), this.contentViewModels[t6] = o4, i11;
  }
  _createTextVMParams(e11) {
    var _a;
    const { graphic: t6, _fieldInfoMap: i11, _sourceLayer: o4, _expressionAttributes: r9 } = this;
    if (e11 && e11.text) {
      const s12 = (t6 == null ? void 0 : t6.attributes) ?? {}, n11 = ((_a = this.formattedAttributes) == null ? void 0 : _a.global) ?? {};
      e11.text = D({ attributes: s12, fieldInfoMap: i11, globalAttributes: n11, expressionAttributes: r9, layer: o4, text: e11.text });
    }
    return { graphic: t6, creator: e11.text };
  }
  _compileText(e11, t6) {
    const i11 = e11.clone();
    return this.contentViewModels[t6] = new p7(this._createTextVMParams(i11)), i11;
  }
  _compileLastEditInfo() {
    const { _effectivePopupTemplate: e11, _sourceLayer: t6, graphic: i11, timeZone: o4 } = this;
    if (!e11) return;
    const { lastEditInfoEnabled: r9 } = e11, s12 = t6 == null ? void 0 : t6.editFieldsInfo;
    return r9 && s12 ? ie(s12, i11 == null ? void 0 : i11.attributes, o4, t6) : void 0;
  }
  _compileTitle(e11) {
    var _a;
    const { _fieldInfoMap: t6, _sourceLayer: i11, graphic: o4, _expressionAttributes: r9 } = this, s12 = (o4 == null ? void 0 : o4.attributes) ?? {}, n11 = ((_a = this.formattedAttributes) == null ? void 0 : _a.global) ?? {};
    return D({ attributes: s12, fieldInfoMap: t6, globalAttributes: n11, expressionAttributes: r9, layer: i11, text: e11 });
  }
  async _getTitle() {
    const { _effectivePopupTemplate: e11, graphic: t6 } = this;
    return t6 ? E2({ type: "title", value: e11 == null ? void 0 : e11.title, event: { graphic: t6 } }) : null;
  }
  async _getContent() {
    const { _effectivePopupTemplate: e11, graphic: t6 } = this;
    return t6 ? E2({ type: "content", value: e11 == null ? void 0 : e11.content, event: { graphic: t6 } }) : null;
  }
  async _queryFeature(e11) {
    const { _featureAbortController: t6, _sourceLayer: i11, graphic: o4, _effectivePopupTemplate: r9 } = this, s12 = this.map, n11 = this.view, a5 = this.spatialReference, l9 = this.location;
    if (t6 !== this._featureAbortController || !o4) return;
    await pe2({ graphic: o4, popupTemplate: r9, layer: i11, spatialReference: a5 }, e11);
    const { content: { value: p12 }, title: { value: d10 } } = await y({ content: this._getContent(), title: this._getTitle() }), { expressionAttributes: { value: u9 } } = await y({ checkForRelatedFeatures: this._checkForRelatedFeatures(e11), expressionAttributes: w8({ expressionInfos: r9 == null ? void 0 : r9.expressionInfos, spatialReference: a5, graphic: o4, map: s12, interceptor: X2.interceptor, view: n11, options: e11, location: l9 }) });
    t6 === this._featureAbortController && o4 && (this._expressionAttributes = u9, this._graphicExpressionAttributes = { ...o4.attributes, ...u9 }, this._set("formattedAttributes", this._createFormattedAttributes(p12)), this._set("title", this._compileTitle(d10)), this._set("lastEditInfo", this._compileLastEditInfo() || null), this._set("content", this._compileContent(p12) || null));
  }
  _createMediaFormattedAttributes({ contentElement: e11, contentElementIndex: t6, formattedAttributes: i11 }) {
    const { _effectivePopupTemplate: o4, graphic: r9, relatedInfos: s12, _sourceLayer: n11, _fieldInfoMap: a5, _graphicExpressionAttributes: l9, timeZone: c14 } = this;
    i11.content[t6] = fe({ fieldInfos: o4 == null ? void 0 : o4.fieldInfos, graphic: r9, attributes: { ...l9, ...e11.attributes }, layer: n11, fieldInfoMap: a5, relatedInfos: s12, timeZone: c14 });
  }
  _createFieldsFormattedAttributes({ contentElement: e11, contentElementIndex: t6, formattedAttributes: i11 }) {
    if (e11.fieldInfos) {
      const { graphic: o4, relatedInfos: r9, _sourceLayer: s12, _fieldInfoMap: n11, _graphicExpressionAttributes: a5, timeZone: l9 } = this;
      i11.content[t6] = fe({ fieldInfos: e11.fieldInfos, graphic: o4, attributes: { ...a5, ...e11.attributes }, layer: s12, fieldInfoMap: n11, relatedInfos: r9, timeZone: l9 });
    }
  }
  _createFormattedAttributes(e11) {
    const { _effectivePopupTemplate: t6, graphic: i11, relatedInfos: o4, _sourceLayer: r9, _fieldInfoMap: s12, _graphicExpressionAttributes: n11, timeZone: a5 } = this, l9 = t6 == null ? void 0 : t6.fieldInfos, c14 = { global: fe({ fieldInfos: l9, graphic: i11, attributes: n11, layer: r9, fieldInfoMap: s12, relatedInfos: o4, timeZone: a5 }), content: [] };
    return Array.isArray(e11) && e11.forEach((e12, t7) => {
      "fields" === e12.type && this._createFieldsFormattedAttributes({ contentElement: e12, contentElementIndex: t7, formattedAttributes: c14 }), "media" === e12.type && this._createMediaFormattedAttributes({ contentElement: e12, contentElementIndex: t7, formattedAttributes: c14 });
    }), c14;
  }
  _checkForRelatedFeatures(e11) {
    const { graphic: t6, _effectivePopupTemplate: i11 } = this;
    return this._queryRelatedInfos(t6, ae(i11), e11);
  }
  async _queryRelatedInfos(e11, t6, i11) {
    const { relatedInfos: o4, _sourceLayer: r9 } = this;
    o4.clear();
    const s12 = null != (r9 == null ? void 0 : r9.associatedLayer) ? await (r9 == null ? void 0 : r9.associatedLayer.load(i11)) : r9;
    if (!s12 || !e11) return;
    const n11 = t6.filter((e12) => !!e12.fieldName && ye(e12.fieldName));
    if (!(n11 == null ? void 0 : n11.length)) return;
    t6.forEach((e12) => this._configureRelatedInfo(e12, s12));
    const a5 = await v5({ relatedInfos: o4, layer: s12 }, i11);
    Object.keys(a5).forEach((e12) => {
      var _a;
      const t7 = o4.get(e12.toString()), i12 = (_a = a5[e12]) == null ? void 0 : _a.value;
      t7 && i12 && (t7.layerInfo = i12.data);
    });
    const l9 = await T3({ graphic: e11, relatedInfos: o4, layer: s12 }, i11);
    Object.keys(l9).forEach((e12) => {
      var _a;
      S2((_a = l9[e12]) == null ? void 0 : _a.value, o4.get(e12.toString()));
    });
  }
  _configureRelatedInfo(e11, t6) {
    const { relatedInfos: i11 } = this, o4 = h7(e11.fieldName || "");
    if (!o4) return;
    const { layerId: r9, fieldName: s12 } = o4;
    if (!r9) return;
    const n11 = i11.get(r9.toString()) || g2(r9, t6);
    n11 && (q2({ relatedInfo: n11, fieldName: s12, fieldInfo: e11 }), this.relatedInfos.set(r9, n11));
  }
};
oe2.interceptor = new e9(Te, we), r([m()], oe2.prototype, "_error", void 0), r([m()], oe2.prototype, "_featureAbortController", void 0), r([m()], oe2.prototype, "_associationVMAbortController", void 0), r([m({ readOnly: true })], oe2.prototype, "_effectivePopupTemplate", null), r([m({ readOnly: true })], oe2.prototype, "_fieldInfoMap", null), r([m({ readOnly: true })], oe2.prototype, "_sourceLayer", null), r([m()], oe2.prototype, "abilities", void 0), r([s3("abilities")], oe2.prototype, "castAbilities", null), r([m({ readOnly: true })], oe2.prototype, "content", void 0), r([m({ readOnly: true })], oe2.prototype, "contentViewModels", void 0), r([m()], oe2.prototype, "description", void 0), r([m({ type: Boolean })], oe2.prototype, "defaultPopupTemplateEnabled", void 0), r([m({ readOnly: true })], oe2.prototype, "isTable", null), r([m({ readOnly: true })], oe2.prototype, "state", null), r([m({ readOnly: true })], oe2.prototype, "formattedAttributes", void 0), r([m({ type: d3, value: null })], oe2.prototype, "graphic", null), r([m({ readOnly: true })], oe2.prototype, "lastEditInfo", void 0), r([m({ type: j2 })], oe2.prototype, "location", void 0), r([m({ readOnly: true })], oe2.prototype, "relatedInfos", void 0), r([m()], oe2.prototype, "spatialReference", null), r([m()], oe2.prototype, "timeZone", null), r([m({ readOnly: true })], oe2.prototype, "title", void 0), r([m()], oe2.prototype, "map", null), r([m({ readOnly: true })], oe2.prototype, "waitingForContent", null), r([m()], oe2.prototype, "view", void 0), oe2 = X2 = r([a("esri.widgets.Feature.FeatureViewModel")], oe2);
var re2 = oe2;

// node_modules/@arcgis/core/widgets/Feature/resources.js
var e10 = "esri-feature";
var t5 = { base: e10, container: `${e10}__size-container`, title: `${e10}__title`, main: `${e10}__main-container`, btn: `${e10}__button`, icon: `${e10}__icon`, content: `${e10}__content`, contentNode: `${e10}__content-node`, contentNodeText: `${e10}__content-node--text`, contentElement: `${e10}__content-element`, text: `${e10}__text`, lastEditedInfo: `${e10}__last-edited-info`, fields: `${e10}__fields`, fieldHeader: `${e10}__field-header`, fieldData: `${e10}__field-data`, fieldDataDate: `${e10}__field-data--date`, loadingSpinnerContainer: `${e10}__loading-container` };

// node_modules/@arcgis/core/widgets/Feature/support/FeatureContentMixin.js
var n10 = (n11) => {
  let i11 = class extends n11 {
    constructor() {
      super(...arguments), this.renderNodeContent = (e11) => e7(e11) && !e11.destroyed ? n2("div", { class: t5.contentNode, key: e11 }, e11.render()) : e11 instanceof HTMLElement ? n2("div", { afterCreate: this._attachToNode, bind: e11, class: t5.contentNode, key: e11 }) : t3(e11) ? n2("div", { afterCreate: this._attachToNode, bind: e11.domNode, class: t5.contentNode, key: e11 }) : null;
    }
    _attachToNode(e11) {
      const o4 = this;
      e11.appendChild(o4);
    }
  };
  return i11 = r([a("esri.widgets.Feature.support.FeatureContentMixin")], i11), i11;
};

// node_modules/@arcgis/core/widgets/Feature.js
var b10 = { title: true, content: true, lastEditedInfo: true };
var j8 = class extends n10(B) {
  constructor(e11, t6) {
    super(e11, t6), this._contentWidgets = [], this.flowType = "feature", this.flowItems = null, this.headingLevel = 2, this.messages = null, this.messagesCommon = null, this.visibleElements = { ...b10 }, this.viewModel = new re2();
  }
  initialize() {
    this.addHandles(d2(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.contentViewModels;
    }, () => this._setupContentWidgets(), P));
  }
  loadDependencies() {
    return r4({ notice: () => import("./calcite-notice-QIIO24YX.js"), loader: () => import("./calcite-loader-GZNTWKUG.js") });
  }
  destroy() {
    this._destroyContentWidgets();
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(e11) {
    this.viewModel.graphic = e11;
  }
  get defaultPopupTemplateEnabled() {
    return this.viewModel.defaultPopupTemplateEnabled;
  }
  set defaultPopupTemplateEnabled(e11) {
    this.viewModel.defaultPopupTemplateEnabled = e11;
  }
  get isTable() {
    return this.viewModel.isTable;
  }
  get icon() {
    return "polygon";
  }
  set icon(e11) {
    this._overrideIfSome("icon", e11);
  }
  get label() {
    var _a;
    return ((_a = this.messages) == null ? void 0 : _a.widgetLabel) ?? "";
  }
  set label(e11) {
    this._overrideIfSome("label", e11);
  }
  get location() {
    return this.viewModel.location;
  }
  set location(e11) {
    this.viewModel.location = e11;
  }
  get spatialReference() {
    return this.viewModel.spatialReference;
  }
  set spatialReference(e11) {
    this.viewModel.spatialReference = e11;
  }
  get timeZone() {
    return this.viewModel.timeZone;
  }
  set timeZone(e11) {
    this.viewModel.timeZone = e11;
  }
  get title() {
    return this.viewModel.title;
  }
  castVisibleElements(e11) {
    return { ...b10, ...e11 };
  }
  get map() {
    return this.viewModel.map;
  }
  set map(e11) {
    this.viewModel.map = e11;
  }
  get view() {
    return this.viewModel.view;
  }
  set view(e11) {
    this.viewModel.view = e11;
  }
  setActiveMedia(e11, t6) {
    return this.viewModel.setActiveMedia(e11, t6);
  }
  nextMedia(e11) {
    return this.viewModel.nextMedia(e11);
  }
  previousMedia(e11) {
    return this.viewModel.previousMedia(e11);
  }
  render() {
    const { state: e11 } = this.viewModel, t6 = n2("div", { class: t5.container, key: "container" }, this._renderTitle(), "error" === e11 ? this._renderError() : "loading" === e11 ? this._renderLoading() : this._renderContentContainer());
    return n2("div", { class: this.classes(t5.base, e2.widget) }, t6);
  }
  _renderError() {
    const { messagesCommon: e11, messages: t6, visibleElements: s12 } = this;
    return n2("calcite-notice", { icon: "exclamation-mark-circle", kind: "danger", open: true, scale: "s" }, s12.title ? n2("div", { key: "error-title", slot: "title" }, e11.errorMessage) : null, n2("div", { key: "error-message", slot: "message" }, t6.loadingError));
  }
  _renderLoading() {
    return n2("div", { class: t5.loadingSpinnerContainer, key: "loading-container" }, n2("calcite-loader", { inline: true, label: "" }));
  }
  _renderContentContainer() {
    const { visibleElements: e11 } = this;
    return e11.content ? n2("div", { class: t5.main }, [this._renderContent(), this._renderLastEditInfo()]) : null;
  }
  _renderTitle() {
    const { visibleElements: e11, title: t6 } = this;
    return e11.title ? n2(e5, { class: t5.title, innerHTML: t6, level: this.headingLevel }) : null;
  }
  _renderContent() {
    const e11 = this.viewModel.content, t6 = "content";
    if (!e11) return null;
    if (Array.isArray(e11)) return e11.length ? n2("div", { class: t5.contentNode, key: `${t6}-content-elements` }, e11.map(this._renderContentElement, this)) : null;
    if ("string" == typeof e11) {
      const e12 = this._contentWidgets[0];
      return !e12 || e12.destroyed ? null : n2("div", { class: this.classes(t5.contentNode, t5.contentNodeText), key: `${t6}-content` }, e12.render());
    }
    return this.renderNodeContent(e11);
  }
  _renderContentElement(e11, t6) {
    var _a;
    const { visibleElements: s12 } = this;
    if ("boolean" != typeof s12.content && !((_a = s12.content) == null ? void 0 : _a[e11.type])) return null;
    switch (e11.type) {
      case "attachments":
        return this._renderAttachments(t6);
      case "custom":
        return this._renderCustom(e11, t6);
      case "fields":
        return this._renderFields(t6);
      case "media":
        return this._renderMedia(t6);
      case "text":
        return this._renderText(e11, t6);
      case "expression":
        return this._renderExpression(t6);
      case "relationship":
        return this._renderRelationship(t6);
      case "utility-network-associations":
        return this._renderAssociation(t6);
      default:
        return null;
    }
  }
  _renderAttachments(e11) {
    const t6 = this._contentWidgets[e11];
    if (!t6 || t6.destroyed) return null;
    const { state: s12, attachmentInfos: i11 } = t6.viewModel;
    return "loading" === s12 || i11.length > 0 ? n2("div", { class: this.classes(t5.contentElement), key: this._buildKey("attachments-element", e11) }, t6.render()) : null;
  }
  _renderRelationship(e11) {
    const t6 = this._contentWidgets[e11];
    return t6 && !t6.destroyed && this.flowItems ? n2("div", { class: t5.contentElement, key: this._buildKey("relationship-element", e11) }, t6.render()) : null;
  }
  _renderAssociation(e11) {
    const t6 = this._contentWidgets[e11];
    return t6 && !t6.destroyed && this.flowItems ? n2("div", { class: t5.contentElement, key: this._buildKey("utility-network-association-element", e11) }, t6.render()) : null;
  }
  _renderExpression(e11) {
    const t6 = this._contentWidgets[e11];
    return t6 && !t6.destroyed && t6.viewModel.contentElement ? n2("div", { class: t5.contentElement, key: this._buildKey("expression-element", e11) }, t6.render()) : null;
  }
  _renderCustom(e11, t6) {
    const { creator: s12 } = e11, i11 = this._contentWidgets[t6];
    return !i11 || i11.destroyed ? null : s12 ? n2("div", { class: t5.contentElement, key: this._buildKey("custom-element", t6) }, i11.render()) : null;
  }
  _renderFields(e11) {
    const t6 = this._contentWidgets[e11];
    return !t6 || t6.destroyed ? null : n2("div", { class: t5.contentElement, key: this._buildKey("fields-element", e11) }, t6.render());
  }
  _renderMedia(e11) {
    const t6 = this._contentWidgets[e11];
    return !t6 || t6.destroyed ? null : n2("div", { class: t5.contentElement, key: this._buildKey("media-element", e11) }, t6.render());
  }
  _renderLastEditInfo() {
    const { visibleElements: e11, messages: t6 } = this, { lastEditInfo: s12 } = this.viewModel;
    if (!s12 || !e11.lastEditedInfo) return null;
    const { date: i11, user: n11 } = s12, o4 = "edit" === s12.type ? n11 ? t6.lastEditedByUser : t6.lastEdited : n11 ? t6.lastCreatedByUser : t6.lastCreated, r9 = s2(o4, { date: i11, user: n11 });
    return n2("div", { class: this.classes(t5.lastEditedInfo, t5.contentElement), key: "edit-info-element" }, r9);
  }
  _renderText(e11, t6) {
    const s12 = e11.text, i11 = this._contentWidgets[t6];
    return !i11 || i11.destroyed ? null : s12 ? n2("div", { class: this.classes(t5.contentElement, t5.text), key: this._buildKey("text-element", t6) }, i11.render()) : null;
  }
  _buildKey(e11, ...t6) {
    var _a, _b;
    return `${e11}__${((_b = (_a = this.viewModel) == null ? void 0 : _a.graphic) == null ? void 0 : _b.uid) || "0"}-${t6.join("-")}`;
  }
  _destroyContentWidget(e11) {
    e11 && (e11.viewModel = null, !e11.destroyed && e11.destroy());
  }
  _destroyContentWidgets() {
    this._contentWidgets.forEach((e11) => this._destroyContentWidget(e11)), this._contentWidgets = [];
  }
  _setupContentWidgets() {
    this._destroyContentWidgets();
    const { headingLevel: e11, visibleElements: t6, flowItems: s12, viewModel: i11 } = this, n11 = i11 == null ? void 0 : i11.content, { contentViewModels: o4 } = i11;
    if (Array.isArray(n11)) n11.forEach((n12, r9) => {
      if ("attachments" === n12.type && (this._contentWidgets[r9] = new c7({ displayType: n12.displayType, headingLevel: t6.title && e11 < 6 ? e11 + 1 : e11, viewModel: o4[r9] })), "fields" === n12.type && (this._contentWidgets[r9] = new h6({ viewModel: o4[r9] })), "media" === n12.type && (this._contentWidgets[r9] = new b6({ viewModel: o4[r9] })), "text" === n12.type && (this._contentWidgets[r9] = new p9({ viewModel: o4[r9] })), "custom" === n12.type && (this._contentWidgets[r9] = new p9({ viewModel: o4[r9] })), "expression" === n12.type && (this._contentWidgets[r9] = new h8({ viewModel: o4[r9] })), "relationship" === n12.type) {
        const e12 = new M5({ flowItems: s12, featureVisibleElements: t6, viewModel: o4[r9] });
        this._contentWidgets[r9] = e12;
      }
      if ("utility-network-associations" === n12.type) {
        const e12 = new _5({ flowItems: s12, parentFeatureViewModel: i11, featureVisibleElements: t6, viewModel: o4[r9] });
        this._contentWidgets[r9] = e12;
      }
    }, this);
    else {
      const e12 = o4[0];
      e12 && !e12.destroyed && (this._contentWidgets[0] = new p9({ viewModel: e12 }));
    }
    this.scheduleRender();
  }
};
r([m()], j8.prototype, "flowType", void 0), r([m()], j8.prototype, "graphic", null), r([m()], j8.prototype, "defaultPopupTemplateEnabled", null), r([m()], j8.prototype, "flowItems", void 0), r([m()], j8.prototype, "headingLevel", void 0), r([m({ readOnly: true })], j8.prototype, "isTable", null), r([m()], j8.prototype, "icon", null), r([m()], j8.prototype, "label", null), r([m()], j8.prototype, "location", null), r([m(), e("esri/widgets/Feature/t9n/Feature")], j8.prototype, "messages", void 0), r([m(), e("esri/t9n/common")], j8.prototype, "messagesCommon", void 0), r([m()], j8.prototype, "spatialReference", null), r([m()], j8.prototype, "timeZone", null), r([m({ readOnly: true })], j8.prototype, "title", null), r([m()], j8.prototype, "visibleElements", void 0), r([s3("visibleElements")], j8.prototype, "castVisibleElements", null), r([m()], j8.prototype, "map", null), r([m()], j8.prototype, "view", null), r([m({ type: re2 })], j8.prototype, "viewModel", void 0), j8 = r([a("esri.widgets.Feature")], j8);
var W = j8;

export {
  e8 as e,
  i9 as i,
  e5 as e2,
  e6 as e3,
  re2 as re,
  t5 as t,
  n10 as n,
  W
};
//# sourceMappingURL=chunk-WAQ2KJ42.js.map
