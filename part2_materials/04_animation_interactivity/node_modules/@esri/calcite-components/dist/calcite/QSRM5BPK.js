/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.0.3 */
import{a as $,b as u}from"./35N5CZK3.js";import{a as g,b as n,c as h,h as r,j as m,k as v,m as A,n as o,p as D}from"./FWYDKVOD.js";import{k as z,l as k}from"./DWSKOILM.js";import"./DFFLO6RQ.js";import{a as b}from"./HHWADIGN.js";import{n as E}from"./SXYTJEOC.js";import{b as C}from"./H6E5FODU.js";import"./B4YIOD3M.js";import{G as R,J as f,e as p,f as x,v as d,w as S}from"./74XIV7EB.js";var w=2,M={dateStyle:"full"},P=p`:host{box-sizing:border-box;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-2);font-size:var(--calcite-font-size--1)}:host *{box-sizing:border-box}:host{display:inline-block;inline-size:100%;overflow:visible;border-width:1px;border-style:solid;vertical-align:top;border-color:var(--calcite-date-picker-border-color, var(--calcite-color-border-1));border-radius:var(--calcite-date-picker-corner-radius, 0)}:host([scale=s]){inline-size:236px;min-inline-size:216px;max-inline-size:380px}:host([scale=s][range][layout=horizontal]){inline-size:480px;min-inline-size:432px;max-inline-size:772px}:host([scale=m]){inline-size:298px;min-inline-size:272px;max-inline-size:480px}:host([scale=m][range][layout=horizontal]){inline-size:608px;min-inline-size:544px;max-inline-size:972px}:host([scale=l]){inline-size:334px;min-inline-size:320px;max-inline-size:600px}:host([scale=l][range][layout=horizontal]){inline-size:684px;min-inline-size:640px;max-inline-size:1212px}:host([hidden]){display:none}[hidden]{display:none}`,y=class extends S{constructor(){super(),this.rangeValueChangedByUser=!1,this.layout="horizontal",this.messages=b({blocking:!0}),this.monthStyle="wide",this.proximitySelectionDisabled=!1,this.range=!1,this.scale="m",this.calciteDatePickerChange=d({cancelable:!1}),this.calciteDatePickerRangeChange=d({cancelable:!1}),this.listen("keydown",this.keyDownHandler)}static{this.properties={activeEndDate:16,activeStartDate:16,dateTimeFormat:16,endAsDate:16,hoverRange:16,localeData:16,startAsDate:16,activeDate:0,activeRange:3,headingLevel:11,layout:3,max:3,maxAsDate:0,messageOverrides:0,min:3,minAsDate:0,monthStyle:1,numberingSystem:3,proximitySelectionDisabled:7,range:7,scale:3,value:1,valueAsDate:0}}static{this.shadowRootOptions={mode:"open",delegatesFocus:!0}}static{this.styles=P}async reset(){this.resetActiveDates(),this.rangeValueChangedByUser=!1}async setFocus(){await C(this),E(this.el)}connectedCallback(){super.connectedCallback(),Array.isArray(this.value)?this.valueAsDate=u(this.value):this.value&&(this.valueAsDate=h(this.value)),this.min&&(this.minAsDate=h(this.min)),this.max&&(this.maxAsDate=h(this.max)),this.setActiveStartAndEndDates()}async load(){await this.loadLocaleData(),this.onMinChanged(this.min),this.onMaxChanged(this.max)}willUpdate(t){t.has("activeDate")&&this.activeDateWatcher(this.activeDate),t.has("value")&&this.valueHandler(this.value),t.has("valueAsDate")&&this.valueAsDateWatcher(this.valueAsDate),t.has("min")&&this.onMinChanged(this.min),t.has("max")&&this.onMaxChanged(this.max),t.has("messages")&&this.hasUpdated&&this.loadLocaleData().catch(console.error)}loaded(){}activeDateWatcher(t){this.range&&(this.rangeValueChangedByUser||(t?(this.activeStartDate=t,this.activeEndDate=o(this.activeStartDate)):this.resetActiveDates()))}valueHandler(t){Array.isArray(t)?(this.valueAsDate=u(t),this.rangeValueChangedByUser||this.resetActiveDates()):t&&(this.valueAsDate=h(t))}valueAsDateWatcher(t){this.range&&Array.isArray(t)&&!this.rangeValueChangedByUser?this.setActiveStartAndEndDates():t&&t!==this.activeDate&&(this.activeDate=t)}onMinChanged(t){this.minAsDate=h(t),this.range&&this.setActiveStartAndEndDates()}onMaxChanged(t){this.maxAsDate=h(t),this.range&&this.setActiveStartAndEndDates()}keyDownHandler(t){t.key==="Escape"&&this.resetActiveDates()}async loadLocaleData(){R()&&(z.numberFormatOptions={numberingSystem:this.numberingSystem,locale:this.messages._lang,useGrouping:!1},this.localeData=await $(this.messages._lang),this.dateTimeFormat=k(this.messages._lang,M))}monthHeaderSelectChange(t){let e=new Date(t.detail.date),a=t.detail.position;this.range?a==="end"?(this.activeEndDate=e,this.activeStartDate=v(e)):(this.activeStartDate=e,this.activeEndDate=o(e)):this.activeDate=e,t.stopPropagation()}monthActiveDateChange(t){let e=new Date(t.detail);if(!this.range)this.activeDate=e;else{let a=e.getMonth(),i=a!==this.activeStartDate.getMonth()&&a!==o(this.activeStartDate).getMonth();this.activeRange==="end"?(!this.activeEndDate||this.activeStartDate&&i)&&(this.activeEndDate=e,this.activeStartDate=v(e)):(this.activeStartDate&&i||!this.activeStartDate)&&(this.activeStartDate=e,this.activeEndDate=o(e))}t.stopPropagation()}monthHoverChange(t){if(!this.range){this.hoverRange=void 0;return}let{valueAsDate:e}=this,a=Array.isArray(e)&&e[0],i=Array.isArray(e)&&e[1],s=new Date(t.detail);if(this.hoverRange={focused:this.activeRange||"start",start:a,end:i},this.proximitySelectionDisabled)i&&a||!i&&s>=a?(this.hoverRange.focused="end",this.hoverRange.end=s):!i&&s<a?this.hoverRange={focused:"start",start:s,end:a}:this.hoverRange=void 0;else if(this.activeRange)this.activeRange==="end"?(this.hoverRange.end=s,this.hoverRange.focused="end"):(this.hoverRange.start=s,this.hoverRange.focused="start");else if(a&&i){let c=Math.abs(D(s,a)),l=Math.abs(D(s,i));s>i?(this.hoverRange.end=s,this.hoverRange.focused="end"):s<a?(this.hoverRange.start=s,this.hoverRange.focused="start"):s>a&&s<i&&(c<l?(this.hoverRange.start=s,this.hoverRange.focused="start"):(this.hoverRange.end=s,this.hoverRange.focused="end"))}else a&&(s<a?this.hoverRange={focused:"start",start:s,end:a}:(this.hoverRange.end=s,this.hoverRange.focused="end"));t.stopPropagation()}monthMouseOutChange(t){this.hoverRange&&(this.hoverRange=void 0),t.stopPropagation()}resetActiveDates(){let{valueAsDate:t}=this;!Array.isArray(t)&&t&&t!==this.activeDate&&(this.activeDate=new Date(t)),Array.isArray(t)&&(t[0]&&t[0]!==this.activeStartDate&&(this.activeStartDate=new Date(t[0])),t[1]&&t[1]!==this.activeEndDate&&(this.activeEndDate=new Date(t[1]))),this.hoverRange=void 0}getEndDate(){return Array.isArray(this.valueAsDate)&&this.valueAsDate[1]||void 0}setEndDate(t){let e=this.getStartDate();this.rangeValueChangedByUser=!0,this.value=[r(e),r(t)],this.valueAsDate=[e,t],t&&this.calciteDatePickerRangeChange.emit()}getStartDate(){return Array.isArray(this.valueAsDate)&&this.valueAsDate[0]}setStartDate(t){let e=this.getEndDate();this.rangeValueChangedByUser=!0,this.value=[r(t),r(e)],this.valueAsDate=[t,e],this.calciteDatePickerRangeChange.emit()}monthDateChange(t){let e=new Date(t.detail),a=r(e);if(!this.range&&a===r(this.valueAsDate))return;if(!this.range){this.value=a||"",this.valueAsDate=e||null,this.activeDate=e||null,this.calciteDatePickerChange.emit();return}let i=this.getStartDate(),s=this.getEndDate();if(!i||!s&&e<i)i&&this.setEndDate(new Date(i)),this.activeRange=="end"?this.setEndDate(e):this.setStartDate(e);else if(!s)this.setEndDate(e);else if(this.proximitySelectionDisabled)this.setStartDate(e),this.setEndDate(null);else if(this.activeRange)this.activeRange=="end"?this.setEndDate(e):(e>s&&(this.setEndDate(null),this.activeEndDate=null),this.setStartDate(e));else{let c=D(e,i),l=D(e,s);l===0||c<0?this.setStartDate(e):c===0||l<0?this.setEndDate(e):c<l?this.setStartDate(e):this.setEndDate(e)}t.stopPropagation(),this.calciteDatePickerChange.emit()}getActiveDate(t,e,a){let i=n(new Date,e,a);return n(this.activeDate,e,a)||t||(m(a,i)&&!this.range?A(i,e,a):i)}getActiveEndDate(t,e,a){return n(this.activeEndDate,e,a)||t||n(o(new Date),e,a)}setActiveStartAndEndDates(){if(this.range){let t=n(Array.isArray(this.valueAsDate)?this.valueAsDate[0]:this.valueAsDate,this.minAsDate,this.maxAsDate),e=n(Array.isArray(this.valueAsDate)?this.valueAsDate[1]:null,this.minAsDate,this.maxAsDate);if(this.activeStartDate=this.getActiveDate(t,this.minAsDate,this.maxAsDate),this.activeEndDate=this.getActiveEndDate(e,this.minAsDate,this.maxAsDate),m(this.activeStartDate,this.activeEndDate)){let a=A(v(this.activeEndDate),this.minAsDate,this.maxAsDate),i=o(this.activeEndDate);g(a,this.minAsDate,this.maxAsDate)?this.activeStartDate=a:g(i,this.minAsDate,this.maxAsDate)&&(this.activeEndDate=i)}}}render(){let t=n(this.range&&Array.isArray(this.valueAsDate)?this.valueAsDate[0]:this.valueAsDate,this.minAsDate,this.maxAsDate),e=this.getActiveDate(t,this.minAsDate,this.maxAsDate),a=this.range&&Array.isArray(this.valueAsDate)?n(this.valueAsDate[1],this.minAsDate,this.maxAsDate):null,i=this.range&&this.activeRange?this.activeRange==="start"?this.minAsDate:t:this.minAsDate,s=this.range?this.activeStartDate:e;return this.renderMonth(s,this.maxAsDate,i,t,a)}renderMonth(t,e,a,i,s){return this.localeData&&x`<calcite-date-picker-month .activeDate=${t} .dateTimeFormat=${this.dateTimeFormat} .endDate=${this.range?s:void 0} .headingLevel=${this.headingLevel||w} .hoverRange=${this.hoverRange} .layout=${this.layout} .localeData=${this.localeData} .max=${e} .messages=${this.messages} .min=${a} .monthStyle=${this.monthStyle} @calciteInternalDatePickerDayHover=${this.monthHoverChange} @calciteInternalDatePickerDaySelect=${this.monthDateChange} @calciteInternalDatePickerMonthActiveDateChange=${this.monthActiveDateChange} @calciteInternalDatePickerMonthChange=${this.monthHeaderSelectChange} @calciteInternalDatePickerMonthMouseOut=${this.monthMouseOutChange} .range=${this.range} .scale=${this.scale} .selectedDate=${this.activeRange==="end"?s:i} .startDate=${this.range?i:void 0}></calcite-date-picker-month>`||""}};f("calcite-date-picker",y);export{y as DatePicker};
